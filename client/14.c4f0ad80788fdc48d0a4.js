(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{2546:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),n=a(96),i=a(25),l=function(e){return e&&e.__esModule?e:{default:e}}(a(2547));t.default=(0,s.connect)(function(e){var t=(0,n.getConfig)(e);return{isLicensed:"true"===(0,n.getLicense)(e).IsLicensed,customBrandText:t.CustomBrandText,customDescriptionText:t.CustomDescriptionText,enableCustomBrand:"true"===t.EnableCustomBrand,enableLdap:"true"===t.EnableLdap,enableOpenServer:"true"===t.EnableOpenServer,enableSaml:"true"===t.EnableSaml,enableSignInWithEmail:"true"===t.EnableSignInWithEmail,enableSignInWithUsername:"true"===t.EnableSignInWithUsername,enableSignUpWithEmail:"true"===t.EnableSignUpWithEmail,enableSignUpWithGitLab:"true"===t.EnableSignUpWithGitLab,enableSignUpWithGoogle:"true"===t.EnableSignUpWithGoogle,enableSignUpWithOffice365:"true"===t.EnableSignUpWithOffice365,experimentalPrimaryTeam:t.ExperimentalPrimaryTeam,ldapLoginFieldName:t.LdapLoginFieldName,samlLoginButtonText:t.SamlLoginButtonText,siteName:t.SiteName,initializing:e.requests.users.logout.status===i.RequestStatus.SUCCESS||!e.storage.initialized}})(l.default)},2547:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=R(a(282)),n=R(a(281)),i=R(a(283)),l=R(a(285)),r=R(a(284)),o=R(a(1)),d=R(a(3)),u=a(766),c=a(287),f=a(183),m=F(a(773)),g=a(826),p=a(781),h=R(a(774)),E=R(a(782)),b=R(a(982)),v=a(291),S=R(a(22)),N=R(a(972)),_=F(a(814)),M=F(a(765)),w=a(1325),y=a(288),I=R(a(812)),L=R(a(894)),k=R(a(864)),x=R(a(811)),U=R(a(777)),C=R(a(804)),P=R(a(785)),T=R(a(959));function F(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function R(e){return e&&e.__esModule?e:{default:e}}var W=function(e){function t(e){(0,n.default)(this,t);var a=(0,i.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));a.showSessionExpiredNotificationIfNeeded=function(){a.state.sessionExpired&&!a.closeSessionExpiredNotification?(0,w.showNotification)({title:a.props.siteName,body:M.localizeMessage("login.session_expired.notification","Session Expired: Please sign in to continue receiving notifications."),requireInteraction:!0,silent:!1,onClick:function(){window.focus(),a.closeSessionExpiredNotification()&&(a.closeSessionExpiredNotification(),a.closeSessionExpiredNotification=null)}}).then(function(e){a.closeSessionExpiredNotification=e}).catch(function(){}):!a.state.sessionExpired&&a.closeSessionExpiredNotification&&(a.closeSessionExpiredNotification(),a.closeSessionExpiredNotification=null)},a.onDismissSessionExpired=function(){b.default.setWasLoggedIn(!1),a.setState({sessionExpired:!1})},a.hideMfa=function(){a.setState({showMfa:!1})},a.preSubmit=a.preSubmit.bind(a),a.submit=a.submit.bind(a),a.finishSignin=a.finishSignin.bind(a),a.handleLoginIdChange=a.handleLoginIdChange.bind(a),a.handlePasswordChange=a.handlePasswordChange.bind(a);var l="";return new URLSearchParams(a.props.location.search).get("extra")===S.default.SIGNIN_VERIFIED&&new URLSearchParams(a.props.location.search).get("email")&&(l=new URLSearchParams(a.props.location.search).get("email")),a.state={ldapEnabled:a.props.isLicensed&&a.props.enableLdap,usernameSigninEnabled:a.props.enableSignInWithUsername,emailSigninEnabled:a.props.enableSignInWithEmail,samlEnabled:a.props.isLicensed&&a.props.enableSaml,loginId:l,password:"",showMfa:!1,loading:!1,sessionExpired:!1},a}return(0,r.default)(t,e),(0,l.default)(t,null,[{key:"propTypes",get:function(){return{intl:u.intlShape.isRequired,location:o.default.object.isRequired,isLicensed:o.default.bool.isRequired,customBrandText:o.default.string,customDescriptionText:o.default.string,enableCustomBrand:o.default.bool.isRequired,enableLdap:o.default.bool.isRequired,enableOpenServer:o.default.bool.isRequired,enableSaml:o.default.bool.isRequired,enableSignInWithEmail:o.default.bool.isRequired,enableSignInWithUsername:o.default.bool.isRequired,enableSignUpWithEmail:o.default.bool.isRequired,enableSignUpWithGitLab:o.default.bool.isRequired,enableSignUpWithGoogle:o.default.bool.isRequired,enableSignUpWithOffice365:o.default.bool.isRequired,experimentalPrimaryTeam:o.default.string,ldapLoginFieldName:o.default.string,samlLoginButtonText:o.default.string,siteName:o.default.string,initializing:o.default.bool}}}]),(0,l.default)(t,[{key:"componentDidMount",value:function(){if(this.configureTitle(),h.default.getCurrentUser())m.redirectUserToDefaultTeam();else{var e=new URLSearchParams(this.props.location.search),t=e.get("extra"),a=e.get("email");t===S.default.SIGNIN_VERIFIED&&a&&this.refs.password.focus(),b.default.getWasLoggedIn()&&t!==S.default.SIGNIN_CHANGE&&(this.setState({sessionExpired:!0}),e.set("extra",S.default.SESSION_EXPIRED),v.browserHistory.replace(this.props.location.pathname+"?"+e)),this.showSessionExpiredNotificationIfNeeded()}}},{key:"componentDidUpdate",value:function(){this.configureTitle(),this.showSessionExpiredNotificationIfNeeded()}},{key:"componentWillUnmount",value:function(){this.closeSessionExpiredNotification&&(this.closeSessionExpiredNotification(),this.closeSessionExpiredNotification=null)}},{key:"configureTitle",value:function(){this.state.sessionExpired?document.title=this.props.intl.formatMessage({id:"login.session_expired.title",defaultMessage:"* {siteName} - Session Expired"},{siteName:this.props.siteName}):document.title=this.props.siteName}},{key:"preSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props.location,s=a.search.replace(/(extra=password_change)&?/i,"");s!==a.search&&v.browserHistory.replace(""+a.pathname+s+a.hash);var n=this.refs.loginId.value;n!==this.state.loginId&&this.setState({loginId:n});var i=this.refs.password.value;if(i!==this.state.password&&this.setState({password:i}),!(n=n.trim().toLowerCase())){(0,y.t)("login.noEmail"),(0,y.t)("login.noEmailLdapUsername"),(0,y.t)("login.noEmailUsername"),(0,y.t)("login.noEmailUsernameLdapUsername"),(0,y.t)("login.noLdapUsername"),(0,y.t)("login.noUsername"),(0,y.t)("login.noUsernameLdapUsername");var l="login.no";return this.state.emailSigninEnabled&&(l+="Email"),this.state.usernameSigninEnabled&&(l+="Username"),this.state.ldapEnabled&&(l+="LdapUsername"),void this.setState({serverError:d.default.createElement(u.FormattedMessage,{id:l,values:{ldapUsername:this.props.ldapLoginFieldName||M.localizeMessage("login.ldapUsernameLower","AD/LDAP username")}})})}i?(0,p.checkMfa)(n,function(e){e?t.setState({showMfa:!0}):t.submit(n,i,"")},function(e){t.setState({serverError:e.message})}):this.setState({serverError:d.default.createElement(u.FormattedMessage,{id:"login.noPassword",defaultMessage:"Please enter your password"})})}},{key:"submit",value:function(e,t,a){var s=this;this.setState({serverError:null,loading:!0}),(0,p.webLogin)(e,t,a,function(){var e=new URLSearchParams(s.props.location.search),t=e.get("t")||"",a=e.get("id")||"";a||t?(0,g.addUserToTeamFromInvite)(t,a,function(e){s.finishSignin(e)},function(){s.finishSignin()}):s.finishSignin()},function(t){"api.user.login.not_verified.app_error"===t.id?v.browserHistory.push("/should_verify_email?&email="+encodeURIComponent(e)):"store.sql_user.get_for_login.app_error"===t.id||"ent.ldap.do_login.user_not_registered.app_error"===t.id?s.setState({showMfa:!1,loading:!1,serverError:d.default.createElement(u.FormattedMessage,{id:"login.userNotFound",defaultMessage:"We couldn't find an account matching your login credentials."})}):"api.user.check_user_password.invalid.app_error"===t.id||"ent.ldap.do_login.invalid_password.app_error"===t.id?s.setState({showMfa:!1,loading:!1,serverError:d.default.createElement(u.FormattedMessage,{id:"login.invalidPassword",defaultMessage:"Your password is incorrect."})}):s.setState({showMfa:!1,serverError:t.message,loading:!1})})}},{key:"finishSignin",value:function(e){var t=this.props.experimentalPrimaryTeam,a=E.default.getByName(t),s=new URLSearchParams(this.props.location.search).get("redirect_to");b.default.setWasLoggedIn(!0),m.loadCurrentLocale(),s&&s.match(/^\/([^/]|$)/)?v.browserHistory.push(s):e?v.browserHistory.push("/"+e.name):a?v.browserHistory.push("/"+a.name+"/channels/"+S.default.DEFAULT_CHANNEL):m.redirectUserToDefaultTeam()}},{key:"handleLoginIdChange",value:function(e){this.setState({loginId:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"createCustomLogin",value:function(){if(this.props.enableCustomBrand){var e=this.props.customBrandText||"",t=_.formatText(e);return d.default.createElement("div",null,d.default.createElement("img",{src:f.Client4.getBrandImageUrl(0)}),d.default.createElement("div",null,(0,N.default)(t,!1,{mentions:!1})))}return null}},{key:"createLoginPlaceholder",value:function(){var e=this.state.ldapEnabled,t=this.state.usernameSigninEnabled,a=[];return this.state.emailSigninEnabled&&a.push(M.localizeMessage("login.email","Email")),t&&a.push(M.localizeMessage("login.username","Username")),e&&(this.props.ldapLoginFieldName?a.push(this.props.ldapLoginFieldName):a.push(M.localizeMessage("login.ldapUsername","AD/LDAP Username"))),a.length>=2?a.slice(0,a.length-1).join(", ")+M.localizeMessage("login.placeholderOr"," or ")+a[a.length-1]:1===a.length?a[0]:""}},{key:"checkSignUpEnabled",value:function(){return this.props.enableSignUpWithEmail||this.props.enableSignUpWithGitLab||this.props.enableSignUpWithOffice365||this.props.enableSignUpWithGoogle||this.props.enableLdap||this.props.enableSaml}},{key:"createLoginOptions",value:function(){var e=new URLSearchParams(this.props.location.search).get("extra"),t="";this.state.sessionExpired?t=d.default.createElement("div",{className:"alert alert-warning"},d.default.createElement("i",{className:"fa fa-exclamation-triangle",title:M.localizeMessage("generic_icons.warning","Warning Icon")})," ",d.default.createElement(u.FormattedMessage,{id:"login.session_expired",defaultMessage:"Your session has expired. Please log in again."})," ",d.default.createElement(c.Link,{className:"btn-close",to:"/login",onClick:this.onDismissSessionExpired},d.default.createElement("span",null,"Ã—"))):e===S.default.GET_TERMS_ERROR?t=d.default.createElement("div",{className:"alert has-error no-padding"},d.default.createElement("label",{className:"control-label"},d.default.createElement(u.FormattedMessage,{id:"login.get_terms_error",defaultMessage:"Unable to load terms of service. If this issue persists, contact your System Administrator."}))):e===S.default.TERMS_REJECTED?t=d.default.createElement("div",{className:"alert alert-warning"},d.default.createElement("i",{className:"fa fa-exclamation-triangle",title:M.localizeMessage("generic_icons.warning","Warning Icon")}),d.default.createElement(U.default,{id:"login.terms_rejected",defaultMessage:"You must agree to the terms of service before accessing {siteName}. Please contact your System Administrator for more details.",values:{siteName:this.props.siteName}})):e===S.default.SIGNIN_CHANGE?t=d.default.createElement("div",{className:"alert alert-success"},d.default.createElement("i",{className:"fa fa-check",title:M.localizeMessage("generic_icons.success","Success Icon")}),d.default.createElement(u.FormattedMessage,{id:"login.changed",defaultMessage:" Sign-in method changed successfully"})):e===S.default.SIGNIN_VERIFIED?t=d.default.createElement("div",{className:"alert alert-success"},d.default.createElement("i",{className:"fa fa-check",title:M.localizeMessage("generic_icons.success","Success Icon")}),d.default.createElement(u.FormattedMessage,{id:"login.verified",defaultMessage:" Email Verified"})):e===S.default.PASSWORD_CHANGE&&(t=d.default.createElement("div",{className:"alert alert-success"},d.default.createElement("i",{className:"fa fa-check",title:M.localizeMessage("generic_icons.success","Success Icon")}),d.default.createElement(u.FormattedMessage,{id:"login.passwordChanged",defaultMessage:" Password updated successfully"})));var a=[],s=this.state.ldapEnabled,n=this.props.enableSignUpWithGitLab,i=this.props.enableSignUpWithGoogle,l=this.props.enableSignUpWithOffice365,r=this.state.samlEnabled,o=this.state.usernameSigninEnabled,m=this.state.emailSigninEnabled;if(m||o||s){var g="";this.state.serverError&&(g=" has-error");var p=d.default.createElement(u.FormattedMessage,{id:"login.signIn",defaultMessage:"Sign in"});this.state.loading&&(p=d.default.createElement("span",null,d.default.createElement("span",{className:"fa fa-refresh icon--rotate",title:M.localizeMessage("generic_icons.loading","Loading Icon")}),d.default.createElement(u.FormattedMessage,{id:"login.signInLoading",defaultMessage:"Signing in..."}))),a.push(d.default.createElement("form",{key:"loginBoxes",onSubmit:this.preSubmit},d.default.createElement("div",{className:"signup__email-container"},d.default.createElement(x.default,{error:this.state.serverError,margin:!0}),d.default.createElement("div",{className:"form-group"+g},d.default.createElement("input",{id:"loginId",className:"form-control",ref:"loginId",name:"loginId",value:this.state.loginId,onChange:this.handleLoginIdChange,placeholder:this.createLoginPlaceholder(),spellCheck:"false",autoCapitalize:"off",autoFocus:"true"})),d.default.createElement("div",{className:"form-group"+g},d.default.createElement("input",{id:"loginPassword",type:"password",className:"form-control",ref:"password",name:"password",value:this.state.password,onChange:this.handlePasswordChange,placeholder:M.localizeMessage("login.password","Password"),spellCheck:"false"})),d.default.createElement("div",{className:"form-group"},d.default.createElement("button",{id:"loginButton",type:"submit",className:"btn btn-primary"},p)))))}return this.props.enableOpenServer&&this.checkSignUpEnabled()&&a.push(d.default.createElement("div",{className:"form-group",key:"signup"},d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"login.noAccount",defaultMessage:"Don't have an account? "}),d.default.createElement(c.Link,{id:"signup",to:"/signup_user_complete"+this.props.location.search,className:"signup-team-login"},d.default.createElement(u.FormattedMessage,{id:"login.create",defaultMessage:"Create one now"}))))),(o||m)&&a.push(d.default.createElement("div",{key:"forgotPassword",className:"form-group"},d.default.createElement(c.Link,{to:"/reset_password"},d.default.createElement(u.FormattedMessage,{id:"login.forgot",defaultMessage:"I forgot my password"})))),(m||o||s)&&(n||i||r||l)&&(a.push(d.default.createElement("div",{key:"divider",className:"or__container"},d.default.createElement(u.FormattedMessage,{id:"login.or",defaultMessage:"or"}))),a.push(d.default.createElement("h5",{key:"oauthHeader"},d.default.createElement(u.FormattedMessage,{id:"login.signInWith",defaultMessage:"Sign in with:"})))),n&&a.push(d.default.createElement("a",{className:"btn btn-custom-login gitlab",key:"gitlab",href:f.Client4.getOAuthRoute()+"/gitlab/login"+this.props.location.search},d.default.createElement("span",null,d.default.createElement("span",{className:"icon"}),d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"login.gitlab",defaultMessage:"GitLab"}))))),i&&a.push(d.default.createElement("a",{className:"btn btn-custom-login google",key:"google",href:f.Client4.getOAuthRoute()+"/google/login"+this.props.location.search},d.default.createElement("span",null,d.default.createElement("span",{className:"icon"}),d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"login.google",defaultMessage:"Google Apps"}))))),l&&a.push(d.default.createElement("a",{className:"btn btn-custom-login office365",key:"office365",href:f.Client4.getOAuthRoute()+"/office365/login"+this.props.location.search},d.default.createElement("span",null,d.default.createElement("span",{className:"icon"}),d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"login.office365",defaultMessage:"Office 365"}))))),r&&a.push(d.default.createElement("a",{className:"btn btn-custom-login saml",key:"saml",href:f.Client4.getUrl()+"/login/sso/saml"+this.props.location.search},d.default.createElement("span",null,d.default.createElement("span",{className:"icon fa fa-lock fa--margin-top",title:"Saml icon"}),d.default.createElement("span",null,this.props.samlLoginButtonText)))),0===a.length&&a.push(d.default.createElement(x.default,{key:"noMethods",error:d.default.createElement(u.FormattedMessage,{id:"login.noMethods",defaultMessage:"No sign-in methods are enabled. Please contact your System Administrator."}),margin:!0})),d.default.createElement("div",null,t,a)}},{key:"render",value:function(){var e=this.props,t=e.customDescriptionText,a=e.siteName;if(e.initializing)return d.default.createElement(P.default,null);var s=void 0,n=void 0,i=void 0,l=void 0;return this.state.showMfa?(s=d.default.createElement(T.default,{loginId:this.state.loginId,password:this.state.password,submit:this.submit}),l=d.default.createElement(C.default,{onClick:this.hideMfa})):(s=this.createLoginOptions(),(n=this.createCustomLogin())&&(i="branded")),d.default.createElement("div",null,d.default.createElement(k.default,null),l,d.default.createElement("div",{className:"col-sm-12"},d.default.createElement("div",{className:"signup-team__container "+i},d.default.createElement("div",{className:"signup__markdown"},n),d.default.createElement("img",{className:"signup-team-logo",src:I.default}),d.default.createElement("div",{className:"signup__content"},d.default.createElement(L.default,{customDescriptionText:t,siteName:a}),s))))}}]),t}(d.default.Component);t.default=(0,u.injectIntl)(W)},804:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=m(a(282)),n=m(a(281)),i=m(a(285)),l=m(a(283)),r=m(a(284)),o=m(a(1)),d=m(a(3)),u=a(766),c=a(287),f=a(765);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(){return(0,n.default)(this,t),(0,l.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,r.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){return d.default.createElement("div",{className:"signup-header"},d.default.createElement(c.Link,{onClick:this.props.onClick,to:this.props.url},d.default.createElement("span",{className:"fa fa-chevron-left",title:(0,f.localizeMessage)("generic_icons.back","Back Icon")}),d.default.createElement(u.FormattedMessage,{id:"web.header.back",defaultMessage:"Back"})))}}]),t}(d.default.PureComponent);g.propTypes={url:o.default.string,onClick:o.default.func},g.defaultProps={url:"/"},t.default=g},812:function(e,t,a){e.exports=a.p+"files/5d6be4015bde2a4e0358c8bc110deadc.png"},894:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=c(a(282)),n=c(a(281)),i=c(a(285)),l=c(a(283)),r=c(a(284)),o=c(a(1)),d=c(a(3)),u=a(766);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,n.default)(this,t),(0,l.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,r.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this.props,t=e.customDescriptionText,a=e.siteName,s=null;return s=t||d.default.createElement(u.FormattedMessage,{id:"web.root.signup_info",defaultMessage:"All team communication in one place, searchable and accessible anywhere"}),d.default.createElement(d.default.Fragment,null,d.default.createElement("h1",null,a),d.default.createElement("h4",{className:"color--light"},s))}}]),t}(d.default.PureComponent);f.propTypes={customDescriptionText:o.default.string,siteName:o.default.string},f.defaultProps={siteName:"Mattermost"},t.default=f},959:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=m(a(282)),n=m(a(281)),i=m(a(285)),l=m(a(283)),r=m(a(284)),o=m(a(1)),d=m(a(3)),u=a(766),c=a(765),f=m(a(846));function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,n.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.handleChange=function(e){e.preventDefault();var t=e.target.value.trim().replace(/\s/g,"");t!==a.state.token&&a.setState({token:t})},a.handleSubmit=function(e){e.preventDefault();var t={serverError:"",saving:!0};a.setState(t),a.props.submit(a.props.loginId,a.props.password,a.state.token)},a.state={saving:!1,token:"",serverError:""},a}return(0,r.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=void 0,t="";return this.state.serverError&&(e=d.default.createElement("label",{className:"control-label"},this.state.serverError),t=" has-error"),d.default.createElement("form",{onSubmit:this.handleSubmit},d.default.createElement("div",{className:"signup__email-container"},d.default.createElement("p",null,d.default.createElement(u.FormattedMessage,{id:"login_mfa.enterToken",defaultMessage:"To complete the sign in process, please enter a token from your smartphone's authenticator"})),d.default.createElement("div",{className:"form-group"+t},e),d.default.createElement("div",{className:"form-group"+t},d.default.createElement("input",{type:"text",className:"form-control",name:"token",placeholder:(0,c.localizeMessage)("login_mfa.token","MFA Token"),spellCheck:"false",autoComplete:"off",autoFocus:!0,onChange:this.handleChange})),d.default.createElement("div",{className:"form-group"},d.default.createElement(f.default,{saving:this.state.saving,disabled:this.state.saving,onClick:this.handleSubmit,defaultMessage:(0,c.localizeMessage)("login_mfa.submit","Submit"),savingMessage:(0,c.localizeMessage)("login_mfa.submitting","Submitting...")}))))}}]),t}(d.default.PureComponent);g.propTypes={loginId:o.default.string.isRequired,password:o.default.string.isRequired,submit:o.default.func.isRequired},t.default=g}}]);
//# sourceMappingURL=14.c4f0ad80788fdc48d0a4.js.map