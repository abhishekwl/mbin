(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1115:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(770),n=a(778),l=function(e){return e&&e.__esModule?e:{default:e}}(a(1116));t.default=(0,s.connect)(function(e){return{currentUser:(0,i.getCurrentUser)(e),getUser:function(t){return(0,i.getUser)(e,t)},getByName:function(t){return(0,n.getChannelByName)(e,t)}}})(l.default)},1116:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatAuditInfo=c;var s=o(a(1)),i=o(a(3)),n=a(766),l=a(765),r=a(288);function o(e){return e&&e.__esModule?e:{default:e}}var d=(0,n.defineMessages)({sessionRevoked:{id:(0,r.t)("audit_table.sessionRevoked"),defaultMessage:"The session with id {sessionId} was revoked"},channelCreated:{id:(0,r.t)("audit_table.channelCreated"),defaultMessage:"Created the {channelName} channel"},establishedDM:{id:(0,r.t)("audit_table.establishedDM"),defaultMessage:"Established a direct message channel with {username}"},nameUpdated:{id:(0,r.t)("audit_table.nameUpdated"),defaultMessage:"Updated the {channelName} channel name"},headerUpdated:{id:(0,r.t)("audit_table.headerUpdated"),defaultMessage:"Updated the {channelName} channel header"},channelDeleted:{id:(0,r.t)("audit_table.channelDeleted"),defaultMessage:"Archived the channel with the URL {url}"},userAdded:{id:(0,r.t)("audit_table.userAdded"),defaultMessage:"Added {username} to the {channelName} channel"},userRemoved:{id:(0,r.t)("audit_table.userRemoved"),defaultMessage:"Removed {username} to the {channelName} channel"},attemptedRegisterApp:{id:(0,r.t)("audit_table.attemptedRegisterApp"),defaultMessage:"Attempted to register a new OAuth Application with ID {id}"},attemptedAllowOAuthAccess:{id:(0,r.t)("audit_table.attemptedAllowOAuthAccess"),defaultMessage:"Attempted to allow a new OAuth service access"},successfullOAuthAccess:{id:(0,r.t)("audit_table.successfullOAuthAccess"),defaultMessage:"Successfully gave a new OAuth service access"},failedOAuthAccess:{id:(0,r.t)("audit_table.failedOAuthAccess"),defaultMessage:"Failed to allow a new OAuth service access - the redirect URI did not match the previously registered callback"},attemptedOAuthToken:{id:(0,r.t)("audit_table.attemptedOAuthToken"),defaultMessage:"Attempted to get an OAuth access token"},successfullOAuthToken:{id:(0,r.t)("audit_table.successfullOAuthToken"),defaultMessage:"Successfully added a new OAuth service"},oauthTokenFailed:{id:(0,r.t)("audit_table.oauthTokenFailed"),defaultMessage:"Failed to get an OAuth access token - {token}"},attemptedLogin:{id:(0,r.t)("audit_table.attemptedLogin"),defaultMessage:"Attempted to login"},authenticated:{id:(0,r.t)("audit_table.authenticated"),defauleMessage:"Successfully authenticated"},successfullLogin:{id:(0,r.t)("audit_table.successfullLogin"),defaultMessage:"Successfully logged in"},failedLogin:{id:(0,r.t)("audit_table.failedLogin"),defaultMessage:"FAILED login attempt"},updatePicture:{id:(0,r.t)("audit_table.updatePicture"),defaultMessage:"Updated your profile picture"},updateGeneral:{id:(0,r.t)("audit_table.updateGeneral"),defaultMessage:"Updated the general settings of your account"},attemptedPassword:{id:(0,r.t)("audit_table.attemptedPassword"),defaultMessage:"Attempted to change password"},successfullPassword:{id:(0,r.t)("audit_table.successfullPassword"),defaultMessage:"Successfully changed password"},failedPassword:{id:(0,r.t)("audit_table.failedPassword"),defaultMessage:"Failed to change password - tried to update user password who was logged in through OAuth"},updatedRol:{id:(0,r.t)("audit_table.updatedRol"),defaultMessage:"Updated user role(s) to "},member:{id:(0,r.t)("audit_table.member"),defaultMessage:"member"},accountActive:{id:(0,r.t)("audit_table.accountActive"),defaultMessage:"Account activated"},accountInactive:{id:(0,r.t)("audit_table.accountInactive"),defaultMessage:"Account deactivated"},by:{id:(0,r.t)("audit_table.by"),defaultMessage:" by {username}"},byAdmin:{id:(0,r.t)("audit_table.byAdmin"),defaultMessage:" by an admin"},sentEmail:{id:(0,r.t)("audit_table.sentEmail"),defaultMessage:"Sent an email to {email} to reset your password"},attemptedReset:{id:(0,r.t)("audit_table.attemptedReset"),defaultMessage:"Attempted to reset password"},successfullReset:{id:(0,r.t)("audit_table.successfullReset"),defaultMessage:"Successfully reset password"},updateGlobalNotifications:{id:(0,r.t)("audit_table.updateGlobalNotifications"),defaultMessage:"Updated your global notification settings"},attemptedWebhookCreate:{id:(0,r.t)("audit_table.attemptedWebhookCreate"),defaultMessage:"Attempted to create a webhook"},succcessfullWebhookCreate:{id:(0,r.t)("audit_table.successfullWebhookCreate"),defaultMessage:"Successfully created a webhook"},failedWebhookCreate:{id:(0,r.t)("audit_table.failedWebhookCreate"),defaultMessage:"Failed to create a webhook - bad channel permissions"},attemptedWebhookDelete:{id:(0,r.t)("audit_table.attemptedWebhookDelete"),defaultMessage:"Attempted to delete a webhook"},successfullWebhookDelete:{id:(0,r.t)("audit_table.successfullWebhookDelete"),defaultMessage:"Successfully deleted a webhook"},failedWebhookDelete:{id:(0,r.t)("audit_table.failedWebhookDelete"),defaultMessage:"Failed to delete a webhook - inappropriate conditions"},logout:{id:(0,r.t)("audit_table.logout"),defaultMessage:"Logged out of your account"},verified:{id:(0,r.t)("audit_table.verified"),defaultMessage:"Successfully verified your email address"},revokedAll:{id:(0,r.t)("audit_table.revokedAll"),defaultMessage:"Revoked all current sessions for the team"},loginAttempt:{id:(0,r.t)("audit_table.loginAttempt"),defaultMessage:" (Login attempt)"},loginFailure:{id:(0,r.t)("audit_table.loginFailure"),defaultMessage:" (Login failure)"},attemptedLicenseAdd:{id:(0,r.t)("audit_table.attemptedLicenseAdd"),defaultMessage:"Attempted to add new license"},successfullLicenseAdd:{id:(0,r.t)("audit_table.successfullLicenseAdd"),defaultMessage:"Successfully added new license"},failedExpiredLicenseAdd:{id:(0,r.t)("audit_table.failedExpiredLicenseAdd"),defaultMessage:"Failed to add a new license as it has either expired or not yet been started"},failedInvalidLicenseAdd:{id:(0,r.t)("audit_table.failedInvalidLicenseAdd"),defaultMessage:"Failed to add an invalid license"},licenseRemoved:{id:(0,r.t)("audit_table.licenseRemoved"),defaultMessage:"Successfully removed a license"}});function u(e){for(var t=[],a=e.intl.formatMessage,s=0;s<e.audits.length;s++){var l=e.audits[s],r=c(l,a,e.currentUser,e.getByName,e.getUser),o=void 0;if(e.showUserId){var d=e.getUser(r.userId),u=d?d.email:r.userId;o=i.default.createElement("td",{className:"word-break--all"},u)}var f=void 0;e.showIp&&(f=i.default.createElement("td",{className:"whitespace--nowrap word-break--all"},r.ip));var m=void 0;e.showSession&&(m=i.default.createElement("td",{className:"whitespace--nowrap word-break--all"},r.sessionId));var p="";-1!==r.desc.toLowerCase().indexOf("fail")&&(p=" color--error"),t[s]=i.default.createElement("tr",{key:l.id},i.default.createElement("td",{className:"whitespace--nowrap word-break--all"},r.timestamp),o,i.default.createElement("td",{className:"word-break--all"+p},r.desc),f,m)}var g=void 0;e.showUserId&&(g=i.default.createElement("th",null,i.default.createElement(n.FormattedMessage,{id:"audit_table.userId",defaultMessage:"User ID"})));var h=void 0;e.showIp&&(h=i.default.createElement("th",null,i.default.createElement(n.FormattedMessage,{id:"audit_table.ip",defaultMessage:"IP Address"})));var v=void 0;return e.showSession&&(v=i.default.createElement("th",null,i.default.createElement(n.FormattedMessage,{id:"audit_table.session",defaultMessage:"Session ID"}))),i.default.createElement("table",{className:"table"},i.default.createElement("thead",null,i.default.createElement("tr",null,i.default.createElement("th",null,i.default.createElement(n.FormattedMessage,{id:"audit_table.timestamp",defaultMessage:"Timestamp"})),g,i.default.createElement("th",null,i.default.createElement(n.FormattedMessage,{id:"audit_table.action",defaultMessage:"Action"})),h,v)),i.default.createElement("tbody",null,t))}function c(e,t,a,s,r){var o=e.action.replace(/\/api\/v[1-9]/,""),u="";if(0===o.indexOf("/channels")){var c=e.extra_info.split(" "),f=c[0].split("="),m="",p=void 0,g="";switch(f.indexOf("name")>=0&&(g=(p=s(m=f[f.indexOf("name")+1]))?p.display_name:m),o){case"/channels/create":u=t(d.channelCreated,{channelName:g});break;case"/channels/create_direct":u=t(d.establishedDM,{username:(0,l.getDirectTeammate)(p.id).username});break;case"/channels/update":u=t(d.nameUpdated,{channelName:g});break;case"/channels/update_desc":case"/channels/update_header":u=t(d.headerUpdated,{channelName:g});break;default:var h=[],v="";if(c[1]&&(h=c[1].split("=")).indexOf("user_id")>=0){var E=r(h[h.indexOf("user_id")+1]);E&&(v=E.username)}/\/channels\/[A-Za-z0-9]+\/delete/.test(o)?u=t(d.channelDeleted,{url:m}):/\/channels\/[A-Za-z0-9]+\/add/.test(o)?u=t(d.userAdded,{username:v,channelName:g}):/\/channels\/[A-Za-z0-9]+\/remove/.test(o)&&(u=t(d.userRemoved,{username:v,channelName:g}))}}else if(0===o.indexOf("/oauth")){var S=e.extra_info.split(" ");switch(o){case"/oauth/register":var M=S[0].split("=");"client_id"===M[0]&&(u=t(d.attemptedRegisterApp,{id:M[1]}));break;case"/oauth/allow":"attempt"===S[0]?u=t(d.attemptedAllowOAuthAccess):"success"===S[0]?u=t(d.successfullOAuthAccess):"fail - redirect_uri did not match registered callback"===S[0]&&(u=t(d.failedOAuthAccess));break;case"/oauth/access_token":if("attempt"===S[0])u=t(d.attemptedOAuthToken);else if("success"===S[0])u=t(d.successfullOAuthToken);else{var b=S[0].split("-");"fail"===b[0].trim()&&b[1]&&(u=t(b,{token:b[1].trim()}))}}}else if(0===o.indexOf("/users")){var _=e.extra_info.split(" ");switch(o){case"/users/login":"attempt"===_[0]?u=t(d.attemptedLogin):"success"===_[0]?u=t(d.successfullLogin):"authenticated"===_[0]?u=t(d.authenticated):_[0]&&(u=t(d.failedLogin));break;case"/users/revoke_session":u=t(d.sessionRevoked,{sessionId:_[0].split("=")[1]});break;case"/users/newimage":u=t(d.updatePicture);break;case"/users/update":u=t(d.updateGeneral);break;case"/users/newpassword":"attempted"===_[0]?u=t(d.attemptedPassword):"completed"===_[0]?u=t(d.successfullPassword):"failed - tried to update user password who was logged in through oauth"===_[0]&&(u=t(d.failedPassword));break;case"/users/update_roles":var y=_[0].split("=")[1];u=t(d.updatedRol),y.trim()?u+=y:u+=t(d.member);break;case"/users/update_active":var k=_[0].split("=")[0],N=_[0].split("=")[1];if("active"===k){"true"===N?u=t(d.accountActive):"false"===N&&(u=t(d.accountInactive));var A=_[1].split("=");if("session_user"===A[0]){var C=r(A[1]),T=a;T&&C&&(0,l.isSystemAdmin)(T.roles)?u+=t(d.by,{username:C.username}):T&&C&&(u+=t(d.byAdmin))}}else"session_id"===k&&(u=t(d.sessionRevoked,{sessionId:N}));break;case"/users/send_password_reset":u=t(d.sentEmail,{email:_[0].split("=")[1]});break;case"/users/reset_password":"attempt"===_[0]?u=t(d.attemptedReset):"success"===_[0]&&(u=t(d.successfullReset));break;case"/users/update_notify":u=t(d.updateGlobalNotifications)}}else if(0===o.indexOf("/hooks")){var w=e.extra_info;switch(o){case"/hooks/incoming/create":"attempt"===w?u=t(d.attemptedWebhookCreate):"success"===w?u=t(d.succcessfullWebhookCreate):"fail - bad channel permissions"===w&&(u=t(d.failedWebhookCreate));break;case"/hooks/incoming/delete":"attempt"===w?u=t(d.attemptedWebhookDelete):"success"===w?u=t(d.successfullWebhookDelete):"fail - inappropriate conditions"===w&&(u=t(d.failedWebhookDelete))}}else if(0===o.indexOf("/license")){var F=e.extra_info;switch(o){case"/license/add":"attempt"===F?u=t(d.attemptedLicenseAdd):"success"===F?u=t(d.successfullLicenseAdd):"failed - expired or non-started license"===F?u=t(d.failedExpiredLicenseAdd):"failed - invalid license"===F&&(u=t(d.failedInvalidLicenseAdd));break;case"/license/remove":u=t(d.licenseRemoved)}}else if(0===o.indexOf("/admin/download_compliance_report"))u=(0,l.toTitleCase)(e.extra_info);else switch(o){case"/logout":u=t(d.logout);break;case"/verify_email":u=t(d.verified)}if(!u)if(e.extra_info.indexOf("revoked_all=")>=0)u=t(d.revokedAll);else{var I="";o&&-1!==o.lastIndexOf("/")&&(I=o.substring(o.lastIndexOf("/")+1).replace("_"," "),I=(0,l.toTitleCase)(I));var O="";e.extra_info&&-1!==(O=e.extra_info).indexOf("=")&&(O=O.substring(O.indexOf("=")+1)),u=I+" "+O}var L=new Date(e.create_at),R={};return R.timestamp=i.default.createElement("div",null,i.default.createElement("div",null,i.default.createElement(n.FormattedDate,{value:L,day:"2-digit",month:"short",year:"numeric"})),i.default.createElement("div",null,i.default.createElement(n.FormattedTime,{value:L,hour:"2-digit",minute:"2-digit"}))),R.userId=e.user_id,R.desc=u,R.ip=e.ip_address,R.sessionId=e.session_id,R}u.propTypes={intl:n.intlShape.isRequired,audits:s.default.array.isRequired,showUserId:s.default.bool,showIp:s.default.bool,showSession:s.default.bool,currentUser:s.default.object.isRequired,getUser:s.default.func.isRequired,getByName:s.default.func.isRequired},t.default=(0,n.injectIntl)(u)},2284:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=E(a(282)),i=E(a(281)),n=E(a(285)),l=E(a(283)),r=E(a(284)),o=E(a(1)),d=E(a(3)),u=E(a(774)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(765)),f=E(a(2285)),m=E(a(2291)),p=E(a(2452)),g=E(a(2454)),h=E(a(2459)),v=E(a(2469));function E(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.onListenerChange=function(){var e=u.default.getCurrentUser();c.areObjectsEqual(a.state.user,e)||a.setState({user:e})},a.state={user:u.default.getCurrentUser()},a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"componentDidMount",value:function(){u.default.addChangeListener(this.onListenerChange)}},{key:"componentWillUnmount",value:function(){u.default.removeChangeListener(this.onListenerChange)}},{key:"render",value:function(){return"general"===this.props.activeTab?d.default.createElement("div",null,d.default.createElement(p.default,{user:this.state.user,activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,updateTab:this.props.updateTab,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"security"===this.props.activeTab?d.default.createElement("div",null,d.default.createElement(h.default,{user:this.state.user,activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal,setRequireConfirm:this.props.setRequireConfirm})):"notifications"===this.props.activeTab?d.default.createElement("div",null,d.default.createElement(g.default,{user:this.state.user,activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"display"===this.props.activeTab?d.default.createElement("div",null,d.default.createElement(m.default,{user:this.state.user,activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal,setEnforceFocus:this.props.setEnforceFocus,setRequireConfirm:this.props.setRequireConfirm})):"sidebar"===this.props.activeTab?d.default.createElement("div",null,d.default.createElement(v.default,{activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"advanced"===this.props.activeTab?d.default.createElement("div",null,d.default.createElement(f.default,{activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):d.default.createElement("div",null)}}]),t}(d.default.Component);t.default=S,S.propTypes={activeTab:o.default.string,activeSection:o.default.string,prevActiveSection:o.default.string,updateSection:o.default.func,updateTab:o.default.func,closeModal:o.default.func.isRequired,collapseModal:o.default.func.isRequired,setEnforceFocus:o.default.func.isRequired,setRequireConfirm:o.default.func.isRequired}},2285:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(96),n=function(e){return e&&e.__esModule?e:{default:e}}(a(2286));t.default=(0,s.connect)(function(e){var t=(0,i.getConfig)(e);return{enablePreviewFeatures:"true"===t.EnablePreviewFeatures,enableUserDeactivation:"true"===t.EnableUserDeactivation}})(n.default)},2286:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=N(a(832)),i=N(a(776)),n=N(a(126)),l=N(a(282)),r=N(a(281)),o=N(a(285)),d=N(a(283)),u=N(a(284)),c=N(a(1)),f=N(a(3)),m=a(766),p=a(781),g=a(773),h=N(a(810)),v=N(a(774)),E=N(a(22)),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(765)),M=N(a(809)),b=N(a(817)),_=N(a(806)),y=N(a(2287)),k=N(a(2289));function N(e){return e&&e.__esModule?e:{default:e}}var A=E.default.PRE_RELEASE_FEATURES,C=function(e){function t(e){(0,r.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return a.getStateFromStores=function(){var e=h.default.getCategory(E.default.Preferences.CATEGORY_ADVANCED_SETTINGS),t={send_on_ctrl_enter:h.default.get(E.default.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter","false"),formatting:h.default.get(E.default.Preferences.CATEGORY_ADVANCED_SETTINGS,"formatting","true"),join_leave:h.default.get(E.default.Preferences.CATEGORY_ADVANCED_SETTINGS,"join_leave","true")},l=(0,n.default)(A),r=0,o=!0,d=!1,u=void 0;try{for(var c,f=(0,i.default)(e);!(o=(c=f.next()).done);o=!0){var m=(0,s.default)(c.value,2),p=m[0],g=m[1],v=!0,S=!1,M=void 0;try{for(var b,_=(0,i.default)(l);!(v=(b=_.next()).done);v=!0){var y=b.value,k=A[y];p===E.default.FeatureTogglePrefix+k.label&&(t[p]=g,"true"===g&&(r+=1))}}catch(e){S=!0,M=e}finally{try{!v&&_.return&&_.return()}finally{if(S)throw M}}}}catch(e){d=!0,u=e}finally{try{!o&&f.return&&f.return()}finally{if(d)throw u}}var N=a.props.enablePreviewFeatures;return{preReleaseFeatures:A,settings:t,preReleaseFeaturesKeys:l,enabledFeatures:r,isSaving:!1,previewFeaturesEnabled:N,showDeactivateAccountModal:!1}},a.updateSetting=function(e,t){var s=a.state.settings;s[e]=t,a.setState(s)},a.toggleFeature=function(e,t){var s=a.state.settings;s[E.default.FeatureTogglePrefix+e]=String(t);var i=0;(0,n.default)(a.state.settings).forEach(function(e){0===e.lastIndexOf(E.default.FeatureTogglePrefix)&&"true"===a.state.settings[e]&&i++}),a.setState({settings:s,enabledFeatures:i})},a.saveEnabledFeatures=function(){var e=[];(0,n.default)(a.state.settings).forEach(function(t){0===t.lastIndexOf(E.default.FeatureTogglePrefix)&&e.push(t)}),a.handleSubmit(e)},a.handleSubmit=function(e){var t=[],s=v.default.getCurrentId();(Array.isArray(e)?e:[e]).forEach(function(e){t.push({user_id:s,category:E.default.Preferences.CATEGORY_ADVANCED_SETTINGS,name:e,value:a.state.settings[e]})}),a.setState({isSaving:!0}),(0,p.savePreferences)(t,function(){a.handleUpdateSection("")})},a.handleDeactivateAccountSubmit=function(){var e=v.default.getCurrentId();a.setState({isSaving:!0}),(0,p.updateActive)(e,!1,null,function(e){a.setState({serverError:e.message})}),(0,p.revokeAllSessions)(e,function(){(0,g.emitUserLoggedOutEvent)()},function(e){a.setState({serverError:e.message})})},a.handleShowDeactivateAccountModal=function(){a.setState({showDeactivateAccountModal:!0})},a.handleHideDeactivateAccountModal=function(){a.setState({showDeactivateAccountModal:!1})},a.handleUpdateSection=function(e){e||a.setState(a.getStateFromStores()),a.setState({isSaving:!1}),a.props.updateSection(e)},a.renderFormattingSection=function(){return"formatting"===a.props.activeSection?f.default.createElement(M.default,{title:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"}),inputs:[f.default.createElement("div",{key:"formattingSetting"},f.default.createElement("div",{className:"radio"},f.default.createElement("label",null,f.default.createElement("input",{id:"postFormattingOn",type:"radio",name:"formatting",checked:"false"!==a.state.settings.formatting,onChange:a.updateSetting.bind(a,"formatting","true")}),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.on",defaultMessage:"On"})),f.default.createElement("br",null)),f.default.createElement("div",{className:"radio"},f.default.createElement("label",null,f.default.createElement("input",{id:"postFormattingOff",type:"radio",name:"formatting",checked:"false"===a.state.settings.formatting,onChange:a.updateSetting.bind(a,"formatting","false")}),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.off",defaultMessage:"Off"})),f.default.createElement("br",null)),f.default.createElement("div",null,f.default.createElement("br",null),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.formattingDesc",defaultMessage:"If enabled, posts will be formatted to create links, show emoji, style the text, and add line breaks. By default, this setting is enabled. Changing this setting requires the page to be refreshed."})))],setting:"formatting",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.handleUpdateSection}):f.default.createElement(b.default,{title:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"}),describe:a.renderOnOffLabel(a.state.settings.formatting),focused:a.props.prevActiveSection===a.prevSections.formatting,section:"formatting",updateSection:a.handleUpdateSection})},a.state=a.getStateFromStores(),a.prevSections={advancedCtrlSend:"dummySectionName",formatting:"advancedCtrlSend",join_leave:"formatting",advancedPreviewFeatures:"join_leave",deactivateAccount:"advancedPreviewFeatures"},a}return(0,u.default)(t,e),(0,o.default)(t,[{key:"renderOnOffLabel",value:function(e){return"false"===e?f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.off",defaultMessage:"Off"}):f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.on",defaultMessage:"On"})}},{key:"renderFeatureLabel",value:function(e){switch(e){case"MARKDOWN_PREVIEW":return f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.markdown_preview",defaultMessage:"Show markdown preview option in message input box"});default:return null}}},{key:"render",value:function(){var e=this,t=this.state.serverError||null,a=void 0;if("advancedCtrlSend"===this.props.activeSection){var s=["true"===this.state.settings.send_on_ctrl_enter,"false"===this.state.settings.send_on_ctrl_enter],i=[f.default.createElement("div",{key:"ctrlSendSetting"},f.default.createElement("div",{className:"radio"},f.default.createElement("label",null,f.default.createElement("input",{id:"ctrlSendOn",type:"radio",name:"sendOnCtrlEnter",checked:s[0],onChange:this.updateSetting.bind(this,"send_on_ctrl_enter","true")}),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.on",defaultMessage:"On"})),f.default.createElement("br",null)),f.default.createElement("div",{className:"radio"},f.default.createElement("label",null,f.default.createElement("input",{id:"ctrlSendOff",type:"radio",name:"sendOnCtrlEnter",checked:s[1],onChange:this.updateSetting.bind(this,"send_on_ctrl_enter","false")}),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.off",defaultMessage:"Off"})),f.default.createElement("br",null)),f.default.createElement("div",null,f.default.createElement("br",null),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.sendDesc",defaultMessage:"If enabled ENTER inserts a new line and CTRL+ENTER submits the message."})))];a=f.default.createElement(M.default,{title:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.sendTitle",defaultMessage:"Send messages on CTRL+ENTER"}),inputs:i,setting:"send_on_ctrl_enter",submit:this.handleSubmit,saving:this.state.isSaving,server_error:t,updateSection:this.handleUpdateSection})}else a=f.default.createElement(b.default,{title:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.sendTitle",defaultMessage:"Send messages on CTRL+ENTER"}),describe:this.renderOnOffLabel(this.state.settings.send_on_ctrl_enter),focused:this.props.prevActiveSection===this.prevSections.advancedCtrlSend,section:"advancedCtrlSend",updateSection:this.handleUpdateSection});var n=this.renderFormattingSection(),l=null;n&&(l=f.default.createElement("div",{className:"divider-light"}));var r=void 0,o=void 0;if(this.state.previewFeaturesEnabled&&this.state.preReleaseFeaturesKeys.length>0)if(o=f.default.createElement("div",{className:"divider-light"}),"advancedPreviewFeatures"===this.props.activeSection){var d=[];this.state.preReleaseFeaturesKeys.forEach(function(t){var a=e.state.preReleaseFeatures[t];d.push(f.default.createElement("div",{key:"advancedPreviewFeatures_"+a.label},f.default.createElement("div",{className:"checkbox"},f.default.createElement("label",null,f.default.createElement("input",{id:"advancedPreviewFeatures"+a.label,type:"checkbox",checked:"true"===e.state.settings[E.default.FeatureTogglePrefix+a.label],onChange:function(t){e.toggleFeature(a.label,t.target.checked)}}),e.renderFeatureLabel(t)))))}),d.push(f.default.createElement("div",{key:"advancedPreviewFeatures_helptext"},f.default.createElement("br",null),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.preReleaseDesc",defaultMessage:"Check any pre-released features you'd like to preview.  You may also need to refresh the page before the setting will take effect."}))),r=f.default.createElement(M.default,{title:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.preReleaseTitle",defaultMessage:"Preview pre-release features"}),inputs:d,submit:this.saveEnabledFeatures,saving:this.state.isSaving,server_error:t,updateSection:this.handleUpdateSection})}else r=f.default.createElement(b.default,{title:S.localizeMessage("user.settings.advance.preReleaseTitle","Preview pre-release features"),describe:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.enabledFeatures",defaultMessage:"{count, number} {count, plural, one {Feature} other {Features}} Enabled",values:{count:this.state.enabledFeatures}}),focused:this.props.prevActiveSection===this.prevSections.advancedPreviewFeatures,section:"advancedPreviewFeatures",updateSection:this.handleUpdateSection});var u="",c="";if(""===v.default.getCurrentUser().auth_service&&this.props.enableUserDeactivation){u="deactivateAccount"===this.props.activeSection?f.default.createElement(M.default,{title:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.deactivateAccountTitle",defaultMessage:"Deactivate Account"}),inputs:[f.default.createElement("div",{key:"formattingSetting"},f.default.createElement("div",null,f.default.createElement("br",null),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.deactivateDesc",defaultMessage:"Deactivating your account removes your ability to log in to this server and disables all email and mobile notifications. To reactivate your account, contact your System Administrator."})))],saveButtonText:"Deactivate",setting:"deactivateAccount",submit:this.handleShowDeactivateAccountModal,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):f.default.createElement(b.default,{title:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.deactivateAccountTitle",defaultMessage:"Deactivate Account"}),describe:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.deactivateDescShort",defaultMessage:"Click 'Edit' to deactivate your account"}),focused:this.props.prevActiveSection===this.prevSections.deactivateAccount,section:"deactivateAccount",updateSection:this.handleUpdateSection});var p=f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.deactivate_member_modal.deactivateButton",defaultMessage:"Yes, deactivate my account"});c=f.default.createElement(_.default,{show:this.state.showDeactivateAccountModal,title:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.confirmDeactivateAccountTitle",defaultMessage:"Confirm Deactivation"}),message:f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.confirmDeactivateDesc",defaultMessage:"Are you sure you want to deactivate your account? This can only be reversed by your System Administrator."}),confirmButtonClass:"btn btn-danger",confirmButtonText:p,onConfirm:this.handleDeactivateAccountSubmit,onCancel:this.handleHideDeactivateAccountModal})}return f.default.createElement("div",null,f.default.createElement("div",{className:"modal-header"},f.default.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},f.default.createElement("span",{"aria-hidden":"true"},"×")),f.default.createElement("h4",{className:"modal-title",ref:"title"},f.default.createElement("div",{className:"modal-back"},f.default.createElement("i",{className:"fa fa-angle-left",title:S.localizeMessage("generic_icons.back","Back Icon"),onClick:this.props.collapseModal})),f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.title",defaultMessage:"Advanced Settings"}))),f.default.createElement("div",{className:"user-settings"},f.default.createElement("h3",{className:"tab-header"},f.default.createElement(m.FormattedMessage,{id:"user.settings.advance.title",defaultMessage:"Advanced Settings"})),f.default.createElement("div",{className:"divider-dark first"}),a,f.default.createElement(k.default,{activeSection:this.props.activeSection,onUpdateSection:this.handleUpdateSection,prevActiveSection:this.props.prevActiveSection,renderOnOffLabel:this.renderOnOffLabel}),l,n,f.default.createElement("div",{className:"divider-light"}),f.default.createElement(y.default,{activeSection:this.props.activeSection,onUpdateSection:this.handleUpdateSection,prevActiveSection:this.props.prevActiveSection,renderOnOffLabel:this.renderOnOffLabel}),o,r,l,u,f.default.createElement("div",{className:"divider-dark"}),c))}}]),t}(f.default.Component);t.default=C,C.propTypes={updateSection:c.default.func,activeSection:c.default.string,prevActiveSection:c.default.string,closeModal:c.default.func.isRequired,collapseModal:c.default.func.isRequired,enablePreviewFeatures:c.default.bool,enableUserDeactivation:c.default.bool}},2287:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(2),i=a(286),n=a(831),l=a(25),r=a(775),o=a(770),d=function(e){return e&&e.__esModule?e:{default:e}}(a(2288));t.default=(0,i.connect)(function(e){var t=(0,r.get)(e,l.Preferences.CATEGORY_ADVANCED_SETTINGS,l.Preferences.ADVANCED_FILTER_JOIN_LEAVE,"true");return{currentUserId:(0,o.getCurrentUserId)(e),joinLeave:t}},function(e){return{actions:(0,s.bindActionCreators)({savePreferences:n.savePreferences},e)}})(d.default)},2288:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=g(a(282)),i=g(a(281)),n=g(a(285)),l=g(a(283)),r=g(a(284)),o=g(a(3)),d=g(a(1)),u=a(766),c=a(25),f=g(a(809)),m=g(a(817)),p=a(22);function g(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.handleOnChange=function(e){var t=e.currentTarget.value;a.setState({joinLeaveState:t})},a.handleUpdateSection=function(e){e||a.setState({joinLeaveState:a.props.joinLeave}),a.props.onUpdateSection(e)},a.handleSubmit=function(){var e=a.props,t=e.actions,s=e.currentUserId,i=e.onUpdateSection,n={category:c.Preferences.CATEGORY_ADVANCED_SETTINGS,user_id:s,name:c.Preferences.ADVANCED_FILTER_JOIN_LEAVE,value:a.state.joinLeaveState};t.savePreferences(s,[n]),i()},a.state={joinLeaveState:e.joinLeave},a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this.state.joinLeaveState;return this.props.activeSection===p.AdvancedSections.JOIN_LEAVE?o.default.createElement(f.default,{title:o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"}),inputs:[o.default.createElement("div",{key:"joinLeaveSetting"},o.default.createElement("div",{className:"radio"},o.default.createElement("label",null,o.default.createElement("input",{id:"joinLeaveOn",type:"radio",value:"true",name:p.AdvancedSections.JOIN_LEAVE,checked:"true"===e,onChange:this.handleOnChange}),o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.on",defaultMessage:"On"})),o.default.createElement("br",null)),o.default.createElement("div",{className:"radio"},o.default.createElement("label",null,o.default.createElement("input",{id:"joinLeaveOff",type:"radio",value:"false",name:p.AdvancedSections.JOIN_LEAVE,checked:"false"===e,onChange:this.handleOnChange}),o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.off",defaultMessage:"Off"})),o.default.createElement("br",null)),o.default.createElement("div",null,o.default.createElement("br",null),o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.joinLeaveDesc",defaultMessage:'When "On", System Messages saying a user has joined or left a channel will be visible. When "Off", the System Messages about joining or leaving a channel will be hidden. A message will still show up when you are added to a channel, so you can receive a notification.'})))],setting:p.AdvancedSections.JOIN_LEAVE,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):o.default.createElement(m.default,{title:o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"}),describe:this.props.renderOnOffLabel(e),focused:this.props.prevActiveSection===p.AdvancedSections.JOIN_LEAVE,section:p.AdvancedSections.JOIN_LEAVE,updateSection:this.handleUpdateSection})}}]),t}(o.default.PureComponent);h.propTypes={activeSection:d.default.string,currentUserId:d.default.string.isRequired,joinLeave:d.default.string,onUpdateSection:d.default.func.isRequired,prevActiveSection:d.default.string,renderOnOffLabel:d.default.func.isRequired,actions:d.default.shape({savePreferences:d.default.func.isRequired}).isRequired},t.default=h},2289:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(2),i=a(286),n=a(831),l=a(25),r=a(775),o=a(770),d=function(e){return e&&e.__esModule?e:{default:e}}(a(2290));t.default=(0,i.connect)(function(e){return{currentUserId:(0,o.getCurrentUserId)(e),codeBlockOnCtrlEnter:(0,r.get)(e,l.Preferences.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter","true"),sendMessageOnCtrlEnter:(0,r.getBool)(e,l.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter")}},function(e){return{actions:(0,s.bindActionCreators)({savePreferences:n.savePreferences},e)}})(d.default)},2290:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=g(a(282)),i=g(a(281)),n=g(a(285)),l=g(a(283)),r=g(a(284)),o=g(a(3)),d=g(a(1)),u=a(766),c=a(25),f=g(a(809)),m=g(a(817)),p=a(22);function g(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.handleOnChange=function(e){var t=e.currentTarget.value;a.setState({codeBlockOnCtrlEnterState:t})},a.handleUpdateSection=function(e){e||a.setState({codeBlockOnCtrlEnterState:a.props.codeBlockOnCtrlEnter}),a.props.onUpdateSection(e)},a.handleSubmit=function(){var e=a.props,t=e.actions,s=e.currentUserId,i=e.onUpdateSection,n={user_id:s,category:c.Preferences.CATEGORY_ADVANCED_SETTINGS,name:"code_block_ctrl_enter",value:a.state.codeBlockOnCtrlEnterState};t.savePreferences(s,[n]),i()},a.state={codeBlockOnCtrlEnterState:e.codeBlockOnCtrlEnter},a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){if(this.props.sendMessageOnCtrlEnter)return null;var e=this.state.codeBlockOnCtrlEnterState,t=o.default.createElement(m.default,{title:o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.codeBlockOnCtrlEnterSendTitle",defaultMessage:"Send code block messages on CTRL + ENTER"}),describe:this.props.renderOnOffLabel(e),focused:this.props.prevActiveSection===p.AdvancedSections.CODE_BLOCK_ON_CTRL_ENTER,section:p.AdvancedSections.CODE_BLOCK_ON_CTRL_ENTER,updateSection:this.handleUpdateSection});return this.props.activeSection===p.AdvancedSections.CODE_BLOCK_ON_CTRL_ENTER&&(t=o.default.createElement(f.default,{title:o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.codeBlockOnCtrlEnterSendTitle",defaultMessage:"Send code block messages on CTRL + ENTER"}),inputs:[o.default.createElement("div",{key:"codeBlockOnCtrlEnterSetting"},o.default.createElement("div",{className:"radio"},o.default.createElement("label",null,o.default.createElement("input",{id:"codeBlockOnCtrlEnterOn",type:"radio",value:"true",name:p.AdvancedSections.CODE_BLOCK_ON_CTRL_ENTER,checked:"true"===e,onChange:this.handleOnChange}),o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.on",defaultMessage:"On"})),o.default.createElement("br",null)),o.default.createElement("div",{className:"radio"},o.default.createElement("label",null,o.default.createElement("input",{id:"codeBlockOnCtrlEnterOff",type:"radio",value:"false",name:p.AdvancedSections.CODE_BLOCK_ON_CTRL_ENTER,checked:"false"===e,onChange:this.handleOnChange}),o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.off",defaultMessage:"Off"})),o.default.createElement("br",null)),o.default.createElement("div",null,o.default.createElement("br",null),o.default.createElement(u.FormattedMessage,{id:"user.settings.advance.codeBlockOnCtrlEnterSendDesc",defaultMessage:"If enabled, ENTER inserts a new line within messages formatted as code starting with ```. CTRL + ENTER submits the message."})))],setting:p.AdvancedSections.CODE_BLOCK_ON_CTRL_ENTER,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection})),o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"divider-light"}),t)}}]),t}(o.default.PureComponent);h.propTypes={activeSection:d.default.string,currentUserId:d.default.string.isRequired,codeBlockOnCtrlEnter:d.default.string,sendMessageOnCtrlEnter:d.default.bool,onUpdateSection:d.default.func.isRequired,prevActiveSection:d.default.string,renderOnOffLabel:d.default.func.isRequired,actions:d.default.shape({savePreferences:d.default.func.isRequired}).isRequired},t.default=h},2291:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(2),n=a(900),l=a(1100),r=a(96),o=a(770),d=a(931),u=a(901),c=function(e){return e&&e.__esModule?e:{default:e}}(a(2292));t.default=(0,s.connect)(function(e){var t=(0,r.getConfig)(e),a=(0,r.getSupportedTimezones)(e),s=(0,o.getCurrentUserId)(e),i=(0,d.getUserTimezone)(e,s),n=i&&i.useAutomaticTimezone&&!i.automaticTimezone,l=!i||n,c="true"===t.AllowCustomThemes,f="true"===t.EnableLinkPreviews,m=t.DefaultClientLocale,p="true"===t.EnableThemeSelection,g="true"===t.ExperimentalTimezone;return{allowCustomThemes:c,configTeammateNameDisplay:t.TeammateNameDisplay,enableLinkPreviews:f,defaultClientLocale:m,enableThemeSelection:p,enableTimezone:g,timezones:a,userTimezone:i,shouldAutoUpdateTimezone:l,currentUserTimezone:(0,u.getUserCurrentTimezone)(i)}},function(e){return{actions:(0,i.bindActionCreators)({getSupportedTimezones:n.getSupportedTimezones,autoUpdateTimezone:l.autoUpdateTimezone},e)}})(c.default)},2292:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=T(a(126)),i=T(a(42)),n=T(a(282)),l=T(a(281)),r=T(a(285)),o=T(a(283)),d=T(a(284)),u=T(a(1)),c=T(a(3)),f=a(901),m=a(766),p=a(781),g=T(a(810)),h=T(a(774)),v=T(a(22)),E=C(a(765)),S=a(932),M=C(a(944)),b=a(288),_=T(a(809)),y=T(a(817)),k=T(a(2293)),N=T(a(2295)),A=T(a(2296));function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function T(e){return e&&e.__esModule?e:{default:e}}var w=v.default.Preferences;function F(e){return{militaryTime:g.default.get(w.CATEGORY_DISPLAY_SETTINGS,w.USE_MILITARY_TIME,w.USE_MILITARY_TIME_DEFAULT),teammateNameDisplay:g.default.get(w.CATEGORY_DISPLAY_SETTINGS,w.NAME_NAME_FORMAT,e.configTeammateNameDisplay),channelDisplayMode:g.default.get(w.CATEGORY_DISPLAY_SETTINGS,w.CHANNEL_DISPLAY_MODE,w.CHANNEL_DISPLAY_MODE_DEFAULT),messageDisplay:g.default.get(w.CATEGORY_DISPLAY_SETTINGS,w.MESSAGE_DISPLAY,w.MESSAGE_DISPLAY_DEFAULT),collapseDisplay:g.default.get(w.CATEGORY_DISPLAY_SETTINGS,w.COLLAPSE_DISPLAY,w.COLLAPSE_DISPLAY_DEFAULT),linkPreviewDisplay:g.default.get(w.CATEGORY_DISPLAY_SETTINGS,w.LINK_PREVIEW_DISPLAY,w.LINK_PREVIEW_DISPLAY_DEFAULT)}}var I=function(e){function t(e){(0,l.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.handleSubmit=function(){var e=h.default.getCurrentId(),t={user_id:e,category:w.CATEGORY_DISPLAY_SETTINGS,name:w.USE_MILITARY_TIME,value:a.state.militaryTime},s={user_id:e,category:w.CATEGORY_DISPLAY_SETTINGS,name:w.NAME_NAME_FORMAT,value:a.state.teammateNameDisplay},i={user_id:e,category:w.CATEGORY_DISPLAY_SETTINGS,name:w.CHANNEL_DISPLAY_MODE,value:a.state.channelDisplayMode},n={user_id:e,category:w.CATEGORY_DISPLAY_SETTINGS,name:w.MESSAGE_DISPLAY,value:a.state.messageDisplay},l={user_id:e,category:w.CATEGORY_DISPLAY_SETTINGS,name:w.COLLAPSE_DISPLAY,value:a.state.collapseDisplay},r={user_id:e,category:w.CATEGORY_DISPLAY_SETTINGS,name:w.LINK_PREVIEW_DISPLAY,value:a.state.linkPreviewDisplay};a.setState({isSaving:!0});var o=[t,i,n,l,r,s];(0,p.savePreferences)(o,function(){a.updateSection("")})},a.handleClockRadio=function(e){a.setState({militaryTime:e})},a.handleTeammateNameDisplayRadio=function(e){a.setState({teammateNameDisplay:e})},a.updateSection=function(e){a.updateState(),a.props.updateSection(e)},a.updateState=function(){var e=F(a.props);E.areObjectsEqual(e,a.state)||a.setState(e),a.setState({isSaving:!1})},a.state=(0,i.default)({},F(e),{isSaving:!1}),0===e.timezones.length&&e.actions.getSupportedTimezones(),a.prevSections={theme:"dummySectionName",clock:"theme",linkpreview:"clock",message_display:"linkpreview",channel_display_mode:"message_display",languages:"channel_display_mode"},a}return(0,d.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.actions,a=e.enableTimezone,s=e.shouldAutoUpdateTimezone;a&&s&&t.autoUpdateTimezone((0,S.getBrowserTimezone)())}},{key:"handleChannelDisplayModeRadio",value:function(e){this.setState({channelDisplayMode:e})}},{key:"handlemessageDisplayRadio",value:function(e){this.setState({messageDisplay:e})}},{key:"handleCollapseRadio",value:function(e){this.setState({collapseDisplay:e})}},{key:"handleLinkPreviewRadio",value:function(e){this.setState({linkPreviewDisplay:e})}},{key:"handleOnChange",value:function(e){this.setState((0,i.default)({},e))}},{key:"createSection",value:function(e){var t=this,a=e.section,s=e.display,i=e.value,n=e.title,l=e.firstOption,r=e.secondOption,o=e.thirdOption,d=e.description,u=c.default.createElement(m.FormattedMessage,{id:l.radionButtonText.id,defaultMessage:l.radionButtonText.message}),f=void 0,p=void 0;l.radionButtonText.moreId&&(f=": ",p=c.default.createElement("span",{className:"font-weight--normal"},c.default.createElement(m.FormattedMessage,{id:l.radionButtonText.moreId,defaultMessage:l.radionButtonText.moreMessage})));var g=c.default.createElement(m.FormattedMessage,{id:r.radionButtonText.id,defaultMessage:r.radionButtonText.message}),h=void 0;r.radionButtonText.moreId&&(h=c.default.createElement("span",{className:"font-weight--normal"},c.default.createElement(m.FormattedMessage,{id:r.radionButtonText.moreId,defaultMessage:r.radionButtonText.moreMessage})));var v=void 0;o&&(v=c.default.createElement(m.FormattedMessage,{id:o.radionButtonText.id,defaultMessage:o.radionButtonText.message}));var E=c.default.createElement(m.FormattedMessage,{id:n.id,defaultMessage:n.message}),S=c.default.createElement(m.FormattedMessage,{id:d.id,defaultMessage:d.message});if(this.props.activeSection===a){var M=[!1,!1,!1];i===l.value?M[0]=!0:i===r.value?M[1]=!0:M[2]=!0;var b=a+"Format",k=a+"UserDisplay",N={};N[s]=l.value;var A={};A[s]=r.value;var C={};o&&(C[s]=o.value);var T=void 0;v&&(T=c.default.createElement("div",{className:"radio"},c.default.createElement("label",null,c.default.createElement("input",{id:b+"C",type:"radio",name:b,checked:M[2],onChange:function(){return t.handleOnChange(C)}}),v),c.default.createElement("br",null)));var w=[c.default.createElement("div",{key:k},c.default.createElement("div",{className:"radio"},c.default.createElement("label",null,c.default.createElement("input",{id:b+"A",type:"radio",name:b,checked:M[0],onChange:function(){return t.handleOnChange(N)}}),u,f,p),c.default.createElement("br",null)),c.default.createElement("div",{className:"radio"},c.default.createElement("label",null,c.default.createElement("input",{id:b+"B",type:"radio",name:b,checked:M[1],onChange:function(){return t.handleOnChange(A)}}),g,f,h),c.default.createElement("br",null)),T,c.default.createElement("div",null,c.default.createElement("br",null),S))];return c.default.createElement("div",null,c.default.createElement(_.default,{title:E,inputs:w,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.updateSection}),c.default.createElement("div",{className:"divider-dark"}))}var F=void 0;return F=i===l.value?u:i===r.value?g:v,c.default.createElement("div",null,c.default.createElement(y.default,{title:E,describe:F,focused:this.props.prevActiveSection===this.prevSections[a],section:a,updateSection:this.updateSection}),c.default.createElement("div",{className:"divider-dark"}))}},{key:"render",value:function(){var e=this.createSection({section:"collapse",display:"collapseDisplay",value:this.state.collapseDisplay,defaultDisplay:"false",title:{id:(0,b.t)("user.settings.display.collapseDisplay"),message:"Default appearance of image previews"},firstOption:{value:"false",radionButtonText:{id:(0,b.t)("user.settings.display.collapseOn"),message:"On"}},secondOption:{value:"true",radionButtonText:{id:(0,b.t)("user.settings.display.collapseOff"),message:"Off"}},description:{id:(0,b.t)("user.settings.display.collapseDesc"),message:"Set whether previews of image links and image attachment thumbnails show as expanded or collapsed by default. This setting can also be controlled using the slash commands /expand and /collapse."}}),t=null;this.props.enableLinkPreviews?(t=this.createSection({section:"linkpreview",display:"linkPreviewDisplay",value:this.state.linkPreviewDisplay,defaultDisplay:"true",title:{id:(0,b.t)("user.settings.display.linkPreviewDisplay"),message:"Website Link Previews"},firstOption:{value:"true",radionButtonText:{id:(0,b.t)("user.settings.display.linkPreviewOn"),message:"On"}},secondOption:{value:"false",radionButtonText:{id:(0,b.t)("user.settings.display.linkPreviewOff"),message:"Off"}},description:{id:(0,b.t)("user.settings.display.linkPreviewDesc"),message:"When available, the first web link in a message will show a preview of the website content below the message."}}),this.prevSections.message_display="linkpreview"):this.prevSections.message_display=this.prevSections.linkpreview;var a=this.createSection({section:"clock",display:"militaryTime",value:this.state.militaryTime,defaultDisplay:"false",title:{id:(0,b.t)("user.settings.display.clockDisplay"),message:"Clock Display"},firstOption:{value:"false",radionButtonText:{id:(0,b.t)("user.settings.display.normalClock"),message:"12-hour clock (example: 4:00 PM)"}},secondOption:{value:"true",radionButtonText:{id:(0,b.t)("user.settings.display.militaryClock"),message:"24-hour clock (example: 16:00)"}},description:{id:(0,b.t)("user.settings.display.preferTime"),message:"Select how you prefer time displayed."}}),i=this.createSection({section:w.NAME_NAME_FORMAT,display:"teammateNameDisplay",value:this.state.teammateNameDisplay,defaultDisplay:this.props.configTeammateNameDisplay,title:{id:(0,b.t)("user.settings.display.teammateNameDisplayTitle"),message:"Teammate Name Display"},firstOption:{value:v.default.TEAMMATE_NAME_DISPLAY.SHOW_USERNAME,radionButtonText:{id:(0,b.t)("user.settings.display.teammateNameDisplayUsername"),message:"Show username"}},secondOption:{value:v.default.TEAMMATE_NAME_DISPLAY.SHOW_NICKNAME_FULLNAME,radionButtonText:{id:(0,b.t)("user.settings.display.teammateNameDisplayNicknameFullname"),message:"Show nickname if one exists, otherwise show first and last name"}},thirdOption:{value:v.default.TEAMMATE_NAME_DISPLAY.SHOW_FULLNAME,radionButtonText:{id:(0,b.t)("user.settings.display.teammateNameDisplayFullname"),message:"Show first and last name"}},description:{id:(0,b.t)("user.settings.display.teammateNameDisplayDescription"),message:"Set how to display other user's names in posts and the Direct Messages list."}}),n=void 0;if(this.props.enableTimezone&&!this.props.shouldAutoUpdateTimezone){var l=this.props.userTimezone;n="timezone"===this.props.activeSection?c.default.createElement("div",null,c.default.createElement(k.default,{user:this.props.user,timezones:this.props.timezones,useAutomaticTimezone:l.useAutomaticTimezone,automaticTimezone:l.automaticTimezone,manualTimezone:l.manualTimezone,updateSection:this.updateSection}),c.default.createElement("div",{className:"divider-dark"})):c.default.createElement("div",null,c.default.createElement(y.default,{title:c.default.createElement(m.FormattedMessage,{id:"user.settings.display.timezone",defaultMessage:"Timezone"}),width:"medium",describe:(0,f.getTimezoneRegion)(this.props.currentUserTimezone),section:"timezone",updateSection:this.updateSection}),c.default.createElement("div",{className:"divider-dark"}))}var r=this.createSection({section:w.MESSAGE_DISPLAY,display:"messageDisplay",value:this.state.messageDisplay,defaultDisplay:w.MESSAGE_DISPLAY_CLEAN,title:{id:(0,b.t)("user.settings.display.messageDisplayTitle"),message:"Message Display"},firstOption:{value:w.MESSAGE_DISPLAY_CLEAN,radionButtonText:{id:(0,b.t)("user.settings.display.messageDisplayClean"),message:"Standard",moreId:(0,b.t)("user.settings.display.messageDisplayCleanDes"),moreMessage:"Easy to scan and read."}},secondOption:{value:w.MESSAGE_DISPLAY_COMPACT,radionButtonText:{id:(0,b.t)("user.settings.display.messageDisplayCompact"),message:"Compact",moreId:(0,b.t)("user.settings.display.messageDisplayCompactDes"),moreMessage:"Fit as many messages on the screen as we can."}},description:{id:(0,b.t)("user.settings.display.messageDisplayDescription"),message:"Select how messages in a channel should be displayed."}}),o=this.createSection({section:w.CHANNEL_DISPLAY_MODE,display:"channelDisplayMode",value:this.state.channelDisplayMode,defaultDisplay:w.CHANNEL_DISPLAY_MODE_FULL_SCREEN,title:{id:(0,b.t)("user.settings.display.channelDisplayTitle"),message:"Channel Display Mode"},firstOption:{value:w.CHANNEL_DISPLAY_MODE_FULL_SCREEN,radionButtonText:{id:(0,b.t)("user.settings.display.fullScreen"),message:"Full width"}},secondOption:{value:w.CHANNEL_DISPLAY_MODE_CENTERED,radionButtonText:{id:(0,b.t)("user.settings.display.fixedWidthCentered"),message:"Fixed width, centered"}},description:{id:(0,b.t)("user.settings.display.channeldisplaymode"),message:"Select the width of the center channel."}}),d=void 0,u=this.props.user.locale;if("languages"===this.props.activeSection)M.isLanguageAvailable(u)||(u=this.props.defaultClientLocale),d=c.default.createElement("div",null,c.default.createElement(N.default,{user:this.props.user,locale:u,updateSection:this.updateSection}),c.default.createElement("div",{className:"divider-dark"}));else{var p=void 0;p=M.isLanguageAvailable(u)?M.getLanguageInfo(u).name:M.getLanguageInfo(this.props.defaultClientLocale).name,d=c.default.createElement("div",null,c.default.createElement(y.default,{title:c.default.createElement(m.FormattedMessage,{id:"user.settings.display.language",defaultMessage:"Language"}),width:"medium",describe:p,focused:this.props.prevActiveSection===this.prevSections.languages,section:"languages",updateSection:this.updateSection}),c.default.createElement("div",{className:"divider-dark"}))}1===(0,s.default)(M.getLanguages()).length&&(d=null);var g=void 0;return this.props.enableThemeSelection&&(g=c.default.createElement("div",null,c.default.createElement(A.default,{selected:"theme"===this.props.activeSection,updateSection:this.updateSection,setRequireConfirm:this.props.setRequireConfirm,setEnforceFocus:this.props.setEnforceFocus,allowCustomThemes:this.props.allowCustomThemes}),c.default.createElement("div",{className:"divider-dark"}))),c.default.createElement("div",{id:"displaySettings"},c.default.createElement("div",{className:"modal-header"},c.default.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},c.default.createElement("span",{"aria-hidden":"true"},"×")),c.default.createElement("h4",{className:"modal-title",ref:"title"},c.default.createElement("div",{className:"modal-back"},c.default.createElement("i",{className:"fa fa-angle-left",title:E.localizeMessage("generic_icons.back","Back Icon"),onClick:this.props.collapseModal})),c.default.createElement(m.FormattedMessage,{id:"user.settings.display.title",defaultMessage:"Display Settings"}))),c.default.createElement("div",{className:"user-settings"},c.default.createElement("h3",{id:"displaySettingsTitle",className:"tab-header"},c.default.createElement(m.FormattedMessage,{id:"user.settings.display.title",defaultMessage:"Display Settings"})),c.default.createElement("div",{className:"divider-dark first"}),g,a,i,n,t,e,r,o,d))}}]),t}(c.default.Component);t.default=I,I.propTypes={user:u.default.object,updateSection:u.default.func,activeSection:u.default.string,prevActiveSection:u.default.string,closeModal:u.default.func.isRequired,collapseModal:u.default.func.isRequired,setRequireConfirm:u.default.func.isRequired,setEnforceFocus:u.default.func.isRequired,timezones:u.default.array.isRequired,userTimezone:u.default.object.isRequired,allowCustomThemes:u.default.bool,enableLinkPreviews:u.default.bool,defaultClientLocale:u.default.string,enableThemeSelection:u.default.bool,configTeammateNameDisplay:u.default.string,currentUserTimezone:u.default.string,enableTimezone:u.default.bool,shouldAutoUpdateTimezone:u.default.bool,actions:u.default.shape({getSupportedTimezones:u.default.func.isRequired,autoUpdateTimezone:u.default.func.isRequired}).isRequired}},2293:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=S(a(42)),i=S(a(282)),n=S(a(281)),l=S(a(285)),r=S(a(283)),o=S(a(284)),d=S(a(1)),u=S(a(3)),c=a(901),f=a(766),m=a(781),p=S(a(809)),g=a(932),h=S(a(911)),v=S(a(912)),E=S(a(2294));function S(e){return e&&e.__esModule?e:{default:e}}var M=function(e){function t(e){(0,n.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.onChange=function(e){a.setState({manualTimezoneInput:e.target.value})},a.handleTimezoneSelected=function(e){e&&a.setState({manualTimezone:e,manualTimezoneInput:e})},a.timezoneNotChanged=function(){var e=a.state,t=e.useAutomaticTimezone,s=e.automaticTimezone,i=e.manualTimezone,n=a.props,l=n.useAutomaticTimezone,r=n.automaticTimezone,o=n.manualTimezone;return t===l&&s===r&&i===o},a.changeTimezone=function(){a.timezoneNotChanged()?a.props.updateSection(""):a.submitUser()},a.submitUser=function(){var e=a.props.user,t=a.state,i=t.useAutomaticTimezone,n=t.automaticTimezone,l=t.manualTimezone,r={useAutomaticTimezone:i.toString(),automaticTimezone:n,manualTimezone:l},o=(0,s.default)({},e,{timezone:r});(0,m.updateUser)(o,function(){return a.props.updateSection("")},function(e){var t=void 0;t=e.message?e.message:e,a.setState({serverError:t,isSaving:!1})})},a.handleAutomaticTimezone=function(e){var t=e.target.checked,s="";t&&(s=(0,g.getBrowserTimezone)()),a.setState({useAutomaticTimezone:t,automaticTimezone:s})},a.handleManualTimezone=function(e){a.setState({manualTimezone:e.target.value})},a.state={useAutomaticTimezone:e.useAutomaticTimezone,automaticTimezone:e.automaticTimezone,manualTimezone:e.manualTimezone,manualTimezoneInput:e.manualTimezone,isSaving:!1},a}return(0,o.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.props.timezones,t=this.state,a=t.useAutomaticTimezone,s=t.automaticTimezone,i=void 0;this.state.serverError&&(i=u.default.createElement("label",{className:"has-error"},this.state.serverError));var n=[],l=u.default.createElement("div",{className:"section-describe padding-top"},a&&(0,c.getTimezoneRegion)(s)),r=0===e.length,o=u.default.createElement("div",{className:"checkbox"},u.default.createElement("label",null,u.default.createElement("input",{id:"automaticTimezoneInput",type:"checkbox",checked:a,onChange:this.handleAutomaticTimezone,disabled:r}),u.default.createElement(f.FormattedMessage,{id:"user.settings.timezones.automatic",defaultMessage:"Set automatically"}),l)),d=[new E.default],m=u.default.createElement("div",{key:"changeTimezone"},u.default.createElement("label",{className:"control-label"},u.default.createElement(f.FormattedMessage,{id:"user.settings.timezones.change",defaultMessage:"Change timezone"})),u.default.createElement("div",{className:"padding-top"},u.default.createElement(h.default,{ref:this.setSwitchBoxRef,className:"form-control focused",type:"search",onChange:this.onChange,value:this.state.manualTimezoneInput,onItemSelected:this.handleTimezoneSelected,listComponent:v.default,maxLength:"64",requiredCharacters:0,providers:d,listStyle:"bottom",completeOnTab:!1,renderDividers:!1,openOnFocus:!0,disabled:r}),i));return n.push(o),a||n.push(m),n.push(u.default.createElement("div",null,u.default.createElement("br",null),u.default.createElement(f.FormattedHTMLMessage,{id:"user.settings.timezones.promote",defaultMessage:"Select the time zone used for timestamps in the user interface and email notifications."}))),u.default.createElement(p.default,{title:u.default.createElement(f.FormattedMessage,{id:"user.settings.display.timezone",defaultMessage:"Timezone"}),containerStyle:"timezone-container",width:"medium",submit:this.changeTimezone,saving:this.state.isSaving,inputs:n,updateSection:this.props.updateSection})}}]),t}(u.default.PureComponent);t.default=M,M.propTypes={user:d.default.object.isRequired,updateSection:d.default.func.isRequired,useAutomaticTimezone:d.default.bool.isRequired,automaticTimezone:d.default.string.isRequired,manualTimezone:d.default.string.isRequired,timezones:d.default.array.isRequired}},2294:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=E(a(181)),i=E(a(182)),n=E(a(42)),l=E(a(282)),r=E(a(281)),o=E(a(285)),d=E(a(283)),u=E(a(284)),c=E(a(3)),f=a(901),m=E(a(783)),p=a(22),g=a(932),h=E(a(835)),v=E(a(820));function E(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(){return(0,r.default)(this,t),(0,d.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.item,a="mentions__name";return e.isSelection&&(a+=" suggestion--selected"),c.default.createElement("div",(0,n.default)({onClick:this.handleClick,className:a},v.default.baseProps),t)}}]),t}(v.default),M=function(e){function t(){return(0,r.default)(this,t),(0,d.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"handlePretextChanged",value:function(e,t){return 0===t.length?(this.displayAllTimezones(e,t),!0):!!t&&(this.filterTimezones(e,t),!0)}},{key:"displayAllTimezones",value:function(){var e=(0,i.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout(function(){m.default.handleServerAction({type:p.ActionTypes.SUGGESTION_RECEIVED_SUGGESTIONS,id:t,matchedPretext:"",terms:(0,g.getSupportedTimezones)(),items:(0,g.getSupportedTimezones)(),component:S})},0);case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"filterTimezones",value:function(){var e=(0,i.default)(s.default.mark(function e(t,a){var i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=(0,g.getSupportedTimezones)().filter(function(e){return(0,f.getTimezoneRegion)(e).toLowerCase().indexOf(a)>=0||e.toLowerCase().indexOf(a)>=0}),setTimeout(function(){m.default.handleServerAction({type:p.ActionTypes.SUGGESTION_RECEIVED_SUGGESTIONS,id:t,matchedPretext:a,terms:i,items:i,component:S})},0);case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),t}(h.default);t.default=M},2295:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=S(a(126)),i=S(a(42)),n=S(a(282)),l=S(a(281)),r=S(a(285)),o=S(a(283)),d=S(a(284)),u=S(a(1)),c=S(a(3)),f=a(766),m=E(a(773)),p=a(781),g=E(a(944)),h=S(a(809)),v=S(a(777));function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}var M=function(e){function t(e){(0,l.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.setLanguage=function(e){a.setState({locale:e.target.value})},a.changeLanguage=function(){a.props.user.locale===a.state.locale?a.props.updateSection(""):a.submitUser((0,i.default)({},a.props.user,{locale:a.state.locale}))},a.submitUser=function(e){a.setState({isSaving:!0}),(0,p.updateUser)(e,function(){m.newLocalizationSelected(e.locale)},function(e){var t=void 0;t=e.message?e.message:e,a.setState({serverError:t,isSaving:!1})})},a.state={locale:e.locale,isSaving:!1},a}return(0,d.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=void 0;this.state.serverError&&(e=c.default.createElement("label",{className:"has-error"},this.state.serverError));var t=[],a=g.getLanguages();(0,s.default)(a).map(function(e){return{value:a[e].value,name:a[e].name,order:a[e].order}}).sort(function(e,t){return e.order-t.order}).forEach(function(e){t.push(c.default.createElement("option",{key:e.value,value:e.value},e.name))});var i=c.default.createElement("div",{key:"changeLanguage"},c.default.createElement("br",null),c.default.createElement("label",{className:"control-label"},c.default.createElement(f.FormattedMessage,{id:"user.settings.languages.change",defaultMessage:"Change interface language"})),c.default.createElement("div",{className:"padding-top"},c.default.createElement("select",{id:"displayLanguage",ref:"language",className:"form-control",value:this.state.locale,onChange:this.setLanguage},t),e),c.default.createElement("div",null,c.default.createElement("br",null),c.default.createElement(v.default,{id:"user.settings.languages.promote",defaultMessage:"Select which language Mattermost displays in the user interface.\\n \\nWould you like to help with translations? Join the [Mattermost Translation Server](!http://translate.mattermost.com/) to contribute."})));return c.default.createElement(h.default,{title:c.default.createElement(f.FormattedMessage,{id:"user.settings.display.language",defaultMessage:"Language"}),width:"medium",submit:this.changeLanguage,saving:this.state.isSaving,inputs:[i],updateSection:this.props.updateSection})}}]),t}(c.default.Component);t.default=M,M.propTypes={user:u.default.object.isRequired,locale:u.default.string.isRequired,updateSection:u.default.func.isRequired}},2296:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=T(a(126)),i=T(a(42)),n=T(a(184)),l=T(a(282)),r=T(a(281)),o=T(a(285)),d=T(a(283)),u=T(a(284)),c=T(a(771)),f=T(a(1)),m=T(a(3)),p=T(a(290)),g=a(766),h=C(a(781)),v=T(a(810)),E=T(a(782)),S=T(a(774)),M=a(22),b=C(a(765)),_=T(a(783)),y=T(a(809)),k=T(a(817)),N=T(a(2297)),A=T(a(2450));function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function T(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(e){(0,r.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return a.onChange=function(){var e=a.getStateFromStores();b.areObjectsEqual(a.state,e)||a.setState(e),a.props.setEnforceFocus(!0)},a.submitTheme=function(){var e=a.state.applyToAllTeams?"":a.state.teamId;a.setState({isSaving:!0}),h.saveTheme(e,a.state.theme,function(){a.props.setRequireConfirm(!1),a.originalTheme=(0,n.default)({},a.state.theme),a.scrollToTop(),a.props.updateSection(""),a.setState({isSaving:!1})})},a.updateTheme=function(e){var t=a.state.theme.length===e.length;if(!t)for(var s in e)if(e.hasOwnProperty(s)&&a.state.theme[s]!==e[s]){t=!0;break}a.props.setRequireConfirm(t),a.setState({theme:e}),b.applyTheme(e)},a.resetFields=function(){var e=a.getStateFromStores();e.serverError=null,a.setState(e),a.scrollToTop(),b.applyTheme(e.theme),a.props.setRequireConfirm(!1)},a.handleImportModal=function(){_.default.handleViewAction({type:M.ActionTypes.TOGGLE_IMPORT_THEME_MODAL,value:!0,callback:a.updateTheme}),a.props.setEnforceFocus(!1)},a.handleUpdateSection=function(e){a.props.updateSection(e)},a.state=(0,i.default)({},a.getStateFromStores(),{isSaving:!1}),a.originalTheme=(0,n.default)({},a.state.theme),a}return(0,u.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){S.default.addChangeListener(this.onChange),this.props.selected&&(0,c.default)(p.default.findDOMNode(this.refs[this.state.theme])).addClass("active-border")}},{key:"componentDidUpdate",value:function(){this.props.selected&&((0,c.default)(".color-btn").removeClass("active-border"),(0,c.default)(p.default.findDOMNode(this.refs[this.state.theme])).addClass("active-border"))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.selected&&!e.selected&&this.resetFields()}},{key:"componentWillUnmount",value:function(){if(S.default.removeChangeListener(this.onChange),this.props.selected){var e=this.getStateFromStores();b.applyTheme(e.theme)}}},{key:"getStateFromStores",value:function(){var e=v.default.getTheme();e.codeTheme||(e.codeTheme=M.Constants.DEFAULT_CODE_THEME);var t=(0,s.default)(E.default.getAll()).length>1,a=v.default.getCategory(M.Preferences.CATEGORY_THEME).size<=1;return{teamId:E.default.getCurrentId(),theme:e,type:e.type||"premade",showAllTeamsCheckbox:t,applyToAllTeams:a}}},{key:"scrollToTop",value:function(){(0,c.default)(".ps-container.modal-body").scrollTop(0)}},{key:"updateType",value:function(e){this.setState({type:e})}},{key:"render",value:function(){var e=this,t=void 0;this.state.serverError&&(t=this.state.serverError);var a="custom"===this.state.type,s=void 0,i=void 0;a&&this.props.allowCustomThemes?s=m.default.createElement("div",{key:"customThemeChooser"},m.default.createElement(N.default,{theme:this.state.theme,updateTheme:this.updateTheme})):i=m.default.createElement("div",{key:"premadeThemeChooser"},m.default.createElement("br",null),m.default.createElement(A.default,{theme:this.state.theme,updateTheme:this.updateTheme}));var n=void 0;if(this.props.selected){var l=[];this.props.allowCustomThemes&&l.push(m.default.createElement("div",{className:"radio",key:"premadeThemeColorLabel"},m.default.createElement("label",null,m.default.createElement("input",{id:"standardThemes",type:"radio",name:"theme",checked:!a,onChange:this.updateType.bind(this,"premade")}),m.default.createElement(g.FormattedMessage,{id:"user.settings.display.theme.themeColors",defaultMessage:"Theme Colors"})),m.default.createElement("br",null))),l.push(i),this.props.allowCustomThemes&&(l.push(m.default.createElement("div",{className:"radio",key:"customThemeColorLabel"},m.default.createElement("label",null,m.default.createElement("input",{id:"customThemes",type:"radio",name:"theme",checked:a,onChange:this.updateType.bind(this,"custom")}),m.default.createElement(g.FormattedMessage,{id:"user.settings.display.theme.customTheme",defaultMessage:"Custom Theme"})))),l.push(s),l.push(m.default.createElement("div",{key:"otherThemes"},m.default.createElement("br",null),m.default.createElement("a",{id:"otherThemes",href:"http://docs.mattermost.com/help/settings/theme-colors.html#custom-theme-examples",target:"_blank",rel:"noopener noreferrer"},m.default.createElement(g.FormattedMessage,{id:"user.settings.display.theme.otherThemes",defaultMessage:"See other themes"})))),l.push(m.default.createElement("div",{key:"importSlackThemeButton",className:"padding-top"},m.default.createElement("a",{id:"slackImportTheme",className:"theme",onClick:this.handleImportModal},m.default.createElement(g.FormattedMessage,{id:"user.settings.display.theme.import",defaultMessage:"Import theme colors from Slack"})))));var r=null;this.state.showAllTeamsCheckbox&&(r=m.default.createElement("div",{className:"checkbox user-settings__submit-checkbox"},m.default.createElement("label",null,m.default.createElement("input",{id:"applyThemeToAllTeams",type:"checkbox",checked:this.state.applyToAllTeams,onChange:function(t){return e.setState({applyToAllTeams:t.target.checked})}}),m.default.createElement(g.FormattedMessage,{id:"user.settings.display.theme.applyToAllTeams",defaultMessage:"Apply new theme to all my teams"})))),n=m.default.createElement(y.default,{inputs:l,submitExtra:r,submit:this.submitTheme,saving:this.state.isSaving,server_error:t,width:"full",updateSection:this.handleUpdateSection})}else n=m.default.createElement(k.default,{title:m.default.createElement(g.FormattedMessage,{id:"user.settings.display.theme.title",defaultMessage:"Theme"}),describe:m.default.createElement(g.FormattedMessage,{id:"user.settings.display.theme.describe",defaultMessage:"Open to manage your theme"}),section:"theme",updateSection:this.handleUpdateSection});return n}}]),t}(m.default.Component);w.propTypes={selected:f.default.bool.isRequired,updateSection:f.default.func.isRequired,setRequireConfirm:f.default.func.isRequired,setEnforceFocus:f.default.func.isRequired,allowCustomThemes:f.default.bool},t.default=w},2297:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=_(a(99)),i=_(a(42)),n=_(a(295)),l=_(a(184)),r=_(a(282)),o=_(a(281)),d=_(a(285)),u=_(a(283)),c=_(a(284)),f=_(a(771)),m=_(a(1)),p=_(a(3)),g=a(769),h=a(766),v=a(765),E=a(288);a(2298);var S=_(a(22)),M=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(293)),b=_(a(2299));function _(e){return e&&e.__esModule?e:{default:e}}var y=(0,h.defineMessages)({sidebarBg:{id:(0,E.t)("user.settings.custom_theme.sidebarBg"),defaultMessage:"Sidebar BG"},sidebarText:{id:(0,E.t)("user.settings.custom_theme.sidebarText"),defaultMessage:"Sidebar Text"},sidebarHeaderBg:{id:(0,E.t)("user.settings.custom_theme.sidebarHeaderBg"),defaultMessage:"Sidebar Header BG"},sidebarHeaderTextColor:{id:(0,E.t)("user.settings.custom_theme.sidebarHeaderTextColor"),defaultMessage:"Sidebar Header Text"},sidebarUnreadText:{id:(0,E.t)("user.settings.custom_theme.sidebarUnreadText"),defaultMessage:"Sidebar Unread Text"},sidebarTextHoverBg:{id:(0,E.t)("user.settings.custom_theme.sidebarTextHoverBg"),defaultMessage:"Sidebar Text Hover BG"},sidebarTextActiveBorder:{id:(0,E.t)("user.settings.custom_theme.sidebarTextActiveBorder"),defaultMessage:"Sidebar Text Active Border"},sidebarTextActiveColor:{id:(0,E.t)("user.settings.custom_theme.sidebarTextActiveColor"),defaultMessage:"Sidebar Text Active Color"},onlineIndicator:{id:(0,E.t)("user.settings.custom_theme.onlineIndicator"),defaultMessage:"Online Indicator"},awayIndicator:{id:(0,E.t)("user.settings.custom_theme.awayIndicator"),defaultMessage:"Away Indicator"},dndIndicator:{id:(0,E.t)("user.settings.custom_theme.dndIndicator"),defaultMessage:"Do Not Disturb Indicator"},mentionBg:{id:(0,E.t)("user.settings.custom_theme.mentionBg"),defaultMessage:"Mention Jewel BG"},mentionColor:{id:(0,E.t)("user.settings.custom_theme.mentionColor"),defaultMessage:"Mention Jewel Text"},centerChannelBg:{id:(0,E.t)("user.settings.custom_theme.centerChannelBg"),defaultMessage:"Center Channel BG"},centerChannelColor:{id:(0,E.t)("user.settings.custom_theme.centerChannelColor"),defaultMessage:"Center Channel Text"},newMessageSeparator:{id:(0,E.t)("user.settings.custom_theme.newMessageSeparator"),defaultMessage:"New Message Separator"},linkColor:{id:(0,E.t)("user.settings.custom_theme.linkColor"),defaultMessage:"Link Color"},buttonBg:{id:(0,E.t)("user.settings.custom_theme.buttonBg"),defaultMessage:"Button BG"},buttonColor:{id:(0,E.t)("user.settings.custom_theme.buttonColor"),defaultMessage:"Button Text"},errorTextColor:{id:(0,E.t)("user.settings.custom_theme.errorTextColor"),defaultMessage:"Error Text Color"},mentionHighlightBg:{id:(0,E.t)("user.settings.custom_theme.mentionHighlightBg"),defaultMessage:"Mention Highlight BG"},mentionHighlightLink:{id:(0,E.t)("user.settings.custom_theme.mentionHighlightLink"),defaultMessage:"Mention Highlight Link"},codeTheme:{id:(0,E.t)("user.settings.custom_theme.codeTheme"),defaultMessage:"Code Theme"}}),k=function(e){function t(e){(0,o.default)(this,t);var a=(0,u.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));N.call(a);var s=a.setCopyTheme(a.props.theme);return a.state={copyTheme:s},a}return(0,c.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){(0,f.default)(".group--code").on("change",this.onCodeThemeChange)}},{key:"componentWillUnmount",value:function(){(0,f.default)(".group--code").off("change",this.onCodeThemeChange)}},{key:"setCopyTheme",value:function(e){var t=(0,l.default)({},e);return delete t.type,delete t.image,(0,n.default)(t)}},{key:"toggleSection",value:function(e){M.isIos()?(0,f.default)(e).toggleClass("open"):(0,f.default)(e).slideToggle()}},{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage,a=this.props.theme,s=[],i=[],n=[];S.default.THEME_ELEMENTS.forEach(function(l,r){if("codeTheme"===l.id){var o=[],d="";l.themes.forEach(function(e,t){e.id===a[l.id]&&(d=e.iconURL),o.push(p.default.createElement("option",{key:"code-theme-key"+t,value:e.id},e.uiName))});var u=p.default.createElement(g.Popover,{bsStyle:"info",id:"code-popover",className:"code-popover"},p.default.createElement("img",{width:"200",src:d}));i.push(p.default.createElement("div",{className:"col-sm-6 form-group",key:"custom-theme-key"+r},p.default.createElement("label",{className:"custom-label"},t(y[l.id])),p.default.createElement("div",{className:"input-group theme-group group--code dropdown",id:l.id},p.default.createElement("select",{className:"form-control",type:"text",defaultValue:a[l.id]},o),p.default.createElement(g.OverlayTrigger,{trigger:["hover","focus"],placement:"top",overlay:u,ref:"headerOverlay"},p.default.createElement("span",{className:"input-group-addon"},p.default.createElement("img",{src:d}))))))}else if("centerChannelElements"===l.group)i.push(p.default.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+r},p.default.createElement(b.default,{id:l.id,label:t(y[l.id]),color:a[l.id],onChange:e.handleColorChange})));else if("sidebarElements"===l.group){var c=a[l.id];c||"mentionBg"!==l.id||(c=a.mentionBj),s.push(p.default.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+r},p.default.createElement(b.default,{id:l.id,label:t(y[l.id]),color:c,onChange:e.handleColorChange})))}else n.push(p.default.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+r},p.default.createElement(b.default,{id:l.id,label:t(y[l.id]),color:a[l.id],onChange:e.handleColorChange})))});var l=p.default.createElement("div",{className:"col-sm-12"},p.default.createElement("label",{className:"custom-label"},p.default.createElement(h.FormattedMessage,{id:"user.settings.custom_theme.copyPaste",defaultMessage:"Copy and paste to share theme colors:"})),p.default.createElement("textarea",{ref:"textarea",className:"form-control",value:this.state.copyTheme,onPaste:this.pasteBoxChange,onChange:this.onChangeHandle,onClick:this.selectTheme}));return p.default.createElement("div",{className:"appearance-section padding-top"},p.default.createElement("div",{className:"theme-elements row"},p.default.createElement("div",{ref:"sidebarStylesHeader",className:"theme-elements__header",onClick:this.toggleSidebarStyles},p.default.createElement(h.FormattedMessage,{id:"user.settings.custom_theme.sidebarTitle",defaultMessage:"Sidebar Styles"}),p.default.createElement("div",{className:"header__icon"},p.default.createElement("i",{className:"fa fa-plus",title:(0,v.localizeMessage)("generic_icons.expand","Expand Icon")}),p.default.createElement("i",{className:"fa fa-minus",title:(0,v.localizeMessage)("generic_icons.collapse","Collapse Icon")}))),p.default.createElement("div",{ref:"sidebarStyles",className:"theme-elements__body"},s)),p.default.createElement("div",{className:"theme-elements row"},p.default.createElement("div",{ref:"centerChannelStylesHeader",className:"theme-elements__header",onClick:this.toggleCenterChannelStyles},p.default.createElement(h.FormattedMessage,{id:"user.settings.custom_theme.centerChannelTitle",defaultMessage:"Center Channel Styles"}),p.default.createElement("div",{className:"header__icon"},p.default.createElement("i",{className:"fa fa-plus",title:(0,v.localizeMessage)("generic_icons.expand","Expand Icon")}),p.default.createElement("i",{className:"fa fa-minus",title:(0,v.localizeMessage)("generic_icons.collapse","Collapse Icon")}))),p.default.createElement("div",{ref:"centerChannelStyles",className:"theme-elements__body"},i)),p.default.createElement("div",{className:"theme-elements row form-group"},p.default.createElement("div",{ref:"linkAndButtonStylesHeader",className:"theme-elements__header",onClick:this.toggleLinkAndButtonStyles},p.default.createElement(h.FormattedMessage,{id:"user.settings.custom_theme.linkButtonTitle",defaultMessage:"Link and Button Styles"}),p.default.createElement("div",{className:"header__icon"},p.default.createElement("i",{className:"fa fa-plus",title:(0,v.localizeMessage)("generic_icons.expand","Expand Icon")}),p.default.createElement("i",{className:"fa fa-minus",title:(0,v.localizeMessage)("generic_icons.collapse","Collapse Icon")}))),p.default.createElement("div",{ref:"linkAndButtonStyles",className:"theme-elements__body"},n)),p.default.createElement("div",{className:"row"},l))}}]),t}(p.default.Component),N=function(){var e=this;this.handleColorChange=function(t,a){var n=e.props,l=n.updateTheme,r=n.theme;if(r[t]!==a){var o=(0,i.default)({},r,(0,s.default)({type:"custom"},t,a));"mentionBg"===t&&(o.mentionBj=a),l(o);var d=e.setCopyTheme(o);e.setState({copyTheme:d})}},this.pasteBoxChange=function(t){var a="";if(0!==(a=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):t.clipboardData.getData("Text")).length){var s=void 0;try{s=JSON.parse(a)}catch(e){return}e.setState({copyTheme:(0,n.default)(s)}),s.type="custom",e.props.updateTheme(s)}},this.onChangeHandle=function(e){e.stopPropagation()},this.selectTheme=function(){var t=e.refs.textarea;t.focus(),t.setSelectionRange(0,e.state.copyTheme.length)},this.toggleSidebarStyles=function(t){t.preventDefault(),(0,f.default)(e.refs.sidebarStylesHeader).toggleClass("open"),e.toggleSection(e.refs.sidebarStyles)},this.toggleCenterChannelStyles=function(t){t.preventDefault(),(0,f.default)(e.refs.centerChannelStylesHeader).toggleClass("open"),e.toggleSection(e.refs.centerChannelStyles)},this.toggleLinkAndButtonStyles=function(t){t.preventDefault(),(0,f.default)(e.refs.linkAndButtonStylesHeader).toggleClass("open"),e.toggleSection(e.refs.linkAndButtonStyles)},this.onCodeThemeChange=function(t){var a=e.props.theme;a.codeTheme=t.target.value,e.props.updateTheme(a)}};k.propTypes={intl:h.intlShape.isRequired,theme:m.default.object.isRequired,updateTheme:m.default.func.isRequired},t.default=(0,h.injectIntl)(k)},2299:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=c(a(282)),i=c(a(281)),n=c(a(285)),l=c(a(283)),r=c(a(284)),o=c(a(3)),d=c(a(1)),u=c(a(2300));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){var e,a,n,r;(0,i.default)(this,t);for(var o=arguments.length,d=Array(o),u=0;u<o;u++)d[u]=arguments[u];return a=n=(0,l.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(d))),n.handleChange=function(e){var t=n.props,a=t.id,s=t.onChange;s&&s(a,e)},r=a,(0,l.default)(n,r)}return(0,r.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this.props,t=e.label,a=e.color;return o.default.createElement("div",null,o.default.createElement("label",{className:"custom-label"},t),o.default.createElement(u.default,{color:a,onChange:this.handleChange}))}}]),t}(o.default.Component);f.propTypes={id:d.default.string.isRequired,label:d.default.string.isRequired,color:d.default.string.isRequired,onChange:d.default.func},t.default=f},2300:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=f(a(282)),i=f(a(281)),n=f(a(285)),l=f(a(283)),r=f(a(284)),o=f(a(3)),d=f(a(290)),u=f(a(1)),c=a(1409);function f(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.checkClick=function(e){var t=d.default.findDOMNode(a.colorPicker);t&&t.contains(e.target)||a.setState({isOpened:!1})},a.togglePicker=function(){a.setState({isOpened:!a.state.isOpened})},a.handleChange=function(e){var t=e.hex,s=a.props.onChange;s&&s(t)},a.getColorPicker=function(e){a.colorPicker=e},a.state={idOpened:!1},a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"componentDidUpdate",value:function(e,t){var a=t.isOpened,s=this.state.isOpened;s!==a&&(s?document.addEventListener("click",this.checkClick):document.removeEventListener("click",this.checkClick))}},{key:"render",value:function(){var e=this.props.color,t=this.state.isOpened;return o.default.createElement("div",{className:"color-input input-group"},o.default.createElement("input",{className:"form-control",type:"text",value:e,readOnly:!0}),o.default.createElement("span",{className:"input-group-addon",onClick:this.togglePicker},o.default.createElement("i",{className:"color-icon",style:{backgroundColor:e}})),t&&o.default.createElement("div",{ref:this.getColorPicker,className:"color-popover"},o.default.createElement(c.ChromePicker,{color:e,onChange:this.handleChange})))}}]),t}(o.default.Component);m.propTypes={color:u.default.string.isRequired,onChange:u.default.func},t.default=m},2450:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(96),n=function(e){return e&&e.__esModule?e:{default:e}}(a(2451));t.default=(0,s.connect)(function(e){var t=(0,i.getConfig)(e);return{allowedThemes:t.AllowedThemes&&t.AllowedThemes.split(",")||[]}})(n.default)},2451:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=m(a(282)),i=m(a(281)),n=m(a(285)),l=m(a(283)),r=m(a(284)),o=m(a(771)),d=m(a(1)),u=m(a(3)),c=m(a(22)),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(765));function m(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(){return(0,i.default)(this,t),(0,l.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,r.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this,t=this.props.theme,a=[],s=this.props.allowedThemes,i=s.length>1||s[0]&&s[0].trim().length>0;for(var n in c.default.THEMES){if(c.default.THEMES.hasOwnProperty(n))if("continue"===function(){if(i&&s.indexOf(n)<0)return"continue";var l=o.default.extend(!0,{},c.default.THEMES[n]),r="";l.type===t.type&&(r="active"),a.push(u.default.createElement("div",{className:"col-xs-6 col-sm-3 premade-themes",key:"premade-theme-key"+n},u.default.createElement("div",{className:r,onClick:function(){return e.props.updateTheme(l)}},u.default.createElement("label",null,u.default.createElement("img",{className:"img-responsive",src:l.image}),u.default.createElement("div",{className:"theme-label"},f.toTitleCase(l.type))))))}())continue}return u.default.createElement("div",{className:"row appearance-section"},u.default.createElement("div",{className:"clearfix"},a))}}]),t}(u.default.Component);t.default=p,p.propTypes={theme:d.default.object.isRequired,updateTheme:d.default.func.isRequired,allowedThemes:d.default.arrayOf(d.default.string)},p.defaultProps={allowedThemes:[]}},2452:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(2),n=a(779),l=a(96),r=function(e){return e&&e.__esModule?e:{default:e}}(a(2453));t.default=(0,s.connect)(function(e){var t=(0,l.getConfig)(e);return{sendEmailNotifications:"true"===t.SendEmailNotifications,requireEmailVerification:"true"===t.RequireEmailVerification,maxFileSize:parseInt(t.MaxFileSize,10),ldapFirstNameAttributeSet:"true"===t.LdapFirstNameAttributeSet,ldapLastNameAttributeSet:"true"===t.LdapLastNameAttributeSet,samlFirstNameAttributeSet:"true"===t.SamlFirstNameAttributeSet,samlLastNameAttributeSet:"true"===t.SamlLastNameAttributeSet,ldapNicknameAttributeSet:"true"===t.LdapNicknameAttributeSet,samlNicknameAttributeSet:"true"===t.SamlNicknameAttributeSet,positionAttributeSet:"true"===t.PositionAttributeSet}},function(e){return{actions:(0,i.bindActionCreators)({getMe:n.getMe,sendVerificationEmail:n.sendVerificationEmail},e)}})(r.default)},2453:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=y(a(184)),i=y(a(282)),n=y(a(281)),l=y(a(285)),r=y(a(283)),o=y(a(284)),d=y(a(1)),u=y(a(3)),c=a(766),f=a(98),m=a(791),p=a(781),g=y(a(834)),h=y(a(774)),v=y(a(22)),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(765)),S=a(288),M=y(a(809)),b=y(a(817)),_=y(a(1364));function y(e){return e&&e.__esModule?e:{default:e}}var k=(0,c.defineMessages)({usernameReserved:{id:(0,S.t)("user.settings.general.usernameReserved"),defaultMessage:"This username is reserved, please choose a new one."},usernameRestrictions:{id:(0,S.t)("user.settings.general.usernameRestrictions"),defaultMessage:"Username must begin with a letter, and contain between {min} to {max} lowercase characters made up of numbers, letters, and the symbols '.', '-', and '_'."},validEmail:{id:(0,S.t)("user.settings.general.validEmail"),defaultMessage:"Please enter a valid email address."},emailMatch:{id:(0,S.t)("user.settings.general.emailMatch"),defaultMessage:"The new emails you entered do not match."},validImage:{id:(0,S.t)("user.settings.general.validImage"),defaultMessage:"Only BMP, JPG or PNG images may be used for profile pictures"},imageTooLarge:{id:(0,S.t)("user.settings.general.imageTooLarge"),defaultMessage:"Unable to upload profile image. File is too large."},uploadImage:{id:(0,S.t)("user.settings.general.uploadImage"),defaultMessage:"Click 'Edit' to upload an image."},uploadImageMobile:{id:(0,S.t)("user.settings.general.mobile.uploadImage"),defaultMessage:"Click to upload an image."},fullName:{id:(0,S.t)("user.settings.general.fullName"),defaultMessage:"Full Name"},nickname:{id:(0,S.t)("user.settings.general.nickname"),defaultMessage:"Nickname"},username:{id:(0,S.t)("user.settings.general.username"),defaultMessage:"Username"},profilePicture:{id:(0,S.t)("user.settings.general.profilePicture"),defaultMessage:"Profile Picture"},close:{id:(0,S.t)("user.settings.general.close"),defaultMessage:"Close"},position:{id:(0,S.t)("user.settings.general.position"),defaultMessage:"Position"}}),N="dummySectionName",A="name",C="username",T="nickname",w="position",F="email",I=["image/jpeg","image/png","image/bmp"],O=function(e){function t(e){(0,n.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.handleEmailVerificationError=function(){g.default.storeLastError({notification:!0,message:v.default.AnnouncementBarMessages.EMAIL_VERIFICATION_REQUIRED}),g.default.emitChange()},a.handleEmailResend=function(e){a.setState({resendStatus:"sending",showSpinner:!0},function(){a.handleEmailVerificationError()}),a.props.actions.sendVerificationEmail(e).then(function(e){var t=e.data,s=e.error;t?a.setState({resendStatus:"success"}):s&&a.setState({resendStatus:"failure"})})},a.createEmailResendLink=function(e){return a.state.showSpinner?u.default.createElement(u.default.Fragment,null,u.default.createElement("span",{className:"fa-wrapper"},u.default.createElement("span",{className:"fa fa-spinner icon--rotate",title:E.localizeMessage("generic_icons.loading","Loading Icon")})),u.default.createElement(c.FormattedMessage,{id:"user.settings.general.sending",defaultMessage:"Sending"})):u.default.createElement("span",{className:"resend-verification-wrapper"},u.default.createElement("a",{onClick:function(){a.handleEmailResend(e),setTimeout(function(){a.setState({showSpinner:!1},function(){a.handleEmailVerificationError()})},500)}},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.sendAgain",defaultMessage:"Send again"})))},a.submitUsername=function(){var e=(0,s.default)({},a.props.user),t=a.state.username.trim().toLowerCase(),i=a.props.intl.formatMessage,n=E.isValidUsername(t);"Cannot use a reserved word as a username."!==n?n?a.setState({clientError:i(k.usernameRestrictions,{min:v.default.MIN_USERNAME_LENGTH,max:v.default.MAX_USERNAME_LENGTH}),serverError:""}):e.username!==t?(e.username=t,(0,m.trackEvent)("settings","user_settings_update",{field:"username"}),a.submitUser(e,!1)):a.updateSection(""):a.setState({clientError:i(k.usernameReserved),serverError:""})},a.submitNickname=function(){var e=(0,s.default)({},a.props.user),t=a.state.nickname.trim();e.nickname!==t?(e.nickname=t,(0,m.trackEvent)("settings","user_settings_update",{field:"nickname"}),a.submitUser(e,!1)):a.updateSection("")},a.submitName=function(){var e=(0,s.default)({},a.props.user),t=a.state.firstName.trim(),i=a.state.lastName.trim();e.first_name!==t||e.last_name!==i?(e.first_name=t,e.last_name=i,(0,m.trackEvent)("settings","user_settings_update",{field:"fullname"}),a.submitUser(e,!1)):a.updateSection("")},a.submitEmail=function(){var e=(0,s.default)({},a.props.user),t=a.state.email.trim().toLowerCase(),i=a.state.confirmEmail.trim().toLowerCase(),n=a.props.intl.formatMessage;t!==e.email||""!==i&&i!==e.email?""!==t&&(0,f.isEmail)(t)?t===i?(e.email=t,(0,m.trackEvent)("settings","user_settings_update",{field:"email"}),a.submitUser(e,!0)):a.setState({emailError:n(k.emailMatch),clientError:"",serverError:""}):a.setState({emailError:n(k.validEmail),clientError:"",serverError:""}):a.updateSection("")},a.submitUser=function(e,t){a.setState({sectionIsSaving:!0}),(0,p.updateUser)(e,function(){a.updateSection(""),a.props.actions.getMe(),a.props.sendEmailNotifications&&a.props.requireEmailVerification&&t&&(a.handleEmailVerificationError(),a.setState({emailChangeInProgress:!0}))},function(e){var t=void 0;t=e.message?e.message:e,a.setState({serverError:t,emailError:"",clientError:"",sectionIsSaving:!1})})},a.submitPicture=function(e){if(e.preventDefault(),a.state.pictureFile&&a.submitActive){(0,m.trackEvent)("settings","user_settings_update",{field:"picture"});var t=a.props.intl.formatMessage,s=a.state.pictureFile;I.includes(s.type)?s.size>a.props.maxFileSize?a.setState({clientError:t(k.imageTooLarge),serverError:""}):(a.setState({loadingPicture:!0}),(0,p.uploadProfileImage)(s,function(){a.updateSection(""),a.submitActive=!1},function(e){var t=a.setupInitialState(a.props);t.serverError=e.message,a.setState(t)})):a.setState({clientError:t(k.validImage),serverError:""})}},a.submitPosition=function(){var e=(0,s.default)({},a.props.user),t=a.state.position.trim();e.position!==t?(e.position=t,(0,m.trackEvent)("settings","user_settings_update",{field:"position"}),a.submitUser(e,!1)):a.updateSection("")},a.updateUsername=function(e){a.setState({username:e.target.value})},a.updateFirstName=function(e){a.setState({firstName:e.target.value})},a.updateLastName=function(e){a.setState({lastName:e.target.value})},a.updateNickname=function(e){a.setState({nickname:e.target.value})},a.updatePosition=function(e){a.setState({position:e.target.value})},a.updateEmail=function(e){a.setState({email:e.target.value})},a.updateConfirmEmail=function(e){a.setState({confirmEmail:e.target.value})},a.updatePicture=function(e){e.target.files&&e.target.files[0]?(a.setState({pictureFile:e.target.files[0]}),a.submitActive=!0,a.setState({clientError:null})):a.setState({pictureFile:null})},a.updateSection=function(e){var t=a.state.emailChangeInProgress;a.setState((0,s.default)({},a.setupInitialState(a.props),{emailChangeInProgress:t,clientError:"",serverError:"",emailError:"",sectionIsSaving:!1})),a.submitActive=!1,a.props.updateSection(e)},a.submitActive=!1,a.state=a.setupInitialState(e),a}return(0,o.default)(t,e),(0,l.default)(t,[{key:"setupInitialState",value:function(e){var t=e.user;return{username:t.username,firstName:t.first_name,lastName:t.last_name,nickname:t.nickname,position:t.position,originalEmail:t.email,email:"",confirmEmail:"",pictureFile:null,loadingPicture:!1,emailChangeInProgress:e.sendEmailNotifications&&e.requireEmailVerification&&!t.email_verified,sectionIsSaving:!1}}},{key:"createEmailSection",value:function(){var e=void 0;if("email"===this.props.activeSection){var t=this.props.sendEmailNotifications,a=this.props.requireEmailVerification,s=[],i=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emailHelp1",defaultMessage:"Email is used for sign-in, notifications, and password reset. Email requires verification if changed."});if(t)if(a){if(this.state.emailChangeInProgress){var n=h.default.getCurrentUser().email;n&&(i=u.default.createElement(u.default.Fragment,null,u.default.createElement(c.FormattedHTMLMessage,{id:"user.settings.general.emailHelp4",defaultMessage:"A verification email was sent to {email}. <br />Cannot find the email?",values:{email:n}}),this.createEmailResendLink(n)))}}else i=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emailHelp3",defaultMessage:"Email is used for sign-in, notifications, and password reset."});else i=u.default.createElement("div",{className:"setting-list__hint col-sm-12 text-danger"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emailHelp2",defaultMessage:"Email has been disabled by your System Administrator. No notification emails will be sent until it is enabled."}));var l=null;""===this.props.user.auth_service?(s.push(u.default.createElement("div",{key:"currentEmailSetting"},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.currentEmail",defaultMessage:"Current Email"})),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("label",{className:"control-label word-break--all text-left"},this.state.originalEmail))))),s.push(u.default.createElement("div",{key:"emailSetting"},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.newEmail",defaultMessage:"New Email"})),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{autoFocus:!0,id:"primaryEmail",className:"form-control",type:"email",onChange:this.updateEmail,value:this.state.email}))))),s.push(u.default.createElement("div",{key:"confirmEmailSetting"},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.confirmEmail",defaultMessage:"Confirm Email"})),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"confirmEmail",className:"form-control",type:"email",onChange:this.updateConfirmEmail,value:this.state.confirmEmail}))),i)),l=this.submitEmail):this.props.user.auth_service===v.default.GITLAB_SERVICE?s.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"form-group"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emailGitlabCantUpdate",defaultMessage:"Login occurs through GitLab. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===v.default.GOOGLE_SERVICE?s.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"form-group"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emailGoogleCantUpdate",defaultMessage:"Login occurs through Google Apps. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===v.default.OFFICE365_SERVICE?s.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"form-group"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emailOffice365CantUpdate",defaultMessage:"Login occurs through Office 365. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===v.default.LDAP_SERVICE?s.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"padding-bottom"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emailLdapCantUpdate",defaultMessage:"Login occurs through AD/LDAP. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})))):this.props.user.auth_service===v.default.SAML_SERVICE&&s.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"padding-bottom"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emailSamlCantUpdate",defaultMessage:"Login occurs through SAML. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)),e=u.default.createElement(M.default,{title:u.default.createElement(c.FormattedMessage,{id:"user.settings.general.email",defaultMessage:"Email"}),inputs:s,submit:l,saving:this.state.sectionIsSaving,serverError:this.state.serverError,clientError:this.state.emailError,updateSection:this.updateSection})}else{var r="";if(""===this.props.user.auth_service)if(this.state.emailChangeInProgress){var o=h.default.getCurrentUser().email;r=o?u.default.createElement(u.default.Fragment,null,u.default.createElement(c.FormattedHTMLMessage,{id:"user.settings.general.newAddress",defaultMessage:"Check your email to verify {email}",values:{email:o}})):u.default.createElement(c.FormattedMessage,{id:"user.settings.general.checkEmailNoAddress",defaultMessage:"Check your email to verify your new address"})}else r=h.default.getCurrentUser().email;else this.props.user.auth_service===v.default.GITLAB_SERVICE?r=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.loginGitlab",defaultMessage:"Login done through GitLab ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===v.default.GOOGLE_SERVICE?r=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.loginGoogle",defaultMessage:"Login done through Google Apps ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===v.default.OFFICE365_SERVICE?r=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.loginOffice365",defaultMessage:"Login done through Office 365 ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===v.default.LDAP_SERVICE?r=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.loginLdap",defaultMessage:"Login done through AD/LDAP ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===v.default.SAML_SERVICE&&(r=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.loginSaml",defaultMessage:"Login done through SAML ({email})",values:{email:this.state.originalEmail}}));e=u.default.createElement(b.default,{title:u.default.createElement(c.FormattedMessage,{id:"user.settings.general.email",defaultMessage:"Email"}),describe:r,focused:this.props.prevActiveSection===w,section:"email",updateSection:this.updateSection})}return e}},{key:"render",value:function(){var e=this,t=this.props.user,a=this.props.intl.formatMessage,s=null;this.state.clientError&&(s=this.state.clientError);var i=null;this.state.serverError&&(i=this.state.serverError);var n=void 0,l=[];if("name"===this.props.activeSection){var r=void 0,o=null;if("ldap"===this.props.user.auth_service&&(this.props.ldapFirstNameAttributeSet||this.props.ldapLastNameAttributeSet)||this.props.user.auth_service===v.default.SAML_SERVICE&&(this.props.samlFirstNameAttributeSet||this.props.samlLastNameAttributeSet))r=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so through your login provider."}));else{l.push(u.default.createElement("div",{key:"firstNameSetting",className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.firstName",defaultMessage:"First Name"})),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"firstName",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateFirstName,value:this.state.firstName,onFocus:E.moveCursorToEnd})))),l.push(u.default.createElement("div",{key:"lastNameSetting",className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.lastName",defaultMessage:"Last Name"})),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"lastName",className:"form-control",type:"text",onChange:this.updateLastName,value:this.state.lastName}))));var d=u.default.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),this.updateSection(""),this.props.updateTab("notifications")}.bind(this)},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.notificationsLink",defaultMessage:"Notifications"}));r=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.general.notificationsExtra",defaultMessage:"By default, you will receive mention notifications when someone types your first name. Go to {notify} settings to change this default.",values:{notify:d}})),o=this.submitName}n=u.default.createElement(M.default,{title:a(k.fullName),inputs:l,submit:o,saving:this.state.sectionIsSaving,serverError:i,clientError:s,updateSection:this.updateSection,extraInfo:r})}else{var f="";t.first_name&&t.last_name?f=t.first_name+" "+t.last_name:t.first_name?f=t.first_name:t.last_name?f=t.last_name:(f=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emptyName",defaultMessage:"Click 'Edit' to add your full name"}),E.isMobile()&&(f=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.mobile.emptyName",defaultMessage:"Click to add your full name"}))),n=u.default.createElement(b.default,{title:a(k.fullName),describe:f,focused:this.props.prevActiveSection===N,section:"name",updateSection:this.updateSection})}var m=void 0;if("nickname"===this.props.activeSection){var p=void 0,g=null;if("ldap"===this.props.user.auth_service&&this.props.ldapNicknameAttributeSet||this.props.user.auth_service===v.default.SAML_SERVICE&&this.props.samlNicknameAttributeSet)p=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));else{var S=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.nickname",defaultMessage:"Nickname"});E.isMobile()&&(S=""),l.push(u.default.createElement("div",{key:"nicknameSetting",className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},S),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"nickname",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateNickname,value:this.state.nickname,maxLength:v.default.MAX_NICKNAME_LENGTH,autoCapitalize:"off"})))),p=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.general.nicknameExtra",defaultMessage:"Use Nickname for a name you might be called that is different from your first name and username. This is most often used when two or more people have similar sounding names and usernames."})),g=this.submitNickname}m=u.default.createElement(M.default,{title:a(k.nickname),inputs:l,submit:g,saving:this.state.sectionIsSaving,serverError:i,clientError:s,updateSection:this.updateSection,extraInfo:p})}else{var y="";t.nickname?y=t.nickname:(y=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emptyNickname",defaultMessage:"Click 'Edit' to add a nickname"}),E.isMobile()&&(y=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.mobile.emptyNickname",defaultMessage:"Click to add a nickname"}))),m=u.default.createElement(b.default,{title:a(k.nickname),describe:y,focused:this.props.prevActiveSection===C,section:"nickname",updateSection:this.updateSection})}var w=void 0;if("username"===this.props.activeSection){var I=void 0,O=null;if(""===this.props.user.auth_service){var L=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.username",defaultMessage:"Username"});E.isMobile()&&(L=""),l.push(u.default.createElement("div",{key:"usernameSetting",className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},L),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"username",autoFocus:!0,maxLength:v.default.MAX_USERNAME_LENGTH,className:"form-control",type:"text",onChange:this.updateUsername,value:this.state.username,autoCapitalize:"off",onFocus:E.moveCursorToEnd})))),I=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.general.usernameInfo",defaultMessage:"Pick something easy for teammates to recognize and recall."})),O=this.submitUsername}else I=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));w=u.default.createElement(M.default,{title:a(k.username),inputs:l,submit:O,saving:this.state.sectionIsSaving,serverError:i,clientError:s,updateSection:this.updateSection,extraInfo:I})}else w=u.default.createElement(b.default,{title:a(k.username),describe:h.default.getCurrentUser().username,focused:this.props.prevActiveSection===A,section:"username",updateSection:this.updateSection});var R=void 0;if("position"===this.props.activeSection){var P=void 0,D=null;if("ldap"!==this.props.user.auth_service&&this.props.user.auth_service!==v.default.SAML_SERVICE||!this.props.positionAttributeSet){var U=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.position",defaultMessage:"Position"});E.isMobile()&&(U=""),l.push(u.default.createElement("div",{key:"positionSetting",className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},U),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"position",autoFocus:!0,className:"form-control",type:"text",onChange:this.updatePosition,value:this.state.position,maxLength:v.default.MAX_POSITION_LENGTH,autoCapitalize:"off",onFocus:E.moveCursorToEnd})))),P=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.general.positionExtra",defaultMessage:"Use Position for your role or job title. This will be shown in your profile popover."})),D=this.submitPosition}else P=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));R=u.default.createElement(M.default,{title:a(k.position),inputs:l,submit:D,saving:this.state.sectionIsSaving,serverError:i,clientError:s,updateSection:this.updateSection,extraInfo:P})}else{var x="";t.position?x=t.position:(x=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.emptyPosition",defaultMessage:"Click 'Edit' to add your job title / position"}),E.isMobile()&&(x=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.mobile.emptyPosition",defaultMessage:"Click to add your job title / position"}))),R=u.default.createElement(b.default,{title:a(k.position),describe:x,focused:this.props.prevActiveSection===T,section:"position",updateSection:this.updateSection})}var z=this.createEmailSection(),q=void 0;if("picture"===this.props.activeSection)q=u.default.createElement(_.default,{title:a(k.profilePicture),onSubmit:this.submitPicture,src:E.imageURLForUser(t),serverError:i,clientError:s,updateSection:function(t){e.updateSection(""),t.preventDefault()},file:this.state.pictureFile,onFileChange:this.updatePicture,submitActive:this.submitActive,loadingPicture:this.state.loadingPicture,maxFileSize:this.props.maxFileSize});else{var G=a(k.uploadImage);E.isMobile()&&(G=a(k.uploadImageMobile)),t.last_picture_update&&(G=u.default.createElement(c.FormattedMessage,{id:"user.settings.general.imageUpdated",defaultMessage:"Image last updated {date}",values:{date:u.default.createElement(c.FormattedDate,{value:new Date(t.last_picture_update),day:"2-digit",month:"short",year:"numeric"})}})),q=u.default.createElement(b.default,{title:a(k.profilePicture),describe:G,focused:this.props.prevActiveSection===F,section:"picture",updateSection:this.updateSection})}return u.default.createElement("div",{id:"generalSettings"},u.default.createElement("div",{className:"modal-header"},u.default.createElement("button",{id:"closeUserSettings",type:"button",className:"close","data-dismiss":"modal","aria-label":a(k.close),onClick:this.props.closeModal},u.default.createElement("span",{"aria-hidden":"true"},"×")),u.default.createElement("h4",{className:"modal-title",ref:"title"},u.default.createElement("div",{className:"modal-back"},u.default.createElement("i",{className:"fa fa-angle-left",title:E.localizeMessage("generic_icons.collapse","Collapse Icon"),onClick:this.props.collapseModal})),u.default.createElement(c.FormattedMessage,{id:"user.settings.general.title",defaultMessage:"General Settings"}))),u.default.createElement("div",{className:"user-settings"},u.default.createElement("h3",{id:"generalSettingsTitle",className:"tab-header"},u.default.createElement(c.FormattedMessage,{id:"user.settings.general.title",defaultMessage:"General Settings"})),u.default.createElement("div",{className:"divider-dark first"}),n,u.default.createElement("div",{className:"divider-light"}),w,u.default.createElement("div",{className:"divider-light"}),m,u.default.createElement("div",{className:"divider-light"}),R,u.default.createElement("div",{className:"divider-light"}),z,u.default.createElement("div",{className:"divider-light"}),q,u.default.createElement("div",{className:"divider-dark"})))}}]),t}(u.default.Component);O.propTypes={intl:c.intlShape.isRequired,user:d.default.object.isRequired,updateSection:d.default.func.isRequired,updateTab:d.default.func.isRequired,activeSection:d.default.string.isRequired,prevActiveSection:d.default.string.isRequired,closeModal:d.default.func.isRequired,collapseModal:d.default.func.isRequired,actions:d.default.shape({getMe:d.default.func.isRequired,sendVerificationEmail:d.default.func.isRequred}).isRequired,sendEmailNotifications:d.default.bool,requireEmailVerification:d.default.bool,maxFileSize:d.default.number,ldapFirstNameAttributeSet:d.default.bool,ldapLastNameAttributeSet:d.default.bool,samlFirstNameAttributeSet:d.default.bool,samlLastNameAttributeSet:d.default.bool,ldapNicknameAttributeSet:d.default.bool,samlNicknameAttributeSet:d.default.bool,positionAttributeSet:d.default.bool},t.default=(0,c.injectIntl)(O)},2454:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(96),n=function(e){return e&&e.__esModule?e:{default:e}}(a(2455));t.default=(0,s.connect)(function(e){var t=(0,i.getConfig)(e);return{sendEmailNotifications:"true"===t.SendEmailNotifications,enableEmailBatching:"true"===t.EnableEmailBatching,siteName:t.SiteName,sendPushNotifications:"true"===t.SendPushNotifications,enableAutoResponder:"true"===t.ExperimentalEnableAutomaticReplies}})(n.default)},2455:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=b(a(282)),i=b(a(281)),n=b(a(285)),l=b(a(283)),r=b(a(284)),o=b(a(1)),d=b(a(3)),u=a(766),c=a(781),f=b(a(774)),m=a(22),p=b(m),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(765)),h=b(a(809)),v=b(a(817)),E=b(a(2456)),S=b(a(2457)),M=b(a(2458));function b(e){return e&&e.__esModule?e:{default:e}}function _(){var e=f.default.getCurrentUser(),t=m.NotificationLevels.MENTION,a="true",s="never",i="true",n=m.NotificationLevels.MENTION,l=p.default.UserStatuses.AWAY,r=!1,o=g.localizeMessage("user.settings.notifications.autoResponderDefault","Hello, I am out of office and unable to respond to messages.");e.notify_props&&(e.notify_props.desktop&&(t=e.notify_props.desktop),e.notify_props.desktop_sound&&(a=e.notify_props.desktop_sound),e.notify_props.comments&&(s=e.notify_props.comments),e.notify_props.email&&(i=e.notify_props.email),e.notify_props.push&&(n=e.notify_props.push),e.notify_props.push_status&&(l=e.notify_props.push_status),e.notify_props.auto_responder_active&&(r="true"===e.notify_props.auto_responder_active),e.notify_props.auto_responder_message&&(o=e.notify_props.auto_responder_message));var d=!1,u="",c=!1,h=!1;if(e.notify_props){if(e.notify_props.mention_keys){var v=e.notify_props.mention_keys.split(",");-1===v.indexOf(e.username)?d=!1:(d=!0,v.splice(v.indexOf(e.username),1),-1!==v.indexOf("@"+e.username)&&v.splice(v.indexOf("@"+e.username),1)),u=v.join(",")}e.notify_props.first_name&&(c="true"===e.notify_props.first_name),e.notify_props.channel&&(h="true"===e.notify_props.channel)}return{desktopActivity:t,enableEmail:i,pushActivity:n,pushStatus:l,desktopSound:a,usernameKey:d,customKeys:u,customKeysChecked:u.length>0,firstNameKey:c,channelKey:h,autoResponderActive:r,autoResponderMessage:o,notifyCommentsLevel:s,isSaving:!1}}var y={desktop:"dummySectionName",email:"desktop",push:"email",keys:"push",comments:"keys"},k=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.handleSubmit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state.enableEmail,t={};t.email=e,t.desktop_sound=a.state.desktopSound,t.desktop=a.state.desktopActivity,t.push=a.state.pushActivity,t.push_status=a.state.pushStatus,t.comments=a.state.notifyCommentsLevel,t.auto_responder_active=a.state.autoResponderActive.toString(),t.auto_responder_message=a.state.autoResponderMessage,t.auto_responder_message&&""!==t.auto_responder_message||(t.auto_responder_message=g.localizeMessage("user.settings.notifications.autoResponderDefault","Hello, I am out of office and unable to respond to messages."));var s=[];a.state.usernameKey&&s.push(a.props.user.username);var i=s.join(",");a.state.customKeys.length>0&&a.state.customKeysChecked&&(i+=","+a.state.customKeys),t.mention_keys=i,t.first_name=a.state.firstNameKey.toString(),t.channel=a.state.channelKey.toString(),a.setState({isSaving:!0}),(0,c.updateUserNotifyProps)(t,function(){a.props.updateSection("")},function(e){a.setState({serverError:e.message,isSaving:!1})})},a.handleCancel=function(e){e&&e.preventDefault(),a.updateState()},a.handleUpdateSection=function(e){e?a.props.updateSection(e):(a.props.updateSection(""),a.handleCancel())},a.setStateValue=function(e,t){var s={};s[e]=t,a.setState(s)},a.updateSection=function(e){a.updateState(),a.props.updateSection(e)},a.updateState=function(){var e=_();g.areObjectsEqual(e,a.state)||a.setState(e),a.setState({isSaving:!1})},a.onListenerChange=function(){a.updateState()},a.handleEmailRadio=function(e){a.setState({enableEmail:e}),a.refs.wrapper.focus()},a.updateUsernameKey=function(e){a.setState({usernameKey:e})},a.updateFirstNameKey=function(e){a.setState({firstNameKey:e})},a.updateChannelKey=function(e){a.setState({channelKey:e})},a.updateCustomMentionKeys=function(){if(a.refs.customcheck.checked){var e=a.refs.custommentions.value;a.setState({customKeys:e.replace(/ /g,""),customKeysChecked:!0})}else a.setState({customKeys:"",customKeysChecked:!1})},a.onCustomChange=function(){a.refs.customcheck.checked=!0,a.updateCustomMentionKeys()},a.createPushNotificationSection=function(){if("push"===a.props.activeSection){var e=[],t=null,s=null;if(a.props.sendPushNotifications){var i=[!1,!1,!1];a.state.pushActivity===m.NotificationLevels.ALL?i[0]=!0:a.state.pushActivity===m.NotificationLevels.NONE?i[2]=!0:i[1]=!0;var n=[!1,!1,!1];a.state.pushStatus===p.default.UserStatuses.ONLINE?n[0]=!0:a.state.pushStatus===p.default.UserStatuses.AWAY?n[1]=!0:n[2]=!0;var l=void 0;a.state.pushActivity!==m.NotificationLevels.NONE&&(l=d.default.createElement("div",null,d.default.createElement("hr",null),d.default.createElement("label",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.push_notification.status",defaultMessage:"Trigger push notifications when"})),d.default.createElement("br",null),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"pushNotificationOnline",type:"radio",name:"pushNotificationStatus",checked:n[0],onChange:a.handlePushStatusRadio.bind(a,p.default.UserStatuses.ONLINE)}),d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.online",defaultMessage:"Online, away or offline"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"pushNotificationAway",type:"radio",name:"pushNotificationStatus",checked:n[1],onChange:a.handlePushStatusRadio.bind(a,p.default.UserStatuses.AWAY)}),d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.away",defaultMessage:"Away or offline"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"pushNotificationOffline",type:"radio",name:"pushNotificationStatus",checked:n[2],onChange:a.handlePushStatusRadio.bind(a,p.default.UserStatuses.OFFLINE)}),d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.offline",defaultMessage:"Offline"})))),t=d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.status_info",defaultMessage:"Notification alerts are only pushed to your mobile device when your online status matches the selection above."}))),e.push(d.default.createElement("div",{key:"userNotificationLevelOption"},d.default.createElement("label",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.send",defaultMessage:"Send mobile push notifications"})),d.default.createElement("br",null),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"pushNotificationAllActivity",type:"radio",name:"pushNotificationLevel",checked:i[0],onChange:a.handlePushRadio.bind(a,m.NotificationLevels.ALL)}),d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.allActivity",defaultMessage:"For all activity"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"pushNotificationMentions",type:"radio",name:"pushNotificationLevel",checked:i[1],onChange:a.handlePushRadio.bind(a,m.NotificationLevels.MENTION)}),d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.onlyMentions",defaultMessage:"For mentions and direct messages"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"pushNotificationNever",type:"radio",name:"pushNotificationLevel",checked:i[2],onChange:a.handlePushRadio.bind(a,m.NotificationLevels.NONE)}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.never",defaultMessage:"Never"}))),d.default.createElement("br",null),d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.info",defaultMessage:"Notification alerts are pushed to your mobile device when there is activity in Mattermost."})),l)),s=a.handleSubmit}else e.push(d.default.createElement("div",{key:"oauthEmailInfo",className:"padding-top"},d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.disabled_long",defaultMessage:"Push notifications have not been enabled by your System Administrator."})));return d.default.createElement(h.default,{title:g.localizeMessage("user.settings.notifications.push","Mobile push notifications"),extraInfo:t,inputs:e,submit:s,server_error:a.state.serverError,updateSection:a.handleUpdateSection})}var r="";return r=a.state.pushActivity===m.NotificationLevels.ALL?a.state.pushStatus===p.default.UserStatuses.AWAY?d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.allActivityAway",defaultMessage:"For all activity when away or offline"}):a.state.pushStatus===p.default.UserStatuses.OFFLINE?d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.allActivityOffline",defaultMessage:"For all activity when offline"}):d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.allActivityOnline",defaultMessage:"For all activity when online, away or offline"}):a.state.pushActivity===m.NotificationLevels.NONE?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.never",defaultMessage:"Never"}):a.props.sendPushNotifications?a.state.pushStatus===p.default.UserStatuses.AWAY?d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.onlyMentionsAway",defaultMessage:"For mentions and direct messages when away or offline"}):a.state.pushStatus===p.default.UserStatuses.OFFLINE?d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.onlyMentionsOffline",defaultMessage:"For mentions and direct messages when offline"}):d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.onlyMentionsOnline",defaultMessage:"For mentions and direct messages when online, away or offline"}):d.default.createElement(u.FormattedMessage,{id:"user.settings.push_notification.disabled",defaultMessage:"Push notifications are not enabled"}),d.default.createElement(v.default,{title:g.localizeMessage("user.settings.notifications.push","Mobile push notifications"),describe:r,focused:a.props.prevActiveSection===y.push,section:"push",updateSection:a.handleUpdateSection})},a.state=_(),a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"componentDidMount",value:function(){f.default.addChangeListener(this.onListenerChange)}},{key:"componentWillUnmount",value:function(){f.default.removeChangeListener(this.onListenerChange)}},{key:"handleNotifyCommentsRadio",value:function(e){this.setState({notifyCommentsLevel:e}),this.refs.wrapper.focus()}},{key:"handlePushRadio",value:function(e){this.setState({pushActivity:e}),this.refs.wrapper.focus()}},{key:"handlePushStatusRadio",value:function(e){this.setState({pushStatus:e}),this.refs.wrapper.focus()}},{key:"render",value:function(){var e=this,t=this.state.serverError,a=this.props.user,s=void 0;if("keys"===this.props.activeSection){var i=[];if(a.first_name){i.push(d.default.createElement("div",{key:"userNotificationFirstNameOption"},d.default.createElement("div",{className:"checkbox"},d.default.createElement("label",null,d.default.createElement("input",{id:"notificationTriggerFirst",type:"checkbox",checked:this.state.firstNameKey,onChange:function(t){e.updateFirstNameKey(t.target.checked)}}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.sensitiveName",defaultMessage:'Your case sensitive first name "{first_name}"',values:{first_name:a.first_name}})))))}i.push(d.default.createElement("div",{key:"userNotificationUsernameOption"},d.default.createElement("div",{className:"checkbox"},d.default.createElement("label",null,d.default.createElement("input",{id:"notificationTriggerUsername",type:"checkbox",checked:this.state.usernameKey,onChange:function(t){e.updateUsernameKey(t.target.checked)}}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.sensitiveUsername",defaultMessage:'Your non-case sensitive username "{username}"',values:{username:a.username}})))));i.push(d.default.createElement("div",{key:"userNotificationChannelOption"},d.default.createElement("div",{className:"checkbox"},d.default.createElement("label",null,d.default.createElement("input",{id:"notificationTriggerShouts",type:"checkbox",checked:this.state.channelKey,onChange:function(t){e.updateChannelKey(t.target.checked)}}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.channelWide",defaultMessage:'Channel-wide mentions "@channel", "@all", "@here"'}))))),i.push(d.default.createElement("div",{key:"userNotificationCustomOption"},d.default.createElement("div",{className:"checkbox"},d.default.createElement("label",null,d.default.createElement("input",{id:"notificationTriggerCustom",ref:"customcheck",type:"checkbox",checked:this.state.customKeysChecked,onChange:this.updateCustomMentionKeys}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.sensitiveWords",defaultMessage:"Other non-case sensitive words, separated by commas:"}))),d.default.createElement("input",{id:"notificationTriggerCustomText",autoFocus:this.state.customKeysChecked,ref:"custommentions",className:"form-control mentions-input",type:"text",defaultValue:this.state.customKeys,onChange:this.onCustomChange,onFocus:g.moveCursorToEnd})));var n=d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.mentionsInfo",defaultMessage:"Mentions trigger when someone sends a message that includes your username (@{username}) or any of the options selected above.",values:{username:a.username}}));s=d.default.createElement(h.default,{title:g.localizeMessage("user.settings.notifications.wordsTrigger","Words that trigger mentions"),inputs:i,submit:this.handleSubmit,saving:this.state.isSaving,server_error:t,updateSection:this.handleUpdateSection,extraInfo:n})}else{var l=["@"+a.username];this.state.firstNameKey&&l.push(a.first_name),this.state.usernameKey&&l.push(a.username),this.state.channelKey&&(l.push("@channel"),l.push("@all"),l.push("@here")),this.state.customKeys.length>0&&(l=l.concat(this.state.customKeys.split(",")));for(var r="",o=0;o<l.length;o++)""!==l[o]&&(r+='"'+l[o]+'", ');r=r.length>0?r.substring(0,r.length-2):d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.noWords",defaultMessage:"No words configured"}),s=d.default.createElement(v.default,{title:g.localizeMessage("user.settings.notifications.wordsTrigger","Words that trigger mentions"),describe:r,focused:this.props.prevActiveSection===y.keys,section:"keys",updateSection:this.handleUpdateSection})}var c=void 0;if("comments"===this.props.activeSection){var f=[!1,!1,!1];"never"===this.state.notifyCommentsLevel?f[2]=!0:"root"===this.state.notifyCommentsLevel?f[1]=!0:f[0]=!0;var m=[];m.push(d.default.createElement("div",{key:"userNotificationLevelOption"},d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"notificationCommentsAny",type:"radio",name:"commentsNotificationLevel",checked:f[0],onChange:this.handleNotifyCommentsRadio.bind(this,"any")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.commentsAny",defaultMessage:"Mention any comments in a thread you participated in (This will include both mentions to your root post and any comments after you commented on a post)"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"notificationCommentsRoot",type:"radio",name:"commentsNotificationLevel",checked:f[1],onChange:this.handleNotifyCommentsRadio.bind(this,"root")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.commentsRoot",defaultMessage:"Mention any comments on your post"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"notificationCommentsNever",type:"radio",name:"commentsNotificationLevel",checked:f[2],onChange:this.handleNotifyCommentsRadio.bind(this,"never")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.commentsNever",defaultMessage:"No mentions for comments"})))));var p=d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.commentsInfo",defaultMessage:"In addition to notifications for when you're mentioned, select if you would like to receive notifications on reply threads."}));c=d.default.createElement(h.default,{title:g.localizeMessage("user.settings.notifications.comments","Reply notifications"),extraInfo:p,inputs:m,submit:this.handleSubmit,saving:this.state.isSaving,server_error:t,updateSection:this.handleUpdateSection})}else{var b="";b="never"===this.state.notifyCommentsLevel?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.commentsNever",defaultMessage:"Do not trigger notifications on messages in reply threads unless I'm mentioned"}):"root"===this.state.notifyCommentsLevel?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.commentsRoot",defaultMessage:"Trigger notifications on messages in threads that I start"}):d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.commentsAny",defaultMessage:"Trigger notifications on messages in reply threads that I start or participate in"}),c=d.default.createElement(v.default,{title:g.localizeMessage("user.settings.notifications.comments","Reply notifications"),describe:b,focused:this.props.prevActiveSection===y.comments,section:"comments",updateSection:this.handleUpdateSection})}var _=void 0;if(this.props.enableAutoResponder)if("auto-responder"===this.props.activeSection)_=d.default.createElement("div",null,d.default.createElement(M.default,{autoResponderActive:this.state.autoResponderActive,autoResponderMessage:this.state.autoResponderMessage,updateSection:this.updateSection,setParentState:this.setStateValue,submit:this.handleSubmit,error:this.state.serverError,saving:this.state.isSaving}),d.default.createElement("div",{className:"divider-dark"}));else{var k=this.state.autoResponderActive?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.autoResponderEnabled",defaultMessage:"Enabled"}):d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.autoResponderDisabled",defaultMessage:"Disabled"});_=d.default.createElement("div",null,d.default.createElement(v.default,{title:d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.autoResponder",defaultMessage:"Automatic Direct Message Replies"}),width:"medium",describe:k,section:"auto-responder",updateSection:this.updateSection}),d.default.createElement("div",{className:"divider-dark"}))}var N=this.createPushNotificationSection(),A="true"===this.state.enableEmail;return d.default.createElement("div",{id:"notificationSettings"},d.default.createElement("div",{className:"modal-header"},d.default.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal",onClick:this.props.closeModal},d.default.createElement("span",{"aria-hidden":"true"},"×")),d.default.createElement("h4",{className:"modal-title",ref:"title"},d.default.createElement("div",{className:"modal-back"},d.default.createElement("i",{className:"fa fa-angle-left",title:g.localizeMessage("generic_icons.collapse","Collapse Icon"),onClick:this.props.collapseModal})),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.title",defaultMessage:"Notification Settings"}))),d.default.createElement("div",{ref:"wrapper",className:"user-settings"},d.default.createElement("h3",{id:"notificationSettingsTitle",className:"tab-header"},d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.header",defaultMessage:"Notifications"})),d.default.createElement("div",{className:"divider-dark first"}),d.default.createElement(E.default,{activity:this.state.desktopActivity,sound:this.state.desktopSound,updateSection:this.updateSection,setParentState:this.setStateValue,submit:this.handleSubmit,saving:this.state.isSaving,cancel:this.handleCancel,error:this.state.serverError,active:"desktop"===this.props.activeSection,focused:this.props.prevActiveSection===y.desktop}),d.default.createElement("div",{className:"divider-light"}),d.default.createElement(S.default,{activeSection:this.props.activeSection,updateSection:this.props.updateSection,enableEmail:A,emailInterval:g.getEmailInterval(this.props.enableEmailBatching,A),onSubmit:this.handleSubmit,onCancel:this.handleCancel,saving:this.state.isSaving,serverError:this.state.serverError,focused:this.props.prevActiveSection===y.email,sendEmailNotifications:this.props.sendEmailNotifications,enableEmailBatching:this.props.enableEmailBatching,siteName:this.props.siteName}),d.default.createElement("div",{className:"divider-light"}),N,d.default.createElement("div",{className:"divider-light"}),s,d.default.createElement("div",{className:"divider-light"}),c,d.default.createElement("div",{className:"divider-light"}),_,d.default.createElement("div",{className:"divider-dark"})))}}]),t}(d.default.Component);t.default=k,k.propTypes={user:o.default.object,updateSection:o.default.func,activeSection:o.default.string,prevActiveSection:o.default.string,closeModal:o.default.func.isRequired,collapseModal:o.default.func.isRequired,sendEmailNotifications:o.default.bool,enableEmailBatching:o.default.bool,siteName:o.default.string,sendPushNotifications:o.default.bool,enableAutoResponder:o.default.bool},k.defaultProps={user:null,activeSection:"",prevActiveSection:"",activeTab:""}},2456:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=h(a(282)),i=h(a(281)),n=h(a(285)),l=h(a(283)),r=h(a(284)),o=h(a(1)),d=h(a(3)),u=a(766),c=a(22),f=h(c),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(765)),p=h(a(809)),g=h(a(817));function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(){var e,a,n,r;(0,i.default)(this,t);for(var o=arguments.length,h=Array(o),v=0;v<o;v++)h[v]=arguments[v];return a=n=(0,l.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(h))),n.handleMinUpdateSection=function(e){n.props.updateSection(e),n.props.cancel()},n.handleMaxUpdateSection=function(e){n.props.updateSection(e)},n.handleOnChange=function(e){var t=e.currentTarget.getAttribute("data-key"),a=e.currentTarget.getAttribute("data-value");n.props.setParentState(t,a)},n.buildMaximizedSetting=function(){var e=[],t=[!1,!1,!1];n.props.activity===c.NotificationLevels.MENTION?t[1]=!0:n.props.activity===c.NotificationLevels.NONE?t[2]=!0:t[0]=!0;var a=void 0;if(n.props.activity!==c.NotificationLevels.NONE){var s=[!1,!1];"false"===n.props.sound?s[1]=!0:s[0]=!0,a=m.hasSoundOptions()?d.default.createElement("div",null,d.default.createElement("hr",null),d.default.createElement("label",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop.sound",defaultMessage:"Notification sound"})),d.default.createElement("br",null),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"soundOn",type:"radio",name:"notificationSounds",checked:s[0],"data-key":"desktopSound","data-value":"true",onChange:n.handleOnChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.on",defaultMessage:"On"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"soundOff",type:"radio",name:"notificationSounds",checked:s[1],"data-key":"desktopSound","data-value":"false",onChange:n.handleOnChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.off",defaultMessage:"Off"})),d.default.createElement("br",null)),d.default.createElement("br",null),d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.sounds_info",defaultMessage:"Notification sounds are available on IE11, Safari, Chrome and Mattermost Desktop Apps."}))):d.default.createElement("div",null,d.default.createElement("hr",null),d.default.createElement("label",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop.sound",defaultMessage:"Notification sound"})),d.default.createElement("br",null),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.soundConfig",defaultMessage:"Please configure notification sounds in your browser settings"}))}return e.push(d.default.createElement("div",{key:"userNotificationLevelOption"},d.default.createElement("label",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop",defaultMessage:"Send desktop notifications"})),d.default.createElement("br",null),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"desktopNotificationAllActivity",type:"radio",name:"desktopNotificationLevel",checked:t[0],"data-key":"desktopActivity","data-value":c.NotificationLevels.ALL,onChange:n.handleOnChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.allActivity",defaultMessage:"For all activity"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"desktopNotificationMentions",type:"radio",name:"desktopNotificationLevel",checked:t[1],"data-key":"desktopActivity","data-value":c.NotificationLevels.MENTION,onChange:n.handleOnChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.onlyMentions",defaultMessage:"Only for mentions and direct messages"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"desktopNotificationNever",type:"radio",name:"desktopNotificationLevel",checked:t[2],"data-key":"desktopActivity","data-value":c.NotificationLevels.NONE,onChange:n.handleOnChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.never",defaultMessage:"Never"}))),d.default.createElement("br",null),d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.info",defaultMessage:"Desktop notifications are available on Edge, Firefox, Safari, Chrome and Mattermost Desktop Apps."})),a)),d.default.createElement(p.default,{title:m.localizeMessage("user.settings.notifications.desktop.title","Desktop notifications"),inputs:e,submit:n.props.submit,saving:n.props.saving,server_error:n.props.error,updateSection:n.handleMaxUpdateSection})},n.buildMinimizedSetting=function(){var e="";return e=n.props.activity===c.NotificationLevels.MENTION?m.hasSoundOptions()&&"false"!==n.props.sound?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop.mentionsSoundTimed",defaultMessage:"For mentions and direct messages, with sound, shown for {seconds} seconds",values:{seconds:f.default.DEFAULT_NOTIFICATION_DURATION/1e3}}):m.hasSoundOptions()&&"false"===n.props.sound?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop.mentionsNoSoundTimed",defaultMessage:"For mentions and direct messages, without sound, shown for {seconds} seconds",values:{seconds:f.default.DEFAULT_NOTIFICATION_DURATION/1e3}}):d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop.mentionsSoundHiddenTimed",defaultMessage:"For mentions and direct messages, shown for {seconds} seconds",values:{seconds:f.default.DEFAULT_NOTIFICATION_DURATION/1e3}}):n.props.activity===c.NotificationLevels.NONE?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.off",defaultMessage:"Off"}):m.hasSoundOptions()&&"false"!==n.props.sound?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop.allSoundTimed",defaultMessage:"For all activity, with sound, shown for {seconds} seconds",values:{seconds:f.default.DEFAULT_NOTIFICATION_DURATION/1e3}}):m.hasSoundOptions()&&"false"===n.props.sound?d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop.allNoSoundTimed",defaultMessage:"For all activity, without sound, shown for {seconds} seconds",values:{seconds:f.default.DEFAULT_NOTIFICATION_DURATION/1e3}}):d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.desktop.allSoundHiddenTimed",defaultMessage:"For all activity, shown for {seconds} seconds",values:{seconds:f.default.DEFAULT_NOTIFICATION_DURATION/1e3}}),d.default.createElement(g.default,{title:m.localizeMessage("user.settings.notifications.desktop.title","Desktop notifications"),describe:e,focused:n.props.focused,section:"desktop",updateSection:n.handleMinUpdateSection})},r=a,(0,l.default)(n,r)}return(0,r.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){return this.props.active?this.buildMaximizedSetting():this.buildMinimizedSetting()}}]),t}(d.default.Component);t.default=v,v.propTypes={activity:o.default.string.isRequired,sound:o.default.string.isRequired,updateSection:o.default.func,setParentState:o.default.func,submit:o.default.func,cancel:o.default.func,error:o.default.string,active:o.default.bool,saving:o.default.bool,focused:o.default.bool}},2457:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=h(a(282)),i=h(a(281)),n=h(a(285)),l=h(a(283)),r=h(a(284)),o=h(a(1)),d=h(a(3)),u=a(766),c=a(781),f=a(22),m=a(765),p=h(a(809)),g=h(a(817));function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.handleChange=function(e){var t=e.currentTarget.getAttribute("data-enable-email"),s=parseInt(e.currentTarget.getAttribute("data-email-interval"),10);a.setState({enableEmail:t,emailInterval:s})},a.handleSubmit=function(){var e=a.state,t=e.enableEmail,s=e.emailInterval;a.props.enableEmail!==t||a.props.emailInterval!==s?((0,c.savePreference)(f.Preferences.CATEGORY_NOTIFICATIONS,f.Preferences.EMAIL_INTERVAL,s.toString()),a.props.onSubmit(t)):a.props.updateSection("")},a.handleUpdateSection=function(e){e?a.props.updateSection(e):(a.props.updateSection(""),a.setState({enableEmail:a.props.enableEmail,emailInterval:a.props.emailInterval}),a.props.onCancel())},a.state={enableEmail:e.enableEmail,emailInterval:e.emailInterval},a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.saving||e.enableEmail===this.props.enableEmail&&e.emailInterval===this.props.emailInterval||this.setState({enableEmail:e.enableEmail,emailInterval:e.emailInterval})}},{key:"render",value:function(){if(!this.props.sendEmailNotifications&&"email"===this.props.activeSection){var e=[];return e.push(d.default.createElement("div",{key:"oauthEmailInfo",className:"padding-top"},d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.disabled_long",defaultMessage:"Email notifications have not been enabled by your System Administrator."}))),d.default.createElement(p.default,{title:(0,m.localizeMessage)("user.settings.notifications.emailNotifications","Email notifications"),inputs:e,server_error:this.state.serverError,section:"email",updateSection:this.handleUpdateSection})}if("email"!==this.props.activeSection){var t=void 0;if(this.props.sendEmailNotifications)if(this.props.enableEmail)switch(this.state.emailInterval){case f.Preferences.INTERVAL_IMMEDIATE:t=d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.immediately",defaultMessage:"Immediately"});break;case f.Preferences.INTERVAL_HOUR:t=d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.everyHour",defaultMessage:"Every hour"});break;default:t=d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.everyXMinutes",defaultMessage:"Every {count, plural, one {minute} other {{count, number} minutes}}",values:{count:this.state.emailInterval/60}})}else t=d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.never",defaultMessage:"Never"});else t=d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.disabled",defaultMessage:"Email notifications are not enabled"});return d.default.createElement(g.default,{title:(0,m.localizeMessage)("user.settings.notifications.emailNotifications","Email notifications"),describe:t,focused:this.props.focused,section:"email",updateSection:this.handleUpdateSection})}var a=null,s=null;return this.props.enableEmailBatching&&(a=d.default.createElement("div",null,d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"emailNotificationMinutes",type:"radio",name:"emailNotifications",checked:this.state.emailInterval===f.Preferences.INTERVAL_FIFTEEN_MINUTES,"data-enable-email":"true","data-email-interval":f.Preferences.INTERVAL_FIFTEEN_MINUTES,onChange:this.handleChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.everyXMinutes",defaultMessage:"Every {count} minutes",values:{count:f.Preferences.INTERVAL_FIFTEEN_MINUTES/60}}))),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"emailNotificationHour",type:"radio",name:"emailNotifications",checked:this.state.emailInterval===f.Preferences.INTERVAL_HOUR,"data-enable-email":"true","data-email-interval":f.Preferences.INTERVAL_HOUR,onChange:this.handleChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.everyHour",defaultMessage:"Every hour"})))),s=d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.emailBatchingInfo",defaultMessage:"Notifications received over the time period selected are combined and sent in a single email."})),d.default.createElement(p.default,{title:(0,m.localizeMessage)("user.settings.notifications.emailNotifications","Email notifications"),inputs:[d.default.createElement("div",{key:"userNotificationEmailOptions"},d.default.createElement("label",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.send",defaultMessage:"Send email notifications"})),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"emailNotificationImmediately",type:"radio",name:"emailNotifications",checked:this.state.emailInterval===f.Preferences.INTERVAL_IMMEDIATE,"data-enable-email":"true","data-email-interval":f.Preferences.INTERVAL_IMMEDIATE,onChange:this.handleChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.immediately",defaultMessage:"Immediately"}))),a,d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"emailNotificationNever",type:"radio",name:"emailNotifications",checked:this.state.emailInterval===f.Preferences.INTERVAL_NEVER,"data-enable-email":"false","data-email-interval":f.Preferences.INTERVAL_NEVER,onChange:this.handleChange}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.email.never",defaultMessage:"Never"}))),d.default.createElement("br",null),d.default.createElement("div",null,d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.emailInfo",defaultMessage:"Email notifications are sent for mentions and direct messages when you are offline or away from {siteName} for more than 5 minutes.",values:{siteName:this.props.siteName}})," ",s))],submit:this.handleSubmit,saving:this.props.saving,server_error:this.props.serverError,updateSection:this.handleUpdateSection})}}]),t}(d.default.Component);v.propTypes={activeSection:o.default.string.isRequired,updateSection:o.default.func.isRequired,enableEmail:o.default.bool.isRequired,emailInterval:o.default.number.isRequired,onSubmit:o.default.func.isRequired,onCancel:o.default.func.isRequired,serverError:o.default.string,saving:o.default.bool,focused:o.default.bool,sendEmailNotifications:o.default.bool,enableEmailBatching:o.default.bool,siteName:o.default.string},t.default=v},2458:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=p(a(282)),i=p(a(281)),n=p(a(285)),l=p(a(283)),r=p(a(284)),o=p(a(1)),d=p(a(3)),u=a(766),c=p(a(1334)),f=p(a(809)),m=a(765);function p(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(){var e,a,n,r;(0,i.default)(this,t);for(var o=arguments.length,d=Array(o),u=0;u<o;u++)d[u]=arguments[u];return a=n=(0,l.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(d))),n.handleAutoResponderChecked=function(e){n.props.setParentState("autoResponderActive",e.target.checked)},n.onMessageChanged=function(e){n.props.setParentState("autoResponderMessage",e.target.value)},r=a,(0,l.default)(n,r)}return(0,r.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this.props,t=e.autoResponderActive,a=e.autoResponderMessage,s=void 0;this.props.error&&(s=d.default.createElement("label",{className:"has-error"},this.props.error));var i=[],n=d.default.createElement("div",{id:"autoResponderCheckbox",key:"autoResponderCheckbox",className:"checkbox"},d.default.createElement("label",null,d.default.createElement("input",{id:"autoResponderActive",type:"checkbox",checked:t,onChange:this.handleAutoResponderChecked}),d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.autoResponderEnabled",defaultMessage:"Enabled"}))),l=d.default.createElement("div",{id:"autoResponderMessage",key:"autoResponderMessage"},d.default.createElement("div",{className:"padding-top"},d.default.createElement(c.default,{style:{resize:"none"},id:"autoResponderMessageInput",className:"form-control",rows:"5",placeholder:(0,m.localizeMessage)("user.settings.notifications.autoResponderPlaceholder","Message"),value:a,maxLength:200,onChange:this.onMessageChanged}),s));return i.push(n),t&&i.push(l),i.push(d.default.createElement("div",{key:"autoResponderHint"},d.default.createElement("br",null),d.default.createElement(u.FormattedHTMLMessage,{id:"user.settings.notifications.autoResponderHint",defaultMessage:"Set a custom message that will be automatically sent in response to Direct Messages. Mentions in Public and Private Channels will not trigger the automated reply. Enabling Automatic Replies sets your status to Out of Office and disables email and push notifications."}))),d.default.createElement(f.default,{title:d.default.createElement(u.FormattedMessage,{id:"user.settings.notifications.autoResponder",defaultMessage:"Automatic Direct Message Replies"}),width:"medium",shiftEnter:!0,submit:this.props.submit,saving:this.props.saving,inputs:i,updateSection:this.props.updateSection})}}]),t}(d.default.PureComponent);g.propTypes={autoResponderActive:o.default.bool.isRequired,autoResponderMessage:o.default.string.isRequired,updateSection:o.default.func.isRequired,setParentState:o.default.func.isRequired,submit:o.default.func.isRequired,saving:o.default.bool.isRequired,error:o.default.string},t.default=g},2459:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(2),n=a(779),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(186)),r=a(96),o=a(765),d=function(e){return e&&e.__esModule?e:{default:e}}(a(2460));t.default=(0,s.connect)(function(e,t){var a=(0,r.getLicense)(e),s=(0,r.getConfig)(e),i="true"===s.EnableUserAccessTokens,n=l.hasUserAccessTokenRole(t.user.roles)||l.isSystemAdmin(t.user.roles),d=a&&"true"===a.IsLicensed,u=a&&"true"===a.MFA,c="true"===s.EnableOAuthServiceProvider,f="true"===s.EnableMultifactorAuthentication,m="true"===s.EnforceMultifactorAuthentication,p="true"===s.EnableSignUpWithEmail,g="true"===s.EnableSignUpWithGitLab,h="true"===s.EnableSignUpWithGoogle,v="true"===s.EnableLdap,E="true"===s.EnableSaml,S="true"===s.EnableSignUpWithOffice365,M="true"===s.ExperimentalEnableAuthenticationTransfer;return{canUseAccessTokens:i&&n,isLicensed:d,mfaLicensed:u,enableOAuthServiceProvider:c,enableMultifactorAuthentication:f,enforceMultifactorAuthentication:m,enableSignUpWithEmail:p,enableSignUpWithGitLab:g,enableSignUpWithGoogle:h,enableLdap:v,enableSaml:E,enableSignUpWithOffice365:S,experimentalEnableAuthenticationTransfer:M,passwordConfig:(0,o.getPasswordConfig)(s)}},function(e){return{actions:(0,i.bindActionCreators)({getMe:n.getMe},e)}})(d.default)},2460:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=N(a(184)),i=N(a(282)),n=N(a(281)),l=N(a(285)),r=N(a(283)),o=N(a(284)),d=N(a(1)),u=N(a(3)),c=a(766),f=a(287),m=a(291),p=a(781),g=N(a(810)),h=N(a(22)),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(765)),E=N(a(984)),S=N(a(2461)),M=N(a(2463)),b=N(a(809)),_=N(a(817)),y=N(a(999)),k=N(a(2467));function N(e){return e&&e.__esModule?e:{default:e}}var A="mfa",C="password",T="signin",w="apps",F="tokens",I=function(e){function t(e){(0,n.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.submitPassword=function(){var e=a.props.user,t=a.state.currentPassword,i=a.state.newPassword,n=a.state.confirmPassword;if(""!==t){var l=v.isValidPassword(i,a.props.passwordConfig),r=l.valid,o=l.error;if(r||!o)if(i===n)a.setState({savingPassword:!0}),(0,p.updatePassword)(e.id,t,i,function(){a.props.updateSection(""),a.props.actions.getMe(),a.setState(a.getDefaultState())},function(e){var t=a.getDefaultState();e.message?t.serverError=e.message:t.serverError=e,t.passwordError="",a.setState(t)});else{var d=(0,s.default)(a.getDefaultState(),{passwordError:v.localizeMessage("user.settings.security.passwordMatchError","The new passwords you entered do not match."),serverError:""});a.setState(d)}else a.setState({passwordError:o,serverError:""})}else a.setState({passwordError:v.localizeMessage("user.settings.security.currentPasswordError","Please enter your current password."),serverError:""})},a.setupMfa=function(e){e.preventDefault(),m.browserHistory.push("/mfa/setup")},a.removeMfa=function(){(0,p.deactivateMfa)(function(){a.props.mfaLicensed&&a.props.enableMultifactorAuthentication&&a.props.enforceMultifactorAuthentication?m.browserHistory.push("/mfa/setup"):(a.props.updateSection(""),a.setState(a.getDefaultState()))},function(e){var t=a.getDefaultState();e.message?t.serverError=e.message:t.serverError=e,a.setState(t)})},a.updateCurrentPassword=function(e){a.setState({currentPassword:e.target.value})},a.updateNewPassword=function(e){a.setState({newPassword:e.target.value})},a.updateConfirmPassword=function(e){a.setState({confirmPassword:e.target.value})},a.deauthorizeApp=function(e){e.preventDefault();var t=e.currentTarget.getAttribute("data-app");(0,p.deauthorizeOAuthApp)(t,function(){var e=a.state.authorizedApps.filter(function(e){return e.id!==t});a.setState({authorizedApps:e,serverError:null})},function(e){a.setState({serverError:e.message})})},a.handleUpdateSection=function(e){if(e)a.props.updateSection(e);else{switch(a.props.activeSection){case A:case T:case F:case w:a.setState({serverError:null});break;case C:a.setState({currentPassword:"",newPassword:"",confirmPassword:"",serverError:null,passwordError:null})}a.props.updateSection("")}},a.createMfaSection=function(){if(a.props.activeSection===A){var e=void 0,t=void 0;if(a.props.user.mfa_active){var s=void 0,i=void 0;a.props.enforceMultifactorAuthentication?(s=u.default.createElement(c.FormattedMessage,{id:"user.settings.mfa.requiredHelp",defaultMessage:"Multi-factor authentication is required on this server. Resetting is only recommended when you need to switch code generation to a new mobile device. You will be required to set it up again immediately."}),i=u.default.createElement(c.FormattedMessage,{id:"user.settings.mfa.reset",defaultMessage:"Reset MFA on your account"})):(s=u.default.createElement(c.FormattedMessage,{id:"user.settings.mfa.removeHelp",defaultMessage:"Removing multi-factor authentication means you will no longer require a phone-based passcode to sign-in to your account."}),i=u.default.createElement(c.FormattedMessage,{id:"user.settings.mfa.remove",defaultMessage:"Remove MFA from your account"})),e=u.default.createElement("div",{key:"mfaQrCode"},u.default.createElement("a",{className:"btn btn-primary",href:"#",onClick:a.removeMfa},i),u.default.createElement("br",null)),t=u.default.createElement("span",null,s)}else e=u.default.createElement("div",{key:"mfaQrCode"},u.default.createElement("a",{className:"btn btn-primary",href:"#",onClick:a.setupMfa},u.default.createElement(c.FormattedMessage,{id:"user.settings.mfa.add",defaultMessage:"Add MFA to your account"})),u.default.createElement("br",null)),t=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.mfa.addHelp",defaultMessage:"Adding multi-factor authentication will make your account more secure by requiring a code from your mobile phone each time you sign in."}));var n=[];return n.push(u.default.createElement("div",{key:"mfaSetting",className:"padding-top"},e)),u.default.createElement(b.default,{title:v.localizeMessage("user.settings.mfa.title","Multi-factor Authentication"),inputs:n,extraInfo:t,serverError:a.state.serverError,updateSection:a.handleUpdateSection,width:"medium"})}var l=void 0;return l=a.props.user.mfa_active?v.localizeMessage("user.settings.security.active","Active"):v.localizeMessage("user.settings.security.inactive","Inactive"),u.default.createElement(_.default,{title:v.localizeMessage("user.settings.mfa.title","Multi-factor Authentication"),describe:l,section:A,updateSection:a.handleUpdateSection})},a.createPasswordSection=function(){if(a.props.activeSection===C){var e=[],t=void 0;return""===a.props.user.auth_service?(t=a.submitPassword,e.push(u.default.createElement("div",{key:"currentPasswordUpdateForm",className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.currentPassword",defaultMessage:"Current Password"})),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"currentPassword",autoFocus:!0,className:"form-control",type:"password",onChange:a.updateCurrentPassword,value:a.state.currentPassword})))),e.push(u.default.createElement("div",{key:"newPasswordUpdateForm",className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.newPassword",defaultMessage:"New Password"})),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"newPassword",className:"form-control",type:"password",onChange:a.updateNewPassword,value:a.state.newPassword})))),e.push(u.default.createElement("div",{key:"retypeNewPasswordUpdateForm",className:"form-group"},u.default.createElement("label",{className:"col-sm-5 control-label"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.retypePassword",defaultMessage:"Retype New Password"})),u.default.createElement("div",{className:"col-sm-7"},u.default.createElement("input",{id:"confirmPassword",className:"form-control",type:"password",onChange:a.updateConfirmPassword,value:a.state.confirmPassword}))))):a.props.user.auth_service===h.default.GITLAB_SERVICE?e.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"form-group"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.passwordGitlabCantUpdate",defaultMessage:"Login occurs through GitLab. Password cannot be updated."})))):a.props.user.auth_service===h.default.LDAP_SERVICE?e.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"form-group"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.passwordLdapCantUpdate",defaultMessage:"Login occurs through AD/LDAP. Password cannot be updated."})))):a.props.user.auth_service===h.default.SAML_SERVICE?e.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"form-group"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.passwordSamlCantUpdate",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so through your login provider."})))):a.props.user.auth_service===h.default.GOOGLE_SERVICE?e.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"form-group"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.passwordGoogleCantUpdate",defaultMessage:"Login occurs through Google Apps. Password cannot be updated."})))):a.props.user.auth_service===h.default.OFFICE365_SERVICE&&e.push(u.default.createElement("div",{key:"oauthEmailInfo",className:"form-group"},u.default.createElement("div",{className:"setting-list__hint col-sm-12"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.passwordOffice365CantUpdate",defaultMessage:"Login occurs through Office 365. Password cannot be updated."})))),u.default.createElement(b.default,{title:u.default.createElement(c.FormattedMessage,{id:"user.settings.security.password",defaultMessage:"Password"}),inputs:e,submit:t,saving:a.state.savingPassword,serverError:a.state.serverError,clientError:a.state.passwordError,updateSection:a.handleUpdateSection})}var s=void 0;if(""===a.props.user.auth_service){var i=new Date(a.props.user.last_password_update),n=!g.default.getBool(h.default.Preferences.CATEGORY_DISPLAY_SETTINGS,h.default.Preferences.USE_MILITARY_TIME,!1);s=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.lastUpdated",defaultMessage:"Last updated {date} at {time}",values:{date:u.default.createElement(c.FormattedDate,{value:i,day:"2-digit",month:"short",year:"numeric"}),time:u.default.createElement(c.FormattedTime,{value:i,hour12:n,hour:"2-digit",minute:"2-digit"})}})}else a.props.user.auth_service===h.default.GITLAB_SERVICE?s=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.loginGitlab",defaultMessage:"Login done through GitLab"}):a.props.user.auth_service===h.default.LDAP_SERVICE?s=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.loginLdap",defaultMessage:"Login done through AD/LDAP"}):a.props.user.auth_service===h.default.SAML_SERVICE?s=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.loginSaml",defaultMessage:"Login done through SAML"}):a.props.user.auth_service===h.default.GOOGLE_SERVICE?s=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.loginGoogle",defaultMessage:"Login done through Google Apps"}):a.props.user.auth_service===h.default.OFFICE365_SERVICE&&(s=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.loginOffice365",defaultMessage:"Login done through Office 365"}));return u.default.createElement(_.default,{title:u.default.createElement(c.FormattedMessage,{id:"user.settings.security.password",defaultMessage:"Password"}),describe:s,section:C,updateSection:a.handleUpdateSection})},a.createSignInSection=function(){var e=a.props.user;if(a.props.activeSection===T){var t=void 0,s=void 0,i=void 0,n=void 0,l=void 0,r=void 0;if(""===e.auth_service)a.props.enableSignUpWithGitLab&&(s=u.default.createElement("div",{className:"padding-bottom x2"},u.default.createElement(f.Link,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+h.default.GITLAB_SERVICE},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.switchGitlab",defaultMessage:"Switch to using GitLab SSO"})),u.default.createElement("br",null))),a.props.enableSignUpWithGoogle&&(i=u.default.createElement("div",{className:"padding-bottom x2"},u.default.createElement(f.Link,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+h.default.GOOGLE_SERVICE},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.switchGoogle",defaultMessage:"Switch to using Google SSO"})),u.default.createElement("br",null))),a.props.enableSignUpWithOffice365&&(n=u.default.createElement("div",{className:"padding-bottom x2"},u.default.createElement(f.Link,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+h.default.OFFICE365_SERVICE},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.switchOffice365",defaultMessage:"Switch to using Office 365 SSO"})),u.default.createElement("br",null))),a.props.enableLdap&&(l=u.default.createElement("div",{className:"padding-bottom x2"},u.default.createElement(f.Link,{className:"btn btn-primary",to:"/claim/email_to_ldap?email="+encodeURIComponent(e.email)},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.switchLdap",defaultMessage:"Switch to using AD/LDAP"})),u.default.createElement("br",null))),a.props.enableSaml&&(r=u.default.createElement("div",{className:"padding-bottom x2"},u.default.createElement(f.Link,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+h.default.SAML_SERVICE},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.switchSaml",defaultMessage:"Switch to using SAML SSO"})),u.default.createElement("br",null)));else if(a.props.enableSignUpWithEmail){var o=void 0;o=e.auth_service===h.default.LDAP_SERVICE?"/claim/ldap_to_email?email="+encodeURIComponent(e.email):"/claim/oauth_to_email?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service,t=u.default.createElement("div",{className:"padding-bottom x2"},u.default.createElement(f.Link,{className:"btn btn-primary",to:o},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.switchEmail",defaultMessage:"Switch to using email and password"})),u.default.createElement("br",null))}var d=[];d.push(u.default.createElement("div",{key:"userSignInOption"},t,s,i,n,l,r));var m=u.default.createElement("span",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.security.oneSignin",defaultMessage:"You may only have one sign-in method at a time. Switching sign-in method will send an email notifying you if the change was successful."}));return u.default.createElement(b.default,{title:v.localizeMessage("user.settings.security.method","Sign-in Method"),extraInfo:m,inputs:d,serverError:a.state.serverError,updateSection:a.handleUpdateSection})}var p=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.emailPwd",defaultMessage:"Email and Password"});return a.props.user.auth_service===h.default.GITLAB_SERVICE?p=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.gitlab",defaultMessage:"GitLab"}):a.props.user.auth_service===h.default.GOOGLE_SERVICE?p=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.google",defaultMessage:"Google"}):a.props.user.auth_service===h.default.OFFICE365_SERVICE?p=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.office365",defaultMessage:"Office 365"}):a.props.user.auth_service===h.default.LDAP_SERVICE?p=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.ldap",defaultMessage:"AD/LDAP"}):a.props.user.auth_service===h.default.SAML_SERVICE&&(p=u.default.createElement(c.FormattedMessage,{id:"user.settings.security.saml",defaultMessage:"SAML"})),u.default.createElement(_.default,{title:v.localizeMessage("user.settings.security.method","Sign-in Method"),describe:p,section:T,updateSection:a.handleUpdateSection})},a.createOAuthAppsSection=function(){if(a.props.activeSection===w){var e=void 0;e=a.state.authorizedApps&&a.state.authorizedApps.length>0?a.state.authorizedApps.map(function(e){var t=u.default.createElement("a",{href:e.homepage,target:"_blank",rel:"noopener noreferrer"},e.homepage);return u.default.createElement("div",{key:e.id,className:"padding-bottom x2 authorized-app"},u.default.createElement("div",{className:"col-sm-10"},u.default.createElement("div",{className:"authorized-app__name"},e.name,u.default.createElement("span",{className:"authorized-app__url"}," -"," ",t)),u.default.createElement("div",{className:"authorized-app__description"},e.description),u.default.createElement("div",{className:"authorized-app__deauthorize"},u.default.createElement("a",{href:"#","data-app":e.id,onClick:a.deauthorizeApp},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.deauthorize",defaultMessage:"Deauthorize"})))),u.default.createElement("div",{className:"col-sm-2 pull-right"},u.default.createElement("img",{alt:e.name,src:e.icon_url||E.default})),u.default.createElement("br",null))}):u.default.createElement("div",{className:"padding-bottom x2 authorized-app"},u.default.createElement("div",{className:"setting-list__hint"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.noApps",defaultMessage:"No OAuth 2.0 Applications are authorized."})));var t=[],s=void 0,i=void 0;Array.isArray(e)&&(s="authorized-apps__wrapper",i=u.default.createElement("div",{className:"authorized-apps__help"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.oauthAppsHelp",defaultMessage:"Applications act on your behalf to access your data based on the permissions you grant them."}))),t.push(u.default.createElement("div",{className:s,key:"authorizedApps"},e));var n=u.default.createElement("div",null,u.default.createElement(c.FormattedMessage,{id:"user.settings.security.oauthApps",defaultMessage:"OAuth 2.0 Applications"}),i);return u.default.createElement(b.default,{title:n,inputs:t,serverError:a.state.serverError,updateSection:a.handleUpdateSection,width:"full",cancelButtonText:u.default.createElement(c.FormattedMessage,{id:"user.settings.security.close",defaultMessage:"Close"})})}return u.default.createElement(_.default,{title:v.localizeMessage("user.settings.security.oauthApps","OAuth 2.0 Applications"),describe:u.default.createElement(c.FormattedMessage,{id:"user.settings.security.oauthAppsDescription",defaultMessage:"Click 'Edit' to manage your OAuth 2.0 Applications"}),section:w,updateSection:a.handleUpdateSection})},a.state=a.getDefaultState(),a}return(0,o.default)(t,e),(0,l.default)(t,[{key:"getDefaultState",value:function(){return{currentPassword:"",newPassword:"",confirmPassword:"",passwordError:"",serverError:"",tokenError:"",authService:this.props.user.auth_service,savingPassword:!1}}},{key:"componentDidMount",value:function(){var e=this;this.props.enableOAuthServiceProvider&&(0,p.getAuthorizedApps)(function(t){e.setState({authorizedApps:t,serverError:null})},function(t){e.setState({serverError:t.message})})}},{key:"render",value:function(){var e=this.props.user,t=this.createPasswordSection(),a=0;a=this.props.enableSignUpWithGitLab?a+1:a,a=this.props.enableSignUpWithGoogle?a+1:a,a=this.props.enableSignUpWithOffice365?a+1:a,a=this.props.enableLdap?a+1:a,a=this.props.enableSaml?a+1:a;var s=void 0;(this.props.enableSignUpWithEmail||""===e.auth_service)&&a>0&&this.props.experimentalEnableAuthenticationTransfer&&(s=this.createSignInSection());var i=void 0;this.props.enableMultifactorAuthentication&&this.props.isLicensed&&(""===e.auth_service||e.auth_service===h.default.LDAP_SERVICE)&&(i=this.createMfaSection());var n=void 0;this.props.enableOAuthServiceProvider&&(n=this.createOAuthAppsSection());var l=void 0;return this.props.canUseAccessTokens&&(l=u.default.createElement(k.default,{user:this.props.user,active:this.props.activeSection===F,updateSection:this.handleUpdateSection,setRequireConfirm:this.props.setRequireConfirm})),u.default.createElement("div",null,u.default.createElement("div",{className:"modal-header"},u.default.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":v.localizeMessage("user.settings.security.close","Close"),onClick:this.props.closeModal},u.default.createElement("span",{"aria-hidden":"true"},"×")),u.default.createElement("h4",{className:"modal-title",ref:"title"},u.default.createElement("div",{className:"modal-back"},u.default.createElement("i",{className:"fa fa-angle-left",title:v.localizeMessage("generic_icons.collapse","Collapse Icon"),onClick:this.props.collapseModal})),u.default.createElement(c.FormattedMessage,{id:"user.settings.security.title",defaultMessage:"Security Settings"}))),u.default.createElement("div",{className:"user-settings"},u.default.createElement("h3",{className:"tab-header"},u.default.createElement(c.FormattedMessage,{id:"user.settings.security.title",defaultMessage:"Security Settings"})),u.default.createElement("div",{className:"divider-dark first"}),t,u.default.createElement("div",{className:"divider-light"}),i,u.default.createElement("div",{className:"divider-light"}),n,u.default.createElement("div",{className:"divider-light"}),l,u.default.createElement("div",{className:"divider-light"}),s,u.default.createElement("div",{className:"divider-dark"}),u.default.createElement("br",null),u.default.createElement(y.default,{className:"security-links color--link",dialogType:S.default},u.default.createElement("i",{className:"fa fa-clock-o",title:v.localizeMessage("user.settings.security.viewHistory.icon","Access History Icon")}),u.default.createElement(c.FormattedMessage,{id:"user.settings.security.viewHistory",defaultMessage:"View Access History"})),u.default.createElement(y.default,{className:"security-links color--link margin-top",dialogType:M.default},u.default.createElement("i",{className:"fa fa-clock-o",title:v.localizeMessage("user.settings.security.logoutActiveSessions.icon","Active Sessions Icon")}),u.default.createElement(c.FormattedMessage,{id:"user.settings.security.logoutActiveSessions",defaultMessage:"View and Logout of Active Sessions"}))))}}]),t}(u.default.Component);I.propTypes={user:d.default.object,activeSection:d.default.string,updateSection:d.default.func,closeModal:d.default.func.isRequired,collapseModal:d.default.func.isRequired,setRequireConfirm:d.default.func.isRequired,canUseAccessTokens:d.default.bool,isLicensed:d.default.bool,mfaLicensed:d.default.bool,enableOAuthServiceProvider:d.default.bool,enableMultifactorAuthentication:d.default.bool,enforceMultifactorAuthentication:d.default.bool,enableSignUpWithEmail:d.default.bool,enableSignUpWithGitLab:d.default.bool,enableSignUpWithGoogle:d.default.bool,enableLdap:d.default.bool,enableSaml:d.default.bool,enableSignUpWithOffice365:d.default.bool,experimentalEnableAuthenticationTransfer:d.default.bool,passwordConfig:d.default.object,actions:d.default.shape({getMe:d.default.func.isRequired}).isRequired},t.default=I,I.defaultProps={user:{},activeSection:""}},2461:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(2),n=a(779),l=a(770),r=function(e){return e&&e.__esModule?e:{default:e}}(a(2462));t.default=(0,s.connect)(function(e){return{currentUserId:(0,l.getCurrentUserId)(e),userAudits:(0,l.getUserAudits)(e)||[]}},function(e){return{actions:(0,i.bindActionCreators)({getUserAudits:n.getUserAudits},e)}})(r.default)},2462:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=h(a(282)),i=h(a(281)),n=h(a(285)),l=h(a(283)),r=h(a(284)),o=h(a(771)),d=h(a(1)),u=h(a(3)),c=a(769),f=a(766),m=a(765),p=h(a(1115)),g=h(a(785));function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.onShow=function(){a.props.actions.getUserAudits(a.props.currentUserId,0,200),(0,m.isMobile)()||(0,o.default)(".modal-body").perfectScrollbar()},a.onHide=function(){a.setState({show:!1})},a.state={show:!0},a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"componentDidMount",value:function(){this.onShow()}},{key:"render",value:function(){var e=void 0;return e=0===this.props.userAudits.length?u.default.createElement(g.default,null):u.default.createElement(p.default,{audits:this.props.userAudits,showIp:!0,showSession:!0}),u.default.createElement(c.Modal,{dialogClassName:"modal--scroll",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,bsSize:"large"},u.default.createElement(c.Modal.Header,{closeButton:!0},u.default.createElement(c.Modal.Title,null,u.default.createElement(f.FormattedMessage,{id:"access_history.title",defaultMessage:"Access History"}))),u.default.createElement(c.Modal.Body,{ref:"modalBody"},e))}}]),t}(u.default.PureComponent);v.propTypes={onHide:d.default.func.isRequired,actions:d.default.shape({getUserAudits:d.default.func.isRequired}).isRequired,userAudits:d.default.array.isRequired,currentUserId:d.default.string.isRequired},t.default=v},2463:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(2),n=a(779),l=a(770),r=a(913),o=function(e){return e&&e.__esModule?e:{default:e}}(a(2464));t.default=(0,s.connect)(function(e){return{currentUserId:(0,l.getCurrentUserId)(e),sessions:(0,l.getUserSessions)(e),locale:(0,r.getCurrentLocale)(e)}},function(e){return{actions:(0,i.bindActionCreators)({getSessions:n.getSessions,revokeSession:n.revokeSession},e)}})(o.default)},2464:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=h(a(282)),i=h(a(281)),n=h(a(285)),l=h(a(283)),r=h(a(284)),o=h(a(771)),d=h(a(1)),u=h(a(3)),c=a(769),f=a(766),m=a(765),p=h(a(2465)),g=h(a(785));function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.submitRevoke=function(e,t){t.preventDefault();var s=(0,o.default)(t.target).closest(".modal-content");s.addClass("animation--highlight"),setTimeout(function(){s.removeClass("animation--highlight")},1500),a.props.actions.revokeSession(a.props.currentUserId,e).then(function(){a.props.actions.getSessions(a.props.currentUserId)})},a.onShow=function(){a.props.actions.getSessions(a.props.currentUserId),(0,m.isMobile)()||(0,o.default)(".modal-body").perfectScrollbar()},a.onHide=function(){a.setState({show:!1})},a.state={show:!0},a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"componentDidMount",value:function(){this.onShow()}},{key:"render",value:function(){var e=this,t=void 0;if(this.props.sessions.loading)t=u.default.createElement(g.default,null);else{var a=this.props.sessions.reduce(function(t,a,s){return"UserAccessToken"===a.props.type?t:(t.push(u.default.createElement(p.default,{key:a.id,index:s,locale:e.props.locale,currentSession:a,submitRevoke:e.submitRevoke})),t)},[]);t=u.default.createElement("form",{role:"form"},a)}return u.default.createElement(c.Modal,{dialogClassName:"modal--scroll",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,bsSize:"large"},u.default.createElement(c.Modal.Header,{closeButton:!0},u.default.createElement(c.Modal.Title,null,u.default.createElement(f.FormattedMessage,{id:"activity_log.activeSessions",defaultMessage:"Active Sessions"}))),u.default.createElement(c.Modal.Body,{ref:"modalBody"},u.default.createElement("p",{className:"session-help-text"},u.default.createElement(f.FormattedMessage,{id:"activity_log.sessionsDescription",defaultMessage:"Sessions are created when you log in to a new browser on a device. Sessions let you use Mattermost without having to log in again for a time period specified by the System Admin. If you want to log out sooner, use the 'Logout' button below to end a session."})),t))}}]),t}(u.default.PureComponent);v.propTypes={currentUserId:d.default.string.isRequired,sessions:d.default.oneOfType([d.default.array,d.default.object]).isRequired,locale:d.default.string.isRequired,onHide:d.default.func.isRequired,actions:d.default.shape({getSessions:d.default.func.isRequired,revokeSession:d.default.func.isRequired}).isRequired},t.default=v},2465:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=g(a(282)),i=g(a(281)),n=g(a(285)),l=g(a(283)),r=g(a(284)),o=g(a(1)),d=g(a(3)),u=a(766),c=a(25),f=a(765),m=a(288),p=g(a(2466));function g(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.handleMoreInfo=function(){a.setState({moreInfo:!0})},a.submitRevoke=function(e){a.props.submitRevoke(a.props.currentSession.id,e)},a.isMobileSession=function(e){return e.device_id&&(e.device_id.includes("apple")||e.device_id.includes("android"))},a.mobileSessionInfo=function(e){var t=void 0,a=void 0,s=void 0,i=void 0;return e.device_id.includes("apple")?(s="fa fa-apple",i=(0,f.localizeMessage)("device_icons.apple","Apple Icon"),t=(0,m.t)("activity_log_modal.iphoneNativeClassicApp"),a="iPhone Native Classic App",e.device_id.includes(c.General.PUSH_NOTIFY_APPLE_REACT_NATIVE)&&(t=(0,m.t)("activity_log_modal.iphoneNativeApp"),a="iPhone Native App")):e.device_id.includes("android")&&(s="fa fa-android",i=(0,f.localizeMessage)("device_icons.android","Android Icon"),t=(0,m.t)("activity_log_modal.androidNativeClassicApp"),a="Android Native Classic App",e.device_id.includes(c.General.PUSH_NOTIFY_ANDROID_REACT_NATIVE)&&(t=(0,m.t)("activity_log_modal.androidNativeApp"),a="Android Native App")),{devicePicture:s,deviceTitle:i,devicePlatform:d.default.createElement(u.FormattedMessage,{id:t,defaultMessage:a})}},a.state={moreInfo:!1},a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this.props,t=e.index,a=e.locale,s=e.currentSession,i=new Date(s.last_activity_at),n=s.props.platform,l="",r="";if("Windows"===s.props.platform)l="fa fa-windows",r=(0,f.localizeMessage)("device_icons.windows","Windows Icon");else if(this.isMobileSession(s)){var o=this.mobileSessionInfo(s);l=o.devicePicture,n=o.devicePlatform}else"Macintosh"===s.props.platform||"iPhone"===s.props.platform?(l="fa fa-apple",r=(0,f.localizeMessage)("device_icons.apple","Apple Icon")):"Linux"===s.props.platform?s.props.os.indexOf("Android")>=0?(n=d.default.createElement(u.FormattedMessage,{id:"activity_log_modal.android",defaultMessage:"Android"}),l="fa fa-android",r=(0,f.localizeMessage)("device_icons.android","Android Icon")):(l="fa fa-linux",r=(0,f.localizeMessage)("device_icons.linux","Linux Icon")):-1!==s.props.os.indexOf("Linux")&&(l="fa fa-linux",r=(0,f.localizeMessage)("device_icons.linux","Linux Icon"));return-1!==s.props.browser.indexOf("Desktop App")&&(n=d.default.createElement(u.FormattedMessage,{id:"activity_log_modal.desktop",defaultMessage:"Native Desktop App"})),d.default.createElement("div",{key:"activityLogEntryKey"+t,className:"activity-log__table"},d.default.createElement("div",{className:"activity-log__report"},d.default.createElement("div",{className:"report__platform"},d.default.createElement("i",{className:l,title:r}),n),d.default.createElement("div",{className:"report__info"},d.default.createElement("div",null,d.default.createElement(u.FormattedMessage,{id:"activity_log.lastActivity",defaultMessage:"Last activity: {date}, {time}",values:{date:d.default.createElement(u.FormattedDate,{value:i,day:"2-digit",month:(0,m.getMonthLong)(a),year:"numeric"}),time:d.default.createElement(u.FormattedTime,{value:i,hour:"2-digit",minute:"2-digit"})}})),d.default.createElement(p.default,{locale:a,currentSession:s,moreInfo:this.state.moreInfo,handleMoreInfo:this.handleMoreInfo}))),d.default.createElement("div",{className:"activity-log__action"},d.default.createElement("button",{onClick:this.submitRevoke,className:"btn btn-primary"},d.default.createElement(u.FormattedMessage,{id:"activity_log.logout",defaultMessage:"Logout"}))))}}]),t}(d.default.PureComponent);h.propTypes={index:o.default.number.isRequired,locale:o.default.string.isRequired,currentSession:o.default.object.isRequired,submitRevoke:o.default.func.isRequired},t.default=h},2466:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var s=r(a(1)),i=r(a(3)),n=a(766),l=a(288);function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.locale,a=e.currentSession,s=e.moreInfo,r=e.handleMoreInfo;if(s){var o=new Date(a.create_at);return i.default.createElement("div",null,i.default.createElement("div",null,i.default.createElement(n.FormattedMessage,{id:"activity_log.firstTime",defaultMessage:"First time active: {date}, {time}",values:{date:i.default.createElement(n.FormattedDate,{value:o,day:"2-digit",month:(0,l.getMonthLong)(t),year:"numeric"}),time:i.default.createElement(n.FormattedTime,{value:o,hour:"2-digit",minute:"2-digit"})}})),i.default.createElement("div",null,i.default.createElement(n.FormattedMessage,{id:"activity_log.os",defaultMessage:"OS: {os}",values:{os:a.props.os}})),i.default.createElement("div",null,i.default.createElement(n.FormattedMessage,{id:"activity_log.browser",defaultMessage:"Browser: {browser}",values:{browser:a.props.browser}})),i.default.createElement("div",null,i.default.createElement(n.FormattedMessage,{id:"activity_log.sessionId",defaultMessage:"Session ID: {id}",values:{id:a.id}})))}return i.default.createElement("a",{className:"theme",href:"#",onClick:r},i.default.createElement(n.FormattedMessage,{id:"activity_log.moreInfo",defaultMessage:"More info"}))}o.propTypes={locale:s.default.string.isRequired,currentSession:s.default.object.isRequired,handleMoreInfo:s.default.func.isRequired,moreInfo:s.default.bool.isRequired}},2467:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(286),i=a(2),n=a(779),l=function(e){return e&&e.__esModule?e:{default:e}}(a(2468));t.default=(0,s.connect)(function(e){return{userAccessTokens:e.entities.users.myUserAccessTokens}},function(e){return{actions:(0,i.bindActionCreators)({getUserAccessTokensForUser:n.getUserAccessTokensForUser,createUserAccessToken:n.createUserAccessToken,revokeUserAccessToken:n.revokeUserAccessToken,enableUserAccessToken:n.enableUserAccessToken,disableUserAccessToken:n.disableUserAccessToken,clearUserAccessTokens:n.clearUserAccessTokens},e)}})(l.default)},2468:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=N(a(794)),i=N(a(181)),n=N(a(182)),l=N(a(282)),r=N(a(281)),o=N(a(285)),d=N(a(283)),u=N(a(284)),c=N(a(1)),f=N(a(3)),m=a(766),p=k(a(186)),g=a(791),h=N(a(22)),v=a(293),E=k(a(765)),S=N(a(806)),M=N(a(809)),b=N(a(817)),_=N(a(846)),y=N(a(777));function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function N(e){return e&&e.__esModule?e:{default:e}}var A="creating",C="created",T="not_creating",w=function(e){function t(e){var a=this;(0,r.default)(this,t);var s=(0,d.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return s.startCreatingToken=function(){s.setState({tokenCreationState:A})},s.stopCreatingToken=function(){s.setState({tokenCreationState:T,saving:!1})},s.handleCreateToken=(0,n.default)(i.default.mark(function e(){var t,n,l,r,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.handleCancelConfirm(),""!==(t=s.refs.newtokendescription?s.refs.newtokendescription.value:"")){e.next=5;break}return s.setState({tokenError:E.localizeMessage("user.settings.tokens.nameRequired","Please enter a description.")}),e.abrupt("return");case 5:return s.setState({tokenError:"",saving:!0}),s.props.setRequireConfirm(!0,s.confirmCopyToken),n=s.props.user?s.props.user.id:"",e.next=10,s.props.actions.createUserAccessToken(n,t);case 10:l=e.sent,r=l.data,o=l.error,r&&s.state.tokenCreationState===A?s.setState({tokenCreationState:C,newToken:r,saving:!1}):o&&s.setState({serverError:o.message,saving:!1});case 14:case"end":return e.stop()}},e,a)})),s.confirmCopyToken=function(e){s.setState({showConfirmModal:!0,confirmTitle:f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.confirmCopyTitle",defaultMessage:"Have you copied your token?"}),confirmMessage:function(e){return f.default.createElement("div",null,f.default.createElement(m.FormattedHTMLMessage,{id:"user.settings.tokens.confirmCopyMessage",defaultMessage:"Make sure you have copied and saved the access token below. You won't be able to see it again!"}),f.default.createElement("br",null),f.default.createElement("br",null),e.tokenCreationState===A?f.default.createElement("div",null,f.default.createElement("strong",{className:"word-break--all"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "})),f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.tokenLoading",defaultMessage:"Loading..."})):f.default.createElement("strong",{className:"word-break--all"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),e.newToken.token))},confirmButton:f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.confirmCopyButton",defaultMessage:"Yes, I have copied the token"}),confirmComplete:function(){s.handleCancelConfirm(),e()},confirmHideCancel:!0})},s.handleCancelConfirm=function(){s.setState({showConfirmModal:!1,confirmTitle:null,confirmMessage:null,confirmButton:null,confirmComplete:null,confirmHideCancel:!1})},s.confirmCreateToken=function(){p.isSystemAdmin(s.props.user.roles)?s.setState({showConfirmModal:!0,confirmTitle:f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.confirmCreateTitle",defaultMessage:"Create System Admin Personal Access Token"}),confirmMessage:function(){return f.default.createElement("div",{className:"alert alert-danger"},f.default.createElement(m.FormattedHTMLMessage,{id:"user.settings.tokens.confirmCreateMessage",defaultMessage:"You are generating a personal access token with System Admin permissions. Are you sure want to create this token?"}))},confirmButton:f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.confirmCreateButton",defaultMessage:"Yes, Create"}),confirmComplete:function(){s.handleCreateToken(),(0,g.trackEvent)("settings","system_admin_create_user_access_token")}}):s.handleCreateToken()},s.saveTokenKeyPress=function(e){E.isKeyPressed(e,h.default.KeyCodes.ENTER)&&s.confirmCreateToken()},s.confirmRevokeToken=function(e){var t=s.props.userAccessTokens[e];s.setState({showConfirmModal:!0,confirmTitle:f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.confirmDeleteTitle",defaultMessage:"Delete Token?"}),confirmMessage:function(){return f.default.createElement("div",{className:"alert alert-danger"},f.default.createElement(y.default,{id:"user.settings.tokens.confirmDeleteMessage",defaultMessage:"Any integrations using this token will no longer be able to access the Mattermost API. You cannot undo this action. \\n \\nAre you sure want to delete the **{description}** token?",values:{description:t.description}}))},confirmButton:f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.confirmDeleteButton",defaultMessage:"Yes, Delete"}),confirmComplete:function(){s.revokeToken(e),(0,g.trackEvent)("settings","revoke_user_access_token")}})},s.revokeToken=function(){var e=(0,n.default)(i.default.mark(function e(t){var n,l;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.props.actions.revokeUserAccessToken(t);case 2:n=e.sent,(l=n.error)&&s.setState({serverError:l.message}),s.handleCancelConfirm();case 6:case"end":return e.stop()}},e,a)}));return function(t){return e.apply(this,arguments)}}(),s.activateToken=function(){var e=(0,n.default)(i.default.mark(function e(t){var n,l;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.props.actions.enableUserAccessToken(t);case 2:n=e.sent,(l=n.error)?s.setState({serverError:l.message}):(0,g.trackEvent)("settings","activate_user_access_token");case 5:case"end":return e.stop()}},e,a)}));return function(t){return e.apply(this,arguments)}}(),s.deactivateToken=function(){var e=(0,n.default)(i.default.mark(function e(t){var n,l;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.props.actions.disableUserAccessToken(t);case 2:n=e.sent,(l=n.error)?s.setState({serverError:l.message}):(0,g.trackEvent)("settings","deactivate_user_access_token");case 5:case"end":return e.stop()}},e,a)}));return function(t){return e.apply(this,arguments)}}(),s.state={showConfirmModal:!1,newToken:null,tokenCreationState:T,tokenError:"",serverError:null,saving:!1},s}return(0,u.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.props.actions.clearUserAccessTokens();var e=this.props.user?this.props.user.id:"";this.props.actions.getUserAccessTokensForUser(e,0,200)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){!e.active&&this.props.active&&this.setState({showConfirmModal:!1,newToken:null,tokenCreationState:T,tokenError:"",serverError:null,saving:!1})}},{key:"render",value:function(){var e=this,t="";if(!this.props.active){var a=E.localizeMessage("user.settings.tokens.clickToEdit","Click 'Edit' to manage your personal access tokens");return f.default.createElement(b.default,{title:E.localizeMessage("user.settings.tokens.title","Personal Access Tokens"),describe:a,section:"tokens",updateSection:this.props.updateSection})}var i=[];(0,s.default)(this.props.userAccessTokens).forEach(function(t){if(!e.state.newToken||e.state.newToken.id!==t.id){var a=void 0,s=void 0;t.is_active?a=f.default.createElement("a",{name:t.id+"_deactivate",href:"#",onClick:function(a){a.preventDefault(),e.deactivateToken(t.id)}},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.deactivate",defaultMessage:"Deactivate"})):(s=f.default.createElement("span",{className:"has-error setting-box__inline-error"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.deactivatedWarning",defaultMessage:"(Inactive)"})),a=f.default.createElement("a",{name:t.id+"_activate",href:"#",onClick:function(a){a.preventDefault(),e.activateToken(t.id)}},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.activate",defaultMessage:"Activate"}))),i.push(f.default.createElement("div",{key:t.id,className:"setting-box__item"},f.default.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.tokenDesc",defaultMessage:"Token Description: "}),t.description,s),f.default.createElement("div",{className:"setting-box__token-id whitespace--nowrap overflow--ellipsis"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.tokenId",defaultMessage:"Token ID: "}),t.id),f.default.createElement("div",null,a," - ",f.default.createElement("a",{name:t.id+"_delete",href:"#",onClick:function(a){a.preventDefault(),e.confirmRevokeToken(t.id)}},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.delete",defaultMessage:"Delete"}))),f.default.createElement("hr",{className:"margin-bottom margin-top x2"})))}});var n=void 0;0===i.length&&(n=f.default.createElement(m.FormattedMessage,{key:"notokens",id:"user.settings.tokens.userAccessTokensNone",defaultMessage:"No personal access tokens."}));var l=void 0;l=(0,v.isMobile)()?f.default.createElement("span",null,f.default.createElement(y.default,{id:"user.settings.tokens.description_mobile",defaultMessage:"[Personal access tokens](!https://about.mattermost.com/default-user-access-tokens) function similarly to session tokens and can be used by integrations to [authenticate against the REST API](!https://about.mattermost.com/default-api-authentication). Create new tokens on your desktop."})):f.default.createElement("span",null,f.default.createElement(y.default,{id:"user.settings.tokens.description",defaultMessage:"[Personal access tokens](!https://about.mattermost.com/default-user-access-tokens) function similarly to session tokens and can be used by integrations to [authenticate against the REST API](!https://about.mattermost.com/default-api-authentication)."}));var r=void 0;this.state.tokenCreationState===A?r=f.default.createElement("div",{className:"padding-left x2"},f.default.createElement("div",{className:"row"},f.default.createElement("label",{className:"col-sm-auto control-label padding-right x2"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "})),f.default.createElement("div",{className:"col-sm-5"},f.default.createElement("input",{autoFocus:!0,ref:"newtokendescription",className:"form-control",type:"text",maxLength:64,onKeyPress:this.saveTokenKeyPress}))),f.default.createElement("div",null,f.default.createElement("div",{className:"padding-top x2"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.nameHelp",defaultMessage:"Enter a description for your token to remember what it does."})),f.default.createElement("div",null,f.default.createElement("label",{id:"clientError",className:"has-error margin-top margin-bottom"},this.state.tokenError)),f.default.createElement(_.default,{btnClass:"btn-primary",savingMessage:f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.save",defaultMessage:"Save"}),saving:this.state.saving,onClick:this.confirmCreateToken}),f.default.createElement("button",{className:"btn btn-default",onClick:this.stopCreatingToken},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.cancel",defaultMessage:"Cancel"})))):this.state.tokenCreationState===C?(0===i.length&&(t=" hidden"),r=f.default.createElement("div",{className:"alert alert-warning"},f.default.createElement("i",{className:"fa fa-warning margin-right",title:E.localizeMessage("generic_icons.warning","Warning Icon")}),f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.copy",defaultMessage:"Please copy the access token below. You won't be able to see it again!"}),f.default.createElement("br",null),f.default.createElement("br",null),f.default.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "}),this.state.newToken.description),f.default.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.id",defaultMessage:"Token ID: "}),this.state.newToken.id),f.default.createElement("strong",{className:"word-break--all"},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),this.state.newToken.token))):r=f.default.createElement("a",{className:"btn btn-primary",href:"#",onClick:this.startCreatingToken},f.default.createElement(m.FormattedMessage,{id:"user.settings.tokens.create",defaultMessage:"Create New Token"}));var o=[];return o.push(f.default.createElement("div",{key:"tokensSetting",className:"padding-top"},f.default.createElement("div",{key:"tokenList"},f.default.createElement("div",{className:"alert alert-transparent"+t},i,n),r))),f.default.createElement("div",null,f.default.createElement(M.default,{title:E.localizeMessage("user.settings.tokens.title","Personal Access Tokens"),inputs:o,extraInfo:l,infoPosition:"top",serverError:this.state.serverError,updateSection:this.props.updateSection,width:"full",saving:this.state.saving,cancelButtonText:f.default.createElement(m.FormattedMessage,{id:"user.settings.security.close",defaultMessage:"Close"})}),f.default.createElement(S.default,{title:this.state.confirmTitle,message:this.state.confirmMessage?this.state.confirmMessage(this.state):null,confirmButtonText:this.state.confirmButton,show:this.state.showConfirmModal,onConfirm:this.state.confirmComplete||function(){},onCancel:this.handleCancelConfirm,hideCancel:this.state.confirmHideCancel}))}}]),t}(f.default.Component);w.propTypes={user:c.default.object,active:c.default.bool,updateSection:c.default.func,userAccessTokens:c.default.object,setRequireConfirm:c.default.func.isRequired,actions:c.default.shape({getUserAccessTokensForUser:c.default.func.isRequired,createUserAccessToken:c.default.func.isRequired,revokeUserAccessToken:c.default.func.isRequired,enableUserAccessToken:c.default.func.isRequired,disableUserAccessToken:c.default.func.isRequired,clearUserAccessTokens:c.default.func.isRequired}).isRequired},w.defaultProps={user:{},active:!1},t.default=w},2469:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(2),i=a(286),n=a(831),l=a(25),r=a(96),o=a(775),d=a(770),u=a(22),c=function(e){return e&&e.__esModule?e:{default:e}}(a(2470));t.default=(0,i.connect)(function(e){var t=(0,r.getConfig)(e);return{closeUnusedDirectMessages:(0,o.get)(e,l.Preferences.CATEGORY_SIDEBAR_SETTINGS,"close_unused_direct_messages","after_seven_days"),displayUnreadSection:(0,o.get)(e,l.Preferences.CATEGORY_SIDEBAR_SETTINGS,"show_unread_section",(t.ExperimentalGroupUnreadChannels===u.GroupUnreadChannels.DEFAULT_ON).toString()),channelSwitcherOption:(0,o.get)(e,l.Preferences.CATEGORY_SIDEBAR_SETTINGS,"channel_switcher_section","true"),showUnusedOption:"true"===t.CloseUnusedDirectMessages,showUnreadOption:t.ExperimentalGroupUnreadChannels!==u.GroupUnreadChannels.DISABLED,user:(0,d.getCurrentUser)(e)}},function(e){return{actions:(0,s.bindActionCreators)({savePreferences:n.savePreferences},e)}})(c.default)},2470:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=h(a(282)),i=h(a(281)),n=h(a(285)),l=h(a(283)),r=h(a(284)),o=h(a(1)),d=h(a(3)),u=a(766),c=h(a(22)),f=a(765),m=a(288),p=h(a(809)),g=h(a(817));function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,i.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.getStateFromStores=function(){var e=a.props;return{settings:{close_unused_direct_messages:e.closeUnusedDirectMessages,show_unread_section:e.displayUnreadSection,channel_switcher_section:e.channelSwitcherOption},isSaving:!1}},a.updateSetting=function(e,t){var s=a.state.settings;s[e]=t,a.setState(s)},a.handleSubmit=function(e){var t=a.props,s=t.actions,i=t.user,n=[];n.push({user_id:i.id,category:c.default.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:e,value:a.state.settings[e]}),a.setState({isSaving:!0}),s.savePreferences(i.id,n).then(function(){a.updateSection("")})},a.updateSection=function(e){e||a.setState(a.getStateFromStores()),a.setState({isSaving:!1}),a.props.updateSection(e)},a.renderAutoCloseDMLabel=function(e){return"after_seven_days"===e?d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.after_seven_days",defaultMessage:"After 7 days with no new messages"}):d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.never",defaultMessage:"Never"})},a.renderAutoCloseDMSection=function(){return"autoCloseDM"===a.props.activeSection?d.default.createElement(p.default,{title:d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.autoCloseDMTitle",defaultMessage:"Automatically Close Direct Messages"}),inputs:[d.default.createElement("div",{key:"autoCloseDMSetting"},d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"autoCloseDMAfterSevenDays",type:"radio",name:"autoCloseDM",checked:"after_seven_days"===a.state.settings.close_unused_direct_messages,onChange:a.updateSetting.bind(a,"close_unused_direct_messages","after_seven_days")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.after_seven_days",defaultMessage:"After 7 days with no new messages"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"autoCloseDMNever",type:"radio",name:"autoCloseDM",checked:"never"===a.state.settings.close_unused_direct_messages,onChange:a.updateSetting.bind(a,"close_unused_direct_messages","never")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.never",defaultMessage:"Never"})),d.default.createElement("br",null)),d.default.createElement("div",null,d.default.createElement("br",null),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.autoCloseDMDesc",defaultMessage:"Direct Message conversations can be reopened with the “+” button in the sidebar or using the Channel Switcher (CTRL+K)."})))],setting:"close_unused_direct_messages",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection}):d.default.createElement(g.default,{title:d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.autoCloseDMTitle",defaultMessage:"Automatically Close Direct Messages"}),describe:a.renderAutoCloseDMLabel(a.state.settings.close_unused_direct_messages),section:"autoCloseDM",updateSection:a.updateSection})},a.renderUnreadLabel=function(e){return"true"===e?d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.showUnreadSection",defaultMessage:"At the top of the channel sidebar"}):d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.never",defaultMessage:"Never"})},a.renderChannelSwitcherLabel=function(e){return"true"===e?d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.on",defaultMessage:"On"}):d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.off",defaultMessage:"Off"})},a.renderUnreadSection=function(){return"unreadChannels"===a.props.activeSection?d.default.createElement(p.default,{title:d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.unreadSectionTitle",defaultMessage:"Group unread channels"}),inputs:[d.default.createElement("div",{key:"unreadSectionSetting"},d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"unreadSectionEnabled",type:"radio",name:"unreadChannels",checked:"true"===a.state.settings.show_unread_section,onChange:a.updateSetting.bind(a,"show_unread_section","true")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.showUnreadSection",defaultMessage:"At the top of the channel sidebar"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"unreadSectionNever",type:"radio",name:"unreadChannels",checked:"false"===a.state.settings.show_unread_section,onChange:a.updateSetting.bind(a,"show_unread_section","false")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.never",defaultMessage:"Never"})),d.default.createElement("br",null)),d.default.createElement("div",null,d.default.createElement("br",null),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.unreadSectionDesc",defaultMessage:"Unread channels will be sorted at the top of the channel sidebar until read."})))],setting:"show_unread_section",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection}):d.default.createElement(g.default,{title:d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.unreadSectionTitle",defaultMessage:"Group unread channels"}),describe:a.renderUnreadLabel(a.state.settings.show_unread_section),section:"unreadChannels",updateSection:a.updateSection})},a.renderChannelSwitcherSection=function(){var e=(0,m.t)("user.settings.sidebar.channelSwitcherSectionDesc.windows"),t="The channel switcher is shown at the bottom of the sidebar and is used to jump between channels quickly. It can also be accessed using CTRL + K.";(0,f.isMac)()&&(e=(0,m.t)("user.settings.sidebar.channelSwitcherSectionDesc.mac"),t="The channel switcher is shown at the bottom of the sidebar and is used to jump between channels quickly. It can also be accessed using CMD + K.");var s=d.default.createElement(u.FormattedMessage,{id:e,defaultMessage:t});return"channelSwitcher"===a.props.activeSection?d.default.createElement(p.default,{title:d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"}),inputs:[d.default.createElement("div",{key:"channelSwitcherSectionSetting"},d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"channelSwitcherSectionEnabled",type:"radio",name:"channelSwitcher",checked:"true"===a.state.settings.channel_switcher_section,onChange:a.updateSetting.bind(a,"channel_switcher_section","true")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.on",defaultMessage:"On"})),d.default.createElement("br",null)),d.default.createElement("div",{className:"radio"},d.default.createElement("label",null,d.default.createElement("input",{id:"channelSwitcherSectionOff",type:"radio",name:"channelSwitcher",checked:"false"===a.state.settings.channel_switcher_section,onChange:a.updateSetting.bind(a,"channel_switcher_section","false")}),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.off",defaultMessage:"Off"})),d.default.createElement("br",null)),d.default.createElement("div",null,d.default.createElement("br",null),s))],setting:"channel_switcher_section",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection}):d.default.createElement(g.default,{title:d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"}),describe:a.renderChannelSwitcherLabel(a.state.settings.channel_switcher_section),section:"channelSwitcher",updateSection:a.updateSection})},a.state=a.getStateFromStores(),a}return(0,r.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this.props,t=e.showUnusedOption,a=e.showUnreadOption,s=t?this.renderAutoCloseDMSection():null,i=a?this.renderUnreadSection():null,n=this.renderChannelSwitcherSection();return d.default.createElement("div",null,d.default.createElement("div",{className:"modal-header"},d.default.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},d.default.createElement("span",{"aria-hidden":"true"},"×")),d.default.createElement("h4",{className:"modal-title",ref:"title"},d.default.createElement("div",{className:"modal-back"},d.default.createElement("i",{className:"fa fa-angle-left",title:(0,f.localizeMessage)("generic_icons.collapse","Collapse Icon"),onClick:this.props.collapseModal})),d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.title",defaultMessage:"Sidebar Settings"}))),d.default.createElement("div",{className:"user-settings"},d.default.createElement("h3",{className:"tab-header"},d.default.createElement(u.FormattedMessage,{id:"user.settings.sidebar.title",defaultMessage:"Sidebar Settings"})),d.default.createElement("div",{className:"divider-dark first"}),i,a&&d.default.createElement("div",{className:"divider-light"}),n,t&&d.default.createElement("div",{className:"divider-light"}),s,d.default.createElement("div",{className:"divider-dark"})))}}]),t}(d.default.Component);v.propTypes={actions:o.default.shape({savePreferences:o.default.func.isRequired}).isRequired,user:o.default.object,closeUnusedDirectMessages:o.default.string.isRequired,displayUnreadSection:o.default.string.isRequired,showUnusedOption:o.default.bool.isRequired,channelSwitcherOption:o.default.string.isRequired,showUnreadOption:o.default.bool.isRequired,updateSection:o.default.func,activeSection:o.default.string,closeModal:o.default.func.isRequired,collapseModal:o.default.func.isRequired},t.default=v}}]);
//# sourceMappingURL=12.80fd4bc08ec6ce09f674.js.map