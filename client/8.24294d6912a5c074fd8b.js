(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1100:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.autoUpdateTimezone=function(e){var t=this;return function(){var r=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,a){try{var s=t[o](a),u=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function r(u,i){var d,l,f,c,m;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:d=(0,o.getCurrentUser)(i()),l=(0,a.getUserTimezone)(i(),d.id),f=l.automaticTimezone!==e,l.useAutomaticTimezone&&f&&(c={useAutomaticTimezone:"true",automaticTimezone:e,manualTimezone:l.manualTimezone},m=n({},d,{timezone:c}),(0,s.updateMe)(m)(u,i));case 4:case"end":return t.stop()}},r,t)}));return function(e,t){return r.apply(this,arguments)}}()};var o=r(770),a=r(931),s=r(779)},2227:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(286),o=r(2),a=r(1100),s=r(96),u=r(770),i=r(1327),d=function(e){return e&&e.__esModule?e:{default:e}}(r(2228));t.default=(0,n.connect)(function(e,t){var r=(0,s.getLicense)(e),n=(0,s.getConfig)(e),o=(0,u.shouldShowTermsOfService)(e);return{mfaRequired:(0,i.checkIfMFARequired)(r,n,t.match.url),enableTimezone:"true"===n.ExperimentalTimezone,showTermsOfService:o}},function(e){return{actions:(0,o.bindActionCreators)({autoUpdateTimezone:a.autoUpdateTimezone},e)}})(d.default)},2228:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=T(r(282)),o=T(r(281)),a=T(r(285)),s=T(r(283)),u=T(r(284)),i=T(r(771)),d=T(r(1)),l=T(r(3)),f=r(2229),c=r(787),m=R(r(773)),p=R(r(933));r(822);var h=T(r(774)),v=T(r(788)),w=T(r(834)),b=R(r(293)),y=R(r(765)),_=T(r(785)),C=r(932),g=T(r(292));function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function T(e){return e&&e.__esModule?e:{default:e}}var U=g.default.dispatch,z=g.default.getState,k=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.onUserChanged=r.onUserChanged.bind(r),r.state={user:h.default.getCurrentUser()};var a=document.getElementById("root");return a&&(a.className+=" channel-view"),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"isValidState",value:function(){return null!=this.state.user}},{key:"onUserChanged",value:function(){var e=h.default.getCurrentUser();y.areObjectsEqual(this.state.user,e)||this.setState({user:e})}},{key:"UNSAFE_componentWillMount",value:function(){w.default.clearLastError()}},{key:"componentDidMount",value:function(){p.initialize(),this.props.enableTimezone&&this.props.actions.autoUpdateTimezone((0,C.getBrowserTimezone)()),(0,i.default)(window).on("beforeunload",function(){(0,i.default)(window).off("beforeunload"),document.cookie.indexOf("MMUSERID=")>-1&&(0,c.viewChannel)("",v.default.getCurrentId()||"")(U,z),p.close()}),h.default.addChangeListener(this.onUserChanged),window.addEventListener("focus",this.onFocusListener),window.addEventListener("blur",this.onBlurListener),b.isIos()?(0,i.default)("body").addClass("ios"):b.isAndroid()&&(0,i.default)("body").addClass("android"),this.state.user||((0,i.default)("#root").attr("class",""),m.emitUserLoggedOutEvent("/login?redirect_to="+encodeURIComponent(this.props.location.pathname),!0,!1)),(0,i.default)("body").on("mouseenter mouseleave",".post",function(e){"mouseenter"===e.type?((0,i.default)(this).prev(".date-separator, .new-separator").addClass("hovered--after"),(0,i.default)(this).next(".date-separator, .new-separator").addClass("hovered--before")):((0,i.default)(this).prev(".date-separator, .new-separator").removeClass("hovered--after"),(0,i.default)(this).next(".date-separator, .new-separator").removeClass("hovered--before"))}),(0,i.default)("body").on("mouseenter mouseleave",".search-item__container .post",function(e){"mouseenter"===e.type?((0,i.default)(this).closest(".search-item__container").find(".date-separator").addClass("hovered--after"),(0,i.default)(this).closest(".search-item__container").next("div").find(".date-separator").addClass("hovered--before")):((0,i.default)(this).closest(".search-item__container").find(".date-separator").removeClass("hovered--after"),(0,i.default)(this).closest(".search-item__container").next("div").find(".date-separator").removeClass("hovered--before"))}),(0,i.default)("body").on("mouseenter mouseleave",".post.post--comment.same--root",function(e){"mouseenter"===e.type?((0,i.default)(this).prev(".date-separator, .new-separator").addClass("hovered--comment"),(0,i.default)(this).next(".date-separator, .new-separator").addClass("hovered--comment")):((0,i.default)(this).prev(".date-separator, .new-separator").removeClass("hovered--comment"),(0,i.default)(this).next(".date-separator, .new-separator").removeClass("hovered--comment"))}),(0,i.default)(window).on("keydown.preventBackspace",function(e){8!==e.which||(0,i.default)(e.target).is("input, textarea")||e.preventDefault()})}},{key:"componentWillUnmount",value:function(){p.close(),h.default.removeChangeListener(this.onUserChanged),(0,i.default)("body").off("click.userpopover"),(0,i.default)("body").off("mouseenter mouseleave",".post"),(0,i.default)("body").off("mouseenter mouseleave",".post.post--comment.same--root"),(0,i.default)(".modal").off("show.bs.modal"),(0,i.default)(window).off("keydown.preventBackspace"),window.removeEventListener("focus",this.onFocusListener),window.removeEventListener("blur",this.onBlurListener)}},{key:"render",value:function(){if(!this.isValidState())return l.default.createElement(_.default,null);if(this.props.mfaRequired){if("/mfa/setup"!==this.props.location.pathname)return l.default.createElement(f.Redirect,{to:"/mfa/setup"})}else if("/mfa/confirm"===this.props.location.pathname);else if(this.props.showTermsOfService&&"/terms_of_service"!==this.props.location.pathname)return l.default.createElement(f.Redirect,{to:"/terms_of_service?redirect_to="+encodeURIComponent(this.props.location.pathname)});return this.props.children}},{key:"onFocusListener",value:function(){m.emitBrowserFocus(!0)}},{key:"onBlurListener",value:function(){m.emitBrowserFocus(!1)}}]),t}(l.default.Component);t.default=k,k.propTypes={children:d.default.object,mfaRequired:d.default.bool.isRequired,enableTimezone:d.default.bool.isRequired,actions:d.default.shape({autoUpdateTimezone:d.default.func.isRequired}).isRequired,showTermsOfService:d.default.bool.isRequired}},2229:function(e,t,r){"use strict";r.r(t);var n=r(194);r.d(t,"MemoryRouter",function(){return n.a});var o=r(195);r.d(t,"Prompt",function(){return o.a});var a=r(196);r.d(t,"Redirect",function(){return a.a});var s=r(117);r.d(t,"Route",function(){return s.a});var u=r(80);r.d(t,"Router",function(){return u.a});var i=r(197);r.d(t,"StaticRouter",function(){return i.a});var d=r(198);r.d(t,"Switch",function(){return d.a});var l=r(95);r.d(t,"generatePath",function(){return l.a});var f=r(81);r.d(t,"matchPath",function(){return f.a});var c=r(199);r.d(t,"withRouter",function(){return c.a})}}]);
//# sourceMappingURL=8.24294d6912a5c074fd8b.js.map